{% ckan_extends %}

{% block extra_config %}
    {%- set config_placeholder = '{
        "max_datasets": 10,
        "tsm_schema":{
            "root":"Dataset",
            "types":{
                "Dataset":{
                    "fields":{
                        "data_lang": {
                            "value": "English"
                        }
                    }
                }
            }
        }
    }'
    -%}

    <div class="form-group control-full">
        <label class="control-label" for="field-config">
            {{ _('Configuration') }}
        </label>
        <div class="controls editor">
            <textarea
                id="field-config"
                name="config"
                cols="20" rows="10"
                placeholder="{{ config_placeholder }}"
                class="form-control"
            >{{ data.config or config_placeholder }}</textarea>
            <span class="editor-info-block">{% trans %}Learn more about <a href="https://github.com/DataShades/ckanext-transmute#working-with-transmute" target="_blank" title="Transmute extension reference">Transmute schema</a> here{% endtrans %}</span>
            {% if errors.config and errors.config is iterable %}<span class="error-block">{{ errors.config|join(', ') }}</span>{% endif %}
        </div>
    </div>

    <div class="harvest-checkup-preview" data-module="harvest-change-source-type harvest-config">
        <div class="form-group control-full">
            <label class="control-label" for="field-checkup-preview">
                {{ _('Source checkup preview')}}
            </label>
            <div class="controls">
                <textarea
                    disabled
                    id="field-checkup-preview"
                    name="checkup-preview"
                    cols="20" rows="10"
                    placeholder=""
                    class="form-control preview-field"
                ></textarea>
            </div>
            <p class="action-info small">
                {% trans %}
                The preview shows you the data before we are going to apply our custom scheme to it.
                Provide a <b>source URL</b> and choose a <b>source type</b> to check it up.
                {% endtrans %}
            </p>
        </div>
    </div>
{% endblock extra_config %}
