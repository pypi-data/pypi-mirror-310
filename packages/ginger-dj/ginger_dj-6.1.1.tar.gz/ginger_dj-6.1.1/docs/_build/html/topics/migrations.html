<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Managing files" href="files.html" /><link rel="prev" title="Using mixins with class-based views" href="class-based-views/mixins.html" />
        <link rel="canonical" href="https://www.gingersociety.org/products/ginger-dj/docs/topics/migrations.html" />

    <!-- Generated with Sphinx 8.1.3 and Furo 2024.08.06 -->
        <title>Migrations - GingerDJ 6.1.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=d10597a4" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #ffffff;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../contents.html"><div class="brand">GingerDJ 6.1.1 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../contents.html">
  
  
  <span class="sidebar-brand-text">GingerDJ 6.1.1 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">GingerDJ documentation</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../intro/index.html">Getting started</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Getting started</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../intro/overview.html">GingerDJ at a glance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/install.html">Quick install guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/tutorial01.html">Writing your first GingerDJ app, part 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/tutorial02.html">Writing your first GingerDJ app, part 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/tutorial03.html">Writing your first GingerDJ app, part 3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/tutorial04.html">Writing your first GingerDJ app, part 4</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/tutorial05.html">Writing your first GingerDJ app, part 5</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/tutorial06.html">Writing your first GingerDJ app, part 6</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/tutorial07.html">Writing your first GingerDJ app, part 7</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/tutorial08.html">Writing your first GingerDJ app, part 8</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/reusable-apps.html">Advanced tutorial: How to write reusable apps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/whatsnext.html">What to read next</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Using GingerDJ</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Using GingerDJ</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="install.html">How to install GingerDJ</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="db/index.html">Models and databases</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Models and databases</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="db/models.html">Models</a></li>
<li class="toctree-l3"><a class="reference internal" href="db/queries.html">Making queries</a></li>
<li class="toctree-l3"><a class="reference internal" href="db/aggregation.html">Aggregation</a></li>
<li class="toctree-l3"><a class="reference internal" href="db/search.html">Search</a></li>
<li class="toctree-l3"><a class="reference internal" href="db/managers.html">Managers</a></li>
<li class="toctree-l3"><a class="reference internal" href="db/sql.html">Performing raw SQL queries</a></li>
<li class="toctree-l3"><a class="reference internal" href="db/transactions.html">Database transactions</a></li>
<li class="toctree-l3"><a class="reference internal" href="db/multi-db.html">Multiple databases</a></li>
<li class="toctree-l3"><a class="reference internal" href="db/tablespaces.html">Tablespaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="db/optimization.html">Database access optimization</a></li>
<li class="toctree-l3"><a class="reference internal" href="db/instrumentation.html">Database instrumentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="db/fixtures.html">Fixtures</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="db/examples/index.html">Examples of model relationship API usage</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Examples of model relationship API usage</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="db/examples/many_to_many.html">Many-to-many relationships</a></li>
<li class="toctree-l4"><a class="reference internal" href="db/examples/many_to_one.html">Many-to-one relationships</a></li>
<li class="toctree-l4"><a class="reference internal" href="db/examples/one_to_one.html">One-to-one relationships</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="http/index.html">Handling HTTP requests</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Handling HTTP requests</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="http/urls.html">URL dispatcher</a></li>
<li class="toctree-l3"><a class="reference internal" href="http/views.html">Writing views</a></li>
<li class="toctree-l3"><a class="reference internal" href="http/decorators.html">View decorators</a></li>
<li class="toctree-l3"><a class="reference internal" href="http/file-uploads.html">File Uploads</a></li>
<li class="toctree-l3"><a class="reference internal" href="http/shortcuts.html">GingerDJ shortcut functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="http/generic-views.html">Generic views</a></li>
<li class="toctree-l3"><a class="reference internal" href="http/middleware.html">Middleware</a></li>
<li class="toctree-l3"><a class="reference internal" href="http/sessions.html">How to use sessions</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="forms/index.html">Working with forms</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Working with forms</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="forms/formsets.html">Formsets</a></li>
<li class="toctree-l3"><a class="reference internal" href="forms/modelforms.html">Creating forms from models</a></li>
<li class="toctree-l3"><a class="reference internal" href="forms/media.html">Form Assets (the <code class="docutils literal notranslate"><span class="pre">Media</span></code> class)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="templates.html">Templates</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="class-based-views/index.html">Class-based views</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of Class-based views</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="class-based-views/intro.html">Introduction to class-based views</a></li>
<li class="toctree-l3"><a class="reference internal" href="class-based-views/generic-display.html">Built-in class-based generic views</a></li>
<li class="toctree-l3"><a class="reference internal" href="class-based-views/generic-editing.html">Form handling with class-based views</a></li>
<li class="toctree-l3"><a class="reference internal" href="class-based-views/mixins.html">Using mixins with class-based views</a></li>
</ul>
</li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Migrations</a></li>
<li class="toctree-l2"><a class="reference internal" href="files.html">Managing files</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="testing/index.html">Testing in GingerDJ</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of Testing in GingerDJ</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="testing/overview.html">Writing and running tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="testing/tools.html">Testing tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="testing/advanced.html">Advanced testing topics</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="cache.html">GingerDJ’s cache framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="conditional-view-processing.html">Conditional View Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="signing.html">Cryptographic signing</a></li>
<li class="toctree-l2"><a class="reference internal" href="email.html">Sending email</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="i18n/index.html">Internationalization and localization</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of Internationalization and localization</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="i18n/translation.html">Translation</a></li>
<li class="toctree-l3"><a class="reference internal" href="i18n/formatting.html">Format localization</a></li>
<li class="toctree-l3"><a class="reference internal" href="i18n/timezones.html">Time zones</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="logging.html">Logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="pagination.html">Pagination</a></li>
<li class="toctree-l2"><a class="reference internal" href="security.html">Security in GingerDJ</a></li>
<li class="toctree-l2"><a class="reference internal" href="performance.html">Performance and optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="serialization.html">Serializing GingerDJ objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="settings.html">GingerDJ settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="signals.html">Signals</a></li>
<li class="toctree-l2"><a class="reference internal" href="checks.html">System check framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="external-packages.html">External packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="async.html">Asynchronous support</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../howto/index.html">“How-to” guides</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of “How-to” guides</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../howto/csrf.html">How to use GingerDJ’s CSRF protection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../howto/custom-management-commands.html">How to create custom <code class="docutils literal notranslate"><span class="pre">gingerdj-admin</span></code> commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../howto/custom-model-fields.html">How to create custom model fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../howto/custom-lookups.html">How to write custom lookups</a></li>
<li class="toctree-l2"><a class="reference internal" href="../howto/custom-template-backend.html">How to implement a custom template backend</a></li>
<li class="toctree-l2"><a class="reference internal" href="../howto/custom-template-tags.html">How to create custom template tags and filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../howto/custom-file-storage.html">How to write a custom storage class</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../howto/deployment/index.html">How to deploy GingerDJ</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of How to deploy GingerDJ</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../howto/deployment/wsgi/index.html">How to deploy with WSGI</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of How to deploy with WSGI</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../howto/deployment/wsgi/gunicorn.html">How to use GingerDJ with Gunicorn</a></li>
<li class="toctree-l4"><a class="reference internal" href="../howto/deployment/wsgi/uwsgi.html">How to use GingerDJ with uWSGI</a></li>
<li class="toctree-l4"><a class="reference internal" href="../howto/deployment/wsgi/modwsgi.html">How to use GingerDJ with Apache and <code class="docutils literal notranslate"><span class="pre">mod_wsgi</span></code></a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../howto/deployment/asgi/index.html">How to deploy with ASGI</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle navigation of How to deploy with ASGI</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../howto/deployment/asgi/daphne.html">How to use GingerDJ with Daphne</a></li>
<li class="toctree-l4"><a class="reference internal" href="../howto/deployment/asgi/hypercorn.html">How to use GingerDJ with Hypercorn</a></li>
<li class="toctree-l4"><a class="reference internal" href="../howto/deployment/asgi/uvicorn.html">How to use GingerDJ with Uvicorn</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../howto/deployment/checklist.html">Deployment checklist</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../howto/upgrade-version.html">How to upgrade GingerDJ to a newer version</a></li>
<li class="toctree-l2"><a class="reference internal" href="../howto/error-reporting.html">How to manage error reporting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../howto/initial-data.html">How to provide initial data for models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../howto/legacy-databases.html">How to integrate GingerDJ with a legacy database</a></li>
<li class="toctree-l2"><a class="reference internal" href="../howto/logging.html">How to configure and use logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../howto/outputting-csv.html">How to create CSV output</a></li>
<li class="toctree-l2"><a class="reference internal" href="../howto/outputting-pdf.html">How to create PDF files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../howto/overriding-templates.html">How to override templates</a></li>
<li class="toctree-l2"><a class="reference internal" href="../howto/static-files/index.html">How to manage static files (e.g. images, JavaScript, CSS)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../howto/static-files/deployment.html">How to deploy static files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../howto/windows.html">How to install GingerDJ on Windows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../howto/writing-migrations.html">How to create database migrations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../howto/delete-app.html">How to delete a GingerDJ application</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../faq/index.html">GingerDJ FAQ</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle navigation of GingerDJ FAQ</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../faq/general.html">FAQ: General</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/install.html">FAQ: Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/usage.html">FAQ: Using GingerDJ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/models.html">FAQ: Databases and models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/admin.html">FAQ: The admin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/troubleshooting.html">Troubleshooting</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../ref/index.html">API Reference</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle navigation of API Reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../ref/applications.html">Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ref/checks.html">System check framework</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../ref/class-based-views/index.html">Built-in class-based views API</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle navigation of Built-in class-based views API</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../ref/class-based-views/base.html">Base views</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/class-based-views/generic-display.html">Generic display views</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/class-based-views/generic-editing.html">Generic editing views</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/class-based-views/generic-date-based.html">Generic date views</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../ref/class-based-views/mixins.html">Class-based views mixins</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle navigation of Class-based views mixins</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../ref/class-based-views/mixins-simple.html">Simple mixins</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/class-based-views/mixins-single-object.html">Single object mixins</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/class-based-views/mixins-multiple-object.html">Multiple object mixins</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/class-based-views/mixins-editing.html">Editing mixins</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/class-based-views/mixins-date-based.html">Date-based mixins</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../ref/class-based-views/flattened-index.html">Class-based generic views - flattened index</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../ref/clickjacking.html">Clickjacking Protection</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../ref/contrib/index.html"><code class="docutils literal notranslate"><span class="pre">contrib</span></code> packages</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><div class="visually-hidden">Toggle navigation of contrib packages</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../ref/contrib/admin/index.html">The GingerDJ admin site</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><div class="visually-hidden">Toggle navigation of The GingerDJ admin site</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/admin/actions.html">Admin actions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/admin/filters.html"><code class="docutils literal notranslate"><span class="pre">ModelAdmin</span></code> List Filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/admin/admindocs.html">The GingerDJ admin documentation generator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/admin/javascript.html">JavaScript customizations in the admin</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../ref/contrib/flatpages.html">The flatpages app</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../ref/contrib/gis/index.html">GeoGinger</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><div class="visually-hidden">Toggle navigation of GeoGinger</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/gis/tutorial.html">GeoGinger Tutorial</a></li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../ref/contrib/gis/install/index.html">GeoGinger Installation</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" role="switch" type="checkbox"/><label for="toctree-checkbox-21"><div class="visually-hidden">Toggle navigation of GeoGinger Installation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../ref/contrib/gis/install/geolibs.html">Installing Geospatial libraries</a></li>
<li class="toctree-l5"><a class="reference internal" href="../ref/contrib/gis/install/postgis.html">Installing PostGIS</a></li>
<li class="toctree-l5"><a class="reference internal" href="../ref/contrib/gis/install/spatialite.html">Installing SpatiaLite</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/gis/model-api.html">GeoGinger Model API</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/gis/db-api.html">GeoGinger Database API</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/gis/forms-api.html">GeoGinger Forms API</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/gis/geoquerysets.html">GIS QuerySet API Reference</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/gis/functions.html">Geographic Database Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/gis/measure.html">Measurement Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/gis/geos.html">GEOS API</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/gis/gdal.html">GDAL API</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/gis/geoip2.html">Geolocation with GeoIP2</a></li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../ref/contrib/gis/utils.html">GeoGinger Utilities</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" role="switch" type="checkbox"/><label for="toctree-checkbox-22"><div class="visually-hidden">Toggle navigation of GeoGinger Utilities</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../ref/contrib/gis/layermapping.html"><code class="docutils literal notranslate"><span class="pre">LayerMapping</span></code> data import utility</a></li>
<li class="toctree-l5"><a class="reference internal" href="../ref/contrib/gis/ogrinspect.html">OGR Inspection</a></li>
<li class="toctree-l5"><a class="reference internal" href="../ref/contrib/gis/serializers.html"><code class="docutils literal notranslate"><span class="pre">GeoJSON</span></code> Serializer</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/gis/commands.html">GeoGinger Management Commands</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/gis/admin.html">GeoGinger’s admin site</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/gis/feeds.html">Geographic Feeds</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/gis/sitemaps.html">Geographic Sitemaps</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/gis/testing.html">Testing GeoGinger apps</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/gis/deployment.html">Deploying GeoGinger</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../ref/contrib/humanize.html"><code class="docutils literal notranslate"><span class="pre">gingerdj.contrib.humanize</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/contrib/messages.html">The messages framework</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../ref/contrib/postgres/index.html"><code class="docutils literal notranslate"><span class="pre">gingerdj.contrib.postgres</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" role="switch" type="checkbox"/><label for="toctree-checkbox-23"><div class="visually-hidden">Toggle navigation of gingerdj.contrib.postgres</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/postgres/aggregates.html">PostgreSQL specific aggregation functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/postgres/constraints.html">PostgreSQL specific database constraints</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/postgres/expressions.html">PostgreSQL specific query expressions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/postgres/fields.html">PostgreSQL specific model fields</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/postgres/forms.html">PostgreSQL specific form fields and widgets</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/postgres/functions.html">PostgreSQL specific database functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/postgres/indexes.html">PostgreSQL specific model indexes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/postgres/lookups.html">PostgreSQL specific lookups</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/postgres/operations.html">Database migration operations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/postgres/search.html">Full text search</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/postgres/validators.html">Validators</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../ref/contrib/redirects.html">The redirects app</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/contrib/sitemaps.html">The sitemap framework</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/contrib/sites.html">The “sites” framework</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/contrib/staticfiles.html">The <code class="docutils literal notranslate"><span class="pre">staticfiles</span></code> app</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/contrib/syndication.html">The syndication feed framework</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../ref/csrf.html">Cross Site Request Forgery protection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ref/databases.html">Databases</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ref/gingerdj-admin.html"><code class="docutils literal notranslate"><span class="pre">gingerdj-admin</span></code> and <code class="docutils literal notranslate"><span class="pre">manage.py</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../ref/gingerdj-admin.html#running-management-commands-from-your-code">Running management commands from your code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ref/exceptions.html">GingerDJ Exceptions</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../ref/files/index.html">File handling</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" role="switch" type="checkbox"/><label for="toctree-checkbox-24"><div class="visually-hidden">Toggle navigation of File handling</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../ref/files/file.html">The <code class="docutils literal notranslate"><span class="pre">File</span></code> object</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/files/storage.html">File storage API</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/files/uploads.html">Uploaded Files and Upload Handlers</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../ref/forms/index.html">Forms</a><input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" role="switch" type="checkbox"/><label for="toctree-checkbox-25"><div class="visually-hidden">Toggle navigation of Forms</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../ref/forms/api.html">The Forms API</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/forms/fields.html">Form fields</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/forms/models.html">Model Form Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/forms/formsets.html">Formset Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/forms/renderers.html">The form rendering API</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/forms/widgets.html">Widgets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/forms/validation.html">Form and field validation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../ref/logging.html">Logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ref/middleware.html">Middleware</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ref/migration-operations.html">Migration Operations</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../ref/models/index.html">Models</a><input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" role="switch" type="checkbox"/><label for="toctree-checkbox-26"><div class="visually-hidden">Toggle navigation of Models</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../ref/models/fields.html">Model field reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/models/fields.html#field-attribute-reference">Field attribute reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/models/indexes.html">Model index reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/models/constraints.html">Constraints reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/models/meta.html">Model <code class="docutils literal notranslate"><span class="pre">_meta</span></code> API</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/models/relations.html">Related objects reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/models/class.html">Model class reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/models/options.html">Model <code class="docutils literal notranslate"><span class="pre">Meta</span></code> options</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/models/instances.html">Model instance reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/models/querysets.html"><code class="docutils literal notranslate"><span class="pre">QuerySet</span></code> API reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/models/lookups.html">Lookup API reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/models/expressions.html">Query Expressions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/models/conditional-expressions.html">Conditional Expressions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/models/database-functions.html">Database Functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../ref/paginator.html">Paginator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ref/request-response.html">Request and response objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ref/schema-editor.html"><code class="docutils literal notranslate"><span class="pre">SchemaEditor</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../ref/settings.html">Settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ref/signals.html">Signals</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../ref/templates/index.html">Templates</a><input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" role="switch" type="checkbox"/><label for="toctree-checkbox-27"><div class="visually-hidden">Toggle navigation of Templates</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../ref/templates/language.html">The GingerDJ template language</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/templates/builtins.html">Built-in template tags and filters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/templates/api.html">The GingerDJ template language: for Python programmers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../ref/template-response.html"><code class="docutils literal notranslate"><span class="pre">TemplateResponse</span></code> and <code class="docutils literal notranslate"><span class="pre">SimpleTemplateResponse</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../ref/unicode.html">Unicode data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ref/urlresolvers.html"><code class="docutils literal notranslate"><span class="pre">gingerdj.urls</span></code> utility functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ref/urls.html"><code class="docutils literal notranslate"><span class="pre">gingerdj.urls</span></code> functions for use in URLconfs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ref/urls.html#module-gingerdj.conf.urls"><code class="docutils literal notranslate"><span class="pre">gingerdj.conf.urls</span></code> functions for use in URLconfs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ref/utils.html">GingerDJ Utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ref/validators.html">Validators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ref/views.html">Built-in Views</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../misc/index.html">Meta-documentation and miscellany</a><input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" role="switch" type="checkbox"/><label for="toctree-checkbox-28"><div class="visually-hidden">Toggle navigation of Meta-documentation and miscellany</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../misc/api-stability.html">API stability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../misc/design-philosophies.html">Design philosophies</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/topics/migrations.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="s-module-gingerdj.db.migrations">
<span id="s-migrations"></span><span id="module-gingerdj.db.migrations"></span><span id="migrations"></span><h1>Migrations<a class="headerlink" href="#module-gingerdj.db.migrations" title="Link to this heading">¶</a></h1>
<p>Migrations are GingerDJ’s way of propagating changes you make to your models
(adding a field, deleting a model, etc.) into your database schema. They’re
designed to be mostly automatic, but you’ll need to know when to make
migrations, when to run them, and the common problems you might run into.</p>
<section id="s-the-commands">
<span id="the-commands"></span><h2>The Commands<a class="headerlink" href="#the-commands" title="Link to this heading">¶</a></h2>
<p>There are several commands which you will use to interact with migrations
and GingerDJ’s handling of database schema:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../ref/gingerdj-admin.html#gingerdj-admin-migrate"><code class="xref std std-djadmin docutils literal notranslate"><span class="pre">migrate</span></code></a>, which is responsible for applying and unapplying
migrations.</p></li>
<li><p><a class="reference internal" href="../ref/gingerdj-admin.html#gingerdj-admin-makemigrations"><code class="xref std std-djadmin docutils literal notranslate"><span class="pre">makemigrations</span></code></a>, which is responsible for creating new migrations
based on the changes you have made to your models.</p></li>
<li><p><a class="reference internal" href="../ref/gingerdj-admin.html#gingerdj-admin-sqlmigrate"><code class="xref std std-djadmin docutils literal notranslate"><span class="pre">sqlmigrate</span></code></a>, which displays the SQL statements for a migration.</p></li>
<li><p><a class="reference internal" href="../ref/gingerdj-admin.html#gingerdj-admin-showmigrations"><code class="xref std std-djadmin docutils literal notranslate"><span class="pre">showmigrations</span></code></a>, which lists a project’s migrations and their
status.</p></li>
</ul>
<p>You should think of migrations as a version control system for your database
schema. <code class="docutils literal notranslate"><span class="pre">makemigrations</span></code> is responsible for packaging up your model changes
into individual migration files - analogous to commits - and <code class="docutils literal notranslate"><span class="pre">migrate</span></code> is
responsible for applying those to your database.</p>
<p>The migration files for each app live in a “migrations” directory inside
of that app, and are designed to be committed to, and distributed as part
of, its codebase. You should be making them once on your development machine
and then running the same migrations on your colleagues’ machines, your
staging machines, and eventually your production machines.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is possible to override the name of the package which contains the
migrations on a per-app basis by modifying the <a class="reference internal" href="../ref/settings.html#std-setting-MIGRATION_MODULES"><code class="xref std std-setting docutils literal notranslate"><span class="pre">MIGRATION_MODULES</span></code></a>
setting.</p>
</div>
<p>Migrations will run the same way on the same dataset and produce consistent
results, meaning that what you see in development and staging is, under the
same circumstances, exactly what will happen in production.</p>
<p>GingerDJ will make migrations for any change to your models or fields - even
options that don’t affect the database - as the only way it can reconstruct
a field correctly is to have all the changes in the history, and you might
need those options in some data migrations later on (for example, if you’ve
set custom validators).</p>
</section>
<section id="s-backend-support">
<span id="backend-support"></span><h2>Backend Support<a class="headerlink" href="#backend-support" title="Link to this heading">¶</a></h2>
<p>Migrations are supported on all backends that GingerDJ ships with, as well
as any third-party backends if they have programmed in support for schema
alteration (done via the <a class="reference internal" href="../ref/schema-editor.html"><span class="doc">SchemaEditor</span></a> class).</p>
<p>However, some databases are more capable than others when it comes to
schema migrations; some of the caveats are covered below.</p>
<section id="s-postgresql">
<span id="postgresql"></span><h3>PostgreSQL<a class="headerlink" href="#postgresql" title="Link to this heading">¶</a></h3>
<p>PostgreSQL is the most capable of all the databases here in terms of schema
support.</p>
</section>
<section id="s-mysql">
<span id="mysql"></span><h3>MySQL<a class="headerlink" href="#mysql" title="Link to this heading">¶</a></h3>
<p>MySQL lacks support for transactions around schema alteration operations,
meaning that if a migration fails to apply you will have to manually unpick
the changes in order to try again (it’s impossible to roll back to an
earlier point).</p>
<p>MySQL 8.0 introduced significant performance enhancements for
<a class="reference external" href="https://dev.mysql.com/doc/refman/en/innodb-online-ddl-operations.html">DDL operations</a>, making them more efficient and reducing the need for full
table rebuilds. However, it cannot guarantee a complete absence of locks or
interruptions. In situations where locks are still necessary, the duration of
these operations will be proportionate to the number of rows involved.</p>
<p>Finally, MySQL has a relatively small limit on the combined size of all columns
an index covers. This means that indexes that are possible on other backends
will fail to be created under MySQL.</p>
</section>
<section id="s-sqlite">
<span id="sqlite"></span><h3>SQLite<a class="headerlink" href="#sqlite" title="Link to this heading">¶</a></h3>
<p>SQLite has very little built-in schema alteration support, and so GingerDJ
attempts to emulate it by:</p>
<ul class="simple">
<li><p>Creating a new table with the new schema</p></li>
<li><p>Copying the data across</p></li>
<li><p>Dropping the old table</p></li>
<li><p>Renaming the new table to match the original name</p></li>
</ul>
<p>This process generally works well, but it can be slow and occasionally
buggy. It is not recommended that you run and migrate SQLite in a
production environment unless you are very aware of the risks and
its limitations; the support GingerDJ ships with is designed to allow
developers to use SQLite on their local machines to develop less complex
GingerDJ projects without the need for a full database.</p>
</section>
</section>
<section id="s-workflow">
<span id="workflow"></span><h2>Workflow<a class="headerlink" href="#workflow" title="Link to this heading">¶</a></h2>
<p>GingerDJ can create migrations for you. Make changes to your models - say, add a
field and remove a model - and then run <a class="reference internal" href="../ref/gingerdj-admin.html#gingerdj-admin-makemigrations"><code class="xref std std-djadmin docutils literal notranslate"><span class="pre">makemigrations</span></code></a>:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>python<span class="w"> </span>manage.py<span class="w"> </span>makemigrations
Migrations<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="s1">&#39;books&#39;</span>:
<span class="w">  </span>books/migrations/0003_auto.py:
<span class="w">    </span>~<span class="w"> </span>Alter<span class="w"> </span>field<span class="w"> </span>author<span class="w"> </span>on<span class="w"> </span>book
</pre></div>
</div>
<p>Your models will be scanned and compared to the versions currently
contained in your migration files, and then a new set of migrations
will be written out. Make sure to read the output to see what
<code class="docutils literal notranslate"><span class="pre">makemigrations</span></code> thinks you have changed - it’s not perfect, and for
complex changes it might not be detecting what you expect.</p>
<p>Once you have your new migration files, you should apply them to your
database to make sure they work as expected:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>python<span class="w"> </span>manage.py<span class="w"> </span>migrate
Operations<span class="w"> </span>to<span class="w"> </span>perform:
<span class="w">  </span>Apply<span class="w"> </span>all<span class="w"> </span>migrations:<span class="w"> </span>books
Running<span class="w"> </span>migrations:
<span class="w">  </span>Rendering<span class="w"> </span>model<span class="w"> </span>states...<span class="w"> </span>DONE
<span class="w">  </span>Applying<span class="w"> </span>books.0003_auto...<span class="w"> </span>OK
</pre></div>
</div>
<p>Once the migration is applied, commit the migration and the models change
to your version control system as a single commit - that way, when other
developers (or your production servers) check out the code, they’ll
get both the changes to your models and the accompanying migration at the
same time.</p>
<p>If you want to give the migration(s) a meaningful name instead of a generated
one, you can use the <a class="reference internal" href="../ref/gingerdj-admin.html#cmdoption-makemigrations-name"><code class="xref std std-option docutils literal notranslate"><span class="pre">makemigrations</span> <span class="pre">--name</span></code></a> option:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>python<span class="w"> </span>manage.py<span class="w"> </span>makemigrations<span class="w"> </span>--name<span class="w"> </span>changed_my_model<span class="w"> </span>your_app_label
</pre></div>
</div>
<section id="s-version-control">
<span id="version-control"></span><h3>Version control<a class="headerlink" href="#version-control" title="Link to this heading">¶</a></h3>
<p>Because migrations are stored in version control, you’ll occasionally
come across situations where you and another developer have both committed
a migration to the same app at the same time, resulting in two migrations
with the same number.</p>
<p>Don’t worry - the numbers are just there for developers’ reference, GingerDJ
just cares that each migration has a different name. Migrations specify which
other migrations they depend on - including earlier migrations in the same
app - in the file, so it’s possible to detect when there’s two new migrations
for the same app that aren’t ordered.</p>
<p>When this happens, GingerDJ will prompt you and give you some options. If it
thinks it’s safe enough, it will offer to automatically linearize the two
migrations for you. If not, you’ll have to go in and modify the migrations
yourself - don’t worry, this isn’t difficult, and is explained more in
<a class="reference internal" href="#migration-files"><span class="std std-ref">Migration files</span></a> below.</p>
</section>
</section>
<section id="s-transactions">
<span id="transactions"></span><h2>Transactions<a class="headerlink" href="#transactions" title="Link to this heading">¶</a></h2>
<p>On databases that support DDL transactions (SQLite and PostgreSQL), all
migration operations will run inside a single transaction by default. In
contrast, if a database doesn’t support DDL transactions (e.g. MySQL, Oracle)
then all operations will run without a transaction.</p>
<p>You can prevent a migration from running in a transaction by setting the
<code class="docutils literal notranslate"><span class="pre">atomic</span></code> attribute to <code class="docutils literal notranslate"><span class="pre">False</span></code>. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gingerdj.db</span> <span class="kn">import</span> <span class="n">migrations</span>


<span class="k">class</span> <span class="nc">Migration</span><span class="p">(</span><span class="n">migrations</span><span class="o">.</span><span class="n">Migration</span><span class="p">):</span>
    <span class="n">atomic</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>
</div>
<p>It’s also possible to execute parts of the migration inside a transaction using
<a class="reference internal" href="db/transactions.html#gingerdj.db.transaction.atomic" title="gingerdj.db.transaction.atomic"><code class="xref py py-func docutils literal notranslate"><span class="pre">atomic()</span></code></a> or by passing <code class="docutils literal notranslate"><span class="pre">atomic=True</span></code> to
<a class="reference internal" href="../ref/migration-operations.html#gingerdj.db.migrations.operations.RunPython" title="gingerdj.db.migrations.operations.RunPython"><code class="xref py py-class docutils literal notranslate"><span class="pre">RunPython</span></code></a>. See
<a class="reference internal" href="../howto/writing-migrations.html#non-atomic-migrations"><span class="std std-ref">Non-atomic migrations</span></a> for more details.</p>
</section>
<section id="s-dependencies">
<span id="dependencies"></span><h2>Dependencies<a class="headerlink" href="#dependencies" title="Link to this heading">¶</a></h2>
<p>While migrations are per-app, the tables and relationships implied by
your models are too complex to be created for one app at a time. When you make
a migration that requires something else to run - for example, you add a
<code class="docutils literal notranslate"><span class="pre">ForeignKey</span></code> in your <code class="docutils literal notranslate"><span class="pre">books</span></code> app to your <code class="docutils literal notranslate"><span class="pre">authors</span></code> app - the resulting
migration will contain a dependency on a migration in <code class="docutils literal notranslate"><span class="pre">authors</span></code>.</p>
<p>This means that when you run the migrations, the <code class="docutils literal notranslate"><span class="pre">authors</span></code> migration runs
first and creates the table the <code class="docutils literal notranslate"><span class="pre">ForeignKey</span></code> references, and then the migration
that makes the <code class="docutils literal notranslate"><span class="pre">ForeignKey</span></code> column runs afterward and creates the constraint.
If this didn’t happen, the migration would try to create the <code class="docutils literal notranslate"><span class="pre">ForeignKey</span></code>
column without the table it’s referencing existing and your database would
throw an error.</p>
<p>This dependency behavior affects most migration operations where you
restrict to a single app. Restricting to a single app (either in
<code class="docutils literal notranslate"><span class="pre">makemigrations</span></code> or <code class="docutils literal notranslate"><span class="pre">migrate</span></code>) is a best-efforts promise, and not
a guarantee; any other apps that need to be used to get dependencies correct
will be.</p>
<p>Apps without migrations must not have relations (<code class="docutils literal notranslate"><span class="pre">ForeignKey</span></code>,
<code class="docutils literal notranslate"><span class="pre">ManyToManyField</span></code>, etc.) to apps with migrations. Sometimes it may work, but
it’s not supported.</p>
<section id="s-swappable-dependencies">
<span id="swappable-dependencies"></span><h3>Swappable dependencies<a class="headerlink" href="#swappable-dependencies" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="gingerdj.db.migrations.gingerdj.db.migrations.swappable_dependency">
<span class="sig-prename descclassname"><span class="pre">gingerdj.db.migrations.</span></span><span class="sig-name descname"><span class="pre">swappable_dependency</span></span>(<em class="sig-param"><span class="n"><span class="pre">value</span></span></em>)<a class="headerlink" href="#gingerdj.db.migrations.gingerdj.db.migrations.swappable_dependency" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">swappable_dependency()</span></code> function is used in migrations to declare
“swappable” dependencies on migrations in the app of the swapped-in model,
currently, on the first migration of this app. As a consequence, the swapped-in
model should be created in the initial migration. The argument <code class="docutils literal notranslate"><span class="pre">value</span></code> is a
string <code class="docutils literal notranslate"><span class="pre">&quot;&lt;app</span> <span class="pre">label&gt;.&lt;model&gt;&quot;</span></code> describing an app label and a model name, e.g.
<code class="docutils literal notranslate"><span class="pre">&quot;myapp.MyModel&quot;</span></code>.</p>
<p>By using <code class="docutils literal notranslate"><span class="pre">swappable_dependency()</span></code>, you inform the migration framework that
the migration relies on another migration which sets up a swappable model,
allowing for the possibility of substituting the model with a different
implementation in the future. This is typically used for referencing models
that are subject to customization or replacement</p>
</section>
</section>
<section id="s-migration-files">
<span id="s-id1"></span><span id="migration-files"></span><span id="id1"></span><h2>Migration files<a class="headerlink" href="#migration-files" title="Link to this heading">¶</a></h2>
<p>Migrations are stored as an on-disk format, referred to here as
“migration files”. These files are actually normal Python files with an
agreed-upon object layout, written in a declarative style.</p>
<p>A basic migration file looks like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gingerdj.db</span> <span class="kn">import</span> <span class="n">migrations</span><span class="p">,</span> <span class="n">models</span>


<span class="k">class</span> <span class="nc">Migration</span><span class="p">(</span><span class="n">migrations</span><span class="o">.</span><span class="n">Migration</span><span class="p">):</span>
    <span class="n">dependencies</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;migrations&quot;</span><span class="p">,</span> <span class="s2">&quot;0001_initial&quot;</span><span class="p">)]</span>

    <span class="n">operations</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">migrations</span><span class="o">.</span><span class="n">DeleteModel</span><span class="p">(</span><span class="s2">&quot;Tribble&quot;</span><span class="p">),</span>
        <span class="n">migrations</span><span class="o">.</span><span class="n">AddField</span><span class="p">(</span><span class="s2">&quot;Author&quot;</span><span class="p">,</span> <span class="s2">&quot;rating&quot;</span><span class="p">,</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">)),</span>
    <span class="p">]</span>
</pre></div>
</div>
<p>What GingerDJ looks for when it loads a migration file (as a Python module) is
a subclass of <code class="docutils literal notranslate"><span class="pre">gingerdj.db.migrations.Migration</span></code> called <code class="docutils literal notranslate"><span class="pre">Migration</span></code>. It then
inspects this object for four attributes, only two of which are used
most of the time:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">dependencies</span></code>, a list of migrations this one depends on.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">operations</span></code>, a list of <code class="docutils literal notranslate"><span class="pre">Operation</span></code> classes that define what this
migration does.</p></li>
</ul>
<p>The operations are the key; they are a set of declarative instructions which
tell GingerDJ what schema changes need to be made. GingerDJ scans them and
builds an in-memory representation of all of the schema changes to all apps,
and uses this to generate the SQL which makes the schema changes.</p>
<p>That in-memory structure is also used to work out what the differences are
between your models and the current state of your migrations; GingerDJ runs
through all the changes, in order, on an in-memory set of models to come
up with the state of your models last time you ran <code class="docutils literal notranslate"><span class="pre">makemigrations</span></code>. It
then uses these models to compare against the ones in your <code class="docutils literal notranslate"><span class="pre">models.py</span></code> files
to work out what you have changed.</p>
<p>You should rarely, if ever, need to edit migration files by hand, but
it’s entirely possible to write them manually if you need to. Some of the
more complex operations are not autodetectable and are only available via
a hand-written migration, so don’t be scared about editing them if you have to.</p>
<section id="s-custom-fields">
<span id="custom-fields"></span><h3>Custom fields<a class="headerlink" href="#custom-fields" title="Link to this heading">¶</a></h3>
<p>You can’t modify the number of positional arguments in an already migrated
custom field without raising a <code class="docutils literal notranslate"><span class="pre">TypeError</span></code>. The old migration will call the
modified <code class="docutils literal notranslate"><span class="pre">__init__</span></code> method with the old signature. So if you need a new
argument, please create a keyword argument and add something like
<code class="docutils literal notranslate"><span class="pre">assert</span> <span class="pre">'argument_name'</span> <span class="pre">in</span> <span class="pre">kwargs</span></code> in the constructor.</p>
</section>
<section id="s-model-managers">
<span id="s-using-managers-in-migrations"></span><span id="model-managers"></span><span id="using-managers-in-migrations"></span><h3>Model managers<a class="headerlink" href="#model-managers" title="Link to this heading">¶</a></h3>
<p>You can optionally serialize managers into migrations and have them available
in <a class="reference internal" href="../ref/migration-operations.html#gingerdj.db.migrations.operations.RunPython" title="gingerdj.db.migrations.operations.RunPython"><code class="xref py py-class docutils literal notranslate"><span class="pre">RunPython</span></code></a> operations. This is done
by defining a <code class="docutils literal notranslate"><span class="pre">use_in_migrations</span></code> attribute on the manager class:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyManager</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Manager</span><span class="p">):</span>
    <span class="n">use_in_migrations</span> <span class="o">=</span> <span class="kc">True</span>


<span class="k">class</span> <span class="nc">MyModel</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">objects</span> <span class="o">=</span> <span class="n">MyManager</span><span class="p">()</span>
</pre></div>
</div>
<p>If you are using the <a class="reference internal" href="db/managers.html#gingerdj.db.models.from_queryset" title="gingerdj.db.models.from_queryset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">from_queryset()</span></code></a> function to
dynamically generate a manager class, you need to inherit from the generated
class to make it importable:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyManager</span><span class="p">(</span><span class="n">MyBaseManager</span><span class="o">.</span><span class="n">from_queryset</span><span class="p">(</span><span class="n">CustomQuerySet</span><span class="p">)):</span>
    <span class="n">use_in_migrations</span> <span class="o">=</span> <span class="kc">True</span>


<span class="k">class</span> <span class="nc">MyModel</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">objects</span> <span class="o">=</span> <span class="n">MyManager</span><span class="p">()</span>
</pre></div>
</div>
<p>Please refer to the notes about <a class="reference internal" href="#historical-models"><span class="std std-ref">Historical models</span></a> in migrations to see
the implications that come along.</p>
</section>
<section id="s-initial-migrations">
<span id="initial-migrations"></span><h3>Initial migrations<a class="headerlink" href="#initial-migrations" title="Link to this heading">¶</a></h3>
<dl class="py attribute">
<dt class="sig sig-object py" id="gingerdj.db.migrations.Migration.initial">
<span class="sig-prename descclassname"><span class="pre">Migration.</span></span><span class="sig-name descname"><span class="pre">initial</span></span><a class="headerlink" href="#gingerdj.db.migrations.Migration.initial" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<p>The “initial migrations” for an app are the migrations that create the first
version of that app’s tables. Usually an app will have one initial migration,
but in some cases of complex model interdependencies it may have two or more.</p>
<p>Initial migrations are marked with an <code class="docutils literal notranslate"><span class="pre">initial</span> <span class="pre">=</span> <span class="pre">True</span></code> class attribute on the
migration class. If an <code class="docutils literal notranslate"><span class="pre">initial</span></code> class attribute isn’t found, a migration
will be considered “initial” if it is the first migration in the app (i.e. if
it has no dependencies on any other migration in the same app).</p>
<p>When the <a class="reference internal" href="../ref/gingerdj-admin.html#cmdoption-migrate-fake-initial"><code class="xref std std-option docutils literal notranslate"><span class="pre">migrate</span> <span class="pre">--fake-initial</span></code></a> option is used, these initial
migrations are treated specially. For an initial migration that creates one or
more tables (<code class="docutils literal notranslate"><span class="pre">CreateModel</span></code> operation), GingerDJ checks that all of those tables
already exist in the database and fake-applies the migration if so. Similarly,
for an initial migration that adds one or more fields (<code class="docutils literal notranslate"><span class="pre">AddField</span></code> operation),
GingerDJ checks that all of the respective columns already exist in the database
and fake-applies the migration if so. Without <code class="docutils literal notranslate"><span class="pre">--fake-initial</span></code>, initial
migrations are treated no differently from any other migration.</p>
</section>
<section id="s-history-consistency">
<span id="s-migration-history-consistency"></span><span id="history-consistency"></span><span id="migration-history-consistency"></span><h3>History consistency<a class="headerlink" href="#history-consistency" title="Link to this heading">¶</a></h3>
<p>As previously discussed, you may need to linearize migrations manually when two
development branches are joined. While editing migration dependencies, you can
inadvertently create an inconsistent history state where a migration has been
applied but some of its dependencies haven’t. This is a strong indication that
the dependencies are incorrect, so GingerDJ will refuse to run migrations or make
new migrations until it’s fixed. When using multiple databases, you can use the
<a class="reference internal" href="db/multi-db.html#allow_migrate" title="allow_migrate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">allow_migrate()</span></code></a> method of <a class="reference internal" href="db/multi-db.html#topics-db-multi-db-routing"><span class="std std-ref">database routers</span></a> to control which databases
<a class="reference internal" href="../ref/gingerdj-admin.html#gingerdj-admin-makemigrations"><code class="xref std std-djadmin docutils literal notranslate"><span class="pre">makemigrations</span></code></a> checks for consistent history.</p>
</section>
</section>
<section id="s-adding-migrations-to-apps">
<span id="adding-migrations-to-apps"></span><h2>Adding migrations to apps<a class="headerlink" href="#adding-migrations-to-apps" title="Link to this heading">¶</a></h2>
<p>New apps come preconfigured to accept migrations, and so you can add migrations
by running <a class="reference internal" href="../ref/gingerdj-admin.html#gingerdj-admin-makemigrations"><code class="xref std std-djadmin docutils literal notranslate"><span class="pre">makemigrations</span></code></a> once you’ve made some changes.</p>
<p>If your app already has models and database tables, and doesn’t have migrations
yet (for example, you created it against a previous GingerDJ version), you’ll
need to convert it to use migrations by running:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>python<span class="w"> </span>manage.py<span class="w"> </span>makemigrations<span class="w"> </span>your_app_label
</pre></div>
</div>
<p>This will make a new initial migration for your app. Now, run <code class="docutils literal notranslate"><span class="pre">python</span>
<span class="pre">manage.py</span> <span class="pre">migrate</span> <span class="pre">--fake-initial</span></code>, and GingerDJ will detect that you have an
initial migration <em>and</em> that the tables it wants to create already exist, and
will mark the migration as already applied. (Without the <a class="reference internal" href="../ref/gingerdj-admin.html#cmdoption-migrate-fake-initial"><code class="xref std std-option docutils literal notranslate"><span class="pre">migrate</span>
<span class="pre">--fake-initial</span></code></a> flag, the command would error out because the tables it wants
to create already exist.)</p>
<p>Note that this only works given two things:</p>
<ul class="simple">
<li><p>You have not changed your models since you made their tables. For migrations
to work, you must make the initial migration <em>first</em> and then make changes,
as GingerDJ compares changes against migration files, not the database.</p></li>
<li><p>You have not manually edited your database - GingerDJ won’t be able to detect
that your database doesn’t match your models, you’ll just get errors when
migrations try to modify those tables.</p></li>
</ul>
</section>
<section id="s-reversing-migrations">
<span id="s-id2"></span><span id="reversing-migrations"></span><span id="id2"></span><h2>Reversing migrations<a class="headerlink" href="#reversing-migrations" title="Link to this heading">¶</a></h2>
<p>Migrations can be reversed with <a class="reference internal" href="../ref/gingerdj-admin.html#gingerdj-admin-migrate"><code class="xref std std-djadmin docutils literal notranslate"><span class="pre">migrate</span></code></a> by passing the number of the
previous migration. For example, to reverse migration <code class="docutils literal notranslate"><span class="pre">books.0003</span></code>:</p>
<div class="console-block" id="console-block-0">
<input class="c-tab-unix" id="c-tab-0-unix" type="radio" name="console-0" checked>
<label for="c-tab-0-unix" title="Linux/macOS">&#xf17c/&#xf179</label>
<input class="c-tab-win" id="c-tab-0-win" type="radio" name="console-0">
<label for="c-tab-0-win" title="Windows">&#xf17a</label>
<section class="c-content-unix" id="c-content-0-unix">
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>python<span class="w"> </span>manage.py<span class="w"> </span>migrate<span class="w"> </span>books<span class="w"> </span><span class="m">0002</span>
<span class="go">Operations to perform:</span>
<span class="go">  Target specific migration: 0002_auto, from books</span>
<span class="go">Running migrations:</span>
<span class="go">  Rendering model states... DONE</span>
<span class="go">  Unapplying books.0003_auto... OK</span>
</pre></div>
</div>
</section>
<section class="c-content-win" id="c-content-0-win">
<div class="highlight"><pre><span></span><span class="gp">...\&gt;</span> py manage.py migrate books 0002
<span class="go">Operations to perform:</span>
<span class="go">  Target specific migration: 0002_auto, from books</span>
<span class="go">Running migrations:</span>
<span class="go">  Rendering model states... DONE</span>
<span class="go">  Unapplying books.0003_auto... OK</span>
</pre></div>
</section>
</div>
<p>If you want to reverse all migrations applied for an app, use the name
<code class="docutils literal notranslate"><span class="pre">zero</span></code>:</p>
<div class="console-block" id="console-block-1">
<input class="c-tab-unix" id="c-tab-1-unix" type="radio" name="console-1" checked>
<label for="c-tab-1-unix" title="Linux/macOS">&#xf17c/&#xf179</label>
<input class="c-tab-win" id="c-tab-1-win" type="radio" name="console-1">
<label for="c-tab-1-win" title="Windows">&#xf17a</label>
<section class="c-content-unix" id="c-content-1-unix">
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>python<span class="w"> </span>manage.py<span class="w"> </span>migrate<span class="w"> </span>books<span class="w"> </span>zero
<span class="go">Operations to perform:</span>
<span class="go">  Unapply all migrations: books</span>
<span class="go">Running migrations:</span>
<span class="go">  Rendering model states... DONE</span>
<span class="go">  Unapplying books.0002_auto... OK</span>
<span class="go">  Unapplying books.0001_initial... OK</span>
</pre></div>
</div>
</section>
<section class="c-content-win" id="c-content-1-win">
<div class="highlight"><pre><span></span><span class="gp">...\&gt;</span> py manage.py migrate books zero
<span class="go">Operations to perform:</span>
<span class="go">  Unapply all migrations: books</span>
<span class="go">Running migrations:</span>
<span class="go">  Rendering model states... DONE</span>
<span class="go">  Unapplying books.0002_auto... OK</span>
<span class="go">  Unapplying books.0001_initial... OK</span>
</pre></div>
</section>
</div>
<p>A migration is irreversible if it contains any irreversible operations.
Attempting to reverse such migrations will raise <code class="docutils literal notranslate"><span class="pre">IrreversibleError</span></code>:</p>
<div class="console-block" id="console-block-2">
<input class="c-tab-unix" id="c-tab-2-unix" type="radio" name="console-2" checked>
<label for="c-tab-2-unix" title="Linux/macOS">&#xf17c/&#xf179</label>
<input class="c-tab-win" id="c-tab-2-win" type="radio" name="console-2">
<label for="c-tab-2-win" title="Windows">&#xf17a</label>
<section class="c-content-unix" id="c-content-2-unix">
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>python<span class="w"> </span>manage.py<span class="w"> </span>migrate<span class="w"> </span>books<span class="w"> </span><span class="m">0002</span>
<span class="go">Operations to perform:</span>
<span class="go">  Target specific migration: 0002_auto, from books</span>
<span class="go">Running migrations:</span>
<span class="go">  Rendering model states... DONE</span>
<span class="go">  Unapplying books.0003_auto...Traceback (most recent call last):</span>
<span class="go">gingerdj.db.migrations.exceptions.IrreversibleError: Operation &lt;RunSQL  sql=&#39;DROP TABLE demo_books&#39;&gt; in books.0003_auto is not reversible</span>
</pre></div>
</div>
</section>
<section class="c-content-win" id="c-content-2-win">
<div class="highlight"><pre><span></span><span class="gp">...\&gt;</span> py manage.py migrate books 0002
<span class="go">Operations to perform:</span>
<span class="go">  Target specific migration: 0002_auto, from books</span>
<span class="go">Running migrations:</span>
<span class="go">  Rendering model states... DONE</span>
<span class="go">  Unapplying books.0003_auto...Traceback (most recent call last):</span>
<span class="gp">gingerdj.db.migrations.exceptions.IrreversibleError: Operation &lt;RunSQL  sql=&#39;DROP TABLE demo_books&#39;&gt;</span> in books.0003_auto is not reversible
</pre></div>
</section>
</div>
</section>
<section id="s-historical-models">
<span id="s-id3"></span><span id="historical-models"></span><span id="id3"></span><h2>Historical models<a class="headerlink" href="#historical-models" title="Link to this heading">¶</a></h2>
<p>When you run migrations, GingerDJ is working from historical versions of your
models stored in the migration files. If you write Python code using the
<a class="reference internal" href="../ref/migration-operations.html#gingerdj.db.migrations.operations.RunPython" title="gingerdj.db.migrations.operations.RunPython"><code class="xref py py-class docutils literal notranslate"><span class="pre">RunPython</span></code></a> operation, or if you have
<code class="docutils literal notranslate"><span class="pre">allow_migrate</span></code> methods on your database routers, you <strong>need to use</strong> these
historical model versions rather than importing them directly.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If you import models directly rather than using the historical models,
your migrations <em>may work initially</em> but will fail in the future when you
try to rerun old migrations (commonly, when you set up a new installation
and run through all the migrations to set up the database).</p>
<p>This means that historical model problems may not be immediately obvious.
If you run into this kind of failure, it’s OK to edit the migration to use
the historical models rather than direct imports and commit those changes.</p>
</div>
<p>Because it’s impossible to serialize arbitrary Python code, these historical
models will not have any custom methods that you have defined. They will,
however, have the same fields, relationships, managers (limited to those with
<code class="docutils literal notranslate"><span class="pre">use_in_migrations</span> <span class="pre">=</span> <span class="pre">True</span></code>) and <code class="docutils literal notranslate"><span class="pre">Meta</span></code> options (also versioned, so they may
be different from your current ones).</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This means that you will NOT have custom <code class="docutils literal notranslate"><span class="pre">save()</span></code> methods called on objects
when you access them in migrations, and you will NOT have any custom
constructors or instance methods. Plan appropriately!</p>
</div>
<p>References to functions in field options such as <code class="docutils literal notranslate"><span class="pre">upload_to</span></code> and
<code class="docutils literal notranslate"><span class="pre">limit_choices_to</span></code> and model manager declarations with managers having
<code class="docutils literal notranslate"><span class="pre">use_in_migrations</span> <span class="pre">=</span> <span class="pre">True</span></code> are serialized in migrations, so the functions and
classes will need to be kept around for as long as there is a migration
referencing them. Any <a class="reference internal" href="../howto/custom-model-fields.html"><span class="doc">custom model fields</span></a>
will also need to be kept, since these are imported directly by migrations.</p>
<p>In addition, the concrete base classes of the model are stored as pointers, so
you must always keep base classes around for as long as there is a migration
that contains a reference to them. On the plus side, methods and managers from
these base classes inherit normally, so if you absolutely need access to these
you can opt to move them into a superclass.</p>
<p>To remove old references, you can <a class="reference internal" href="#migration-squashing"><span class="std std-ref">squash migrations</span></a>
or, if there aren’t many references, copy them into the migration files.</p>
</section>
<section id="s-considerations-when-removing-model-fields">
<span id="s-migrations-removing-model-fields"></span><span id="considerations-when-removing-model-fields"></span><span id="migrations-removing-model-fields"></span><h2>Considerations when removing model fields<a class="headerlink" href="#considerations-when-removing-model-fields" title="Link to this heading">¶</a></h2>
<p>Similar to the “references to historical functions” considerations described in
the previous section, removing custom model fields from your project or
third-party app will cause a problem if they are referenced in old migrations.</p>
<p>To help with this situation, GingerDJ provides some model field attributes to
assist with model field deprecation using the <a class="reference internal" href="checks.html"><span class="doc">system checks framework</span></a>.</p>
<p>Add the <code class="docutils literal notranslate"><span class="pre">system_check_deprecated_details</span></code> attribute to your model field
similar to the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">IPAddressField</span><span class="p">(</span><span class="n">Field</span><span class="p">):</span>
    <span class="n">system_check_deprecated_details</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;msg&quot;</span><span class="p">:</span> <span class="p">(</span>
            <span class="s2">&quot;IPAddressField has been deprecated. Support for it (except &quot;</span>
            <span class="s2">&quot;in historical migrations) will be removed in GingerDJ 1.9.&quot;</span>
        <span class="p">),</span>
        <span class="s2">&quot;hint&quot;</span><span class="p">:</span> <span class="s2">&quot;Use GenericIPAddressField instead.&quot;</span><span class="p">,</span>  <span class="c1"># optional</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;fields.W900&quot;</span><span class="p">,</span>  <span class="c1"># pick a unique ID for your field.</span>
    <span class="p">}</span>
</pre></div>
</div>
<p>After a deprecation period of your choosing (two or three feature releases for
fields in GingerDJ itself), change the <code class="docutils literal notranslate"><span class="pre">system_check_deprecated_details</span></code>
attribute to <code class="docutils literal notranslate"><span class="pre">system_check_removed_details</span></code> and update the dictionary similar
to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">IPAddressField</span><span class="p">(</span><span class="n">Field</span><span class="p">):</span>
    <span class="n">system_check_removed_details</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;msg&quot;</span><span class="p">:</span> <span class="p">(</span>
            <span class="s2">&quot;IPAddressField has been removed except for support in &quot;</span>
            <span class="s2">&quot;historical migrations.&quot;</span>
        <span class="p">),</span>
        <span class="s2">&quot;hint&quot;</span><span class="p">:</span> <span class="s2">&quot;Use GenericIPAddressField instead.&quot;</span><span class="p">,</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;fields.E900&quot;</span><span class="p">,</span>  <span class="c1"># pick a unique ID for your field.</span>
    <span class="p">}</span>
</pre></div>
</div>
<p>You should keep the field’s methods that are required for it to operate in
database migrations such as <code class="docutils literal notranslate"><span class="pre">__init__()</span></code>, <code class="docutils literal notranslate"><span class="pre">deconstruct()</span></code>, and
<code class="docutils literal notranslate"><span class="pre">get_internal_type()</span></code>. Keep this stub field for as long as any migrations
which reference the field exist. For example, after squashing migrations and
removing the old ones, you should be able to remove the field completely.</p>
</section>
<section id="s-data-migrations">
<span id="s-id4"></span><span id="data-migrations"></span><span id="id4"></span><h2>Data Migrations<a class="headerlink" href="#data-migrations" title="Link to this heading">¶</a></h2>
<p>As well as changing the database schema, you can also use migrations to change
the data in the database itself, in conjunction with the schema if you want.</p>
<p>Migrations that alter data are usually called “data migrations”; they’re best
written as separate migrations, sitting alongside your schema migrations.</p>
<p>GingerDJ can’t automatically generate data migrations for you, as it does with
schema migrations, but it’s not very hard to write them. Migration files in
GingerDJ are made up of <a class="reference internal" href="../ref/migration-operations.html"><span class="doc">Operations</span></a>, and
the main operation you use for data migrations is
<a class="reference internal" href="../ref/migration-operations.html#gingerdj.db.migrations.operations.RunPython" title="gingerdj.db.migrations.operations.RunPython"><code class="xref py py-class docutils literal notranslate"><span class="pre">RunPython</span></code></a>.</p>
<p>To start, make an empty migration file you can work from (GingerDJ will put
the file in the right place, suggest a name, and add dependencies for you):</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>manage.py<span class="w"> </span>makemigrations<span class="w"> </span>--empty<span class="w"> </span>yourappname
</pre></div>
</div>
<p>Then, open up the file; it should look something like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generated by GingerDJ A.B on YYYY-MM-DD HH:MM</span>
<span class="kn">from</span> <span class="nn">gingerdj.db</span> <span class="kn">import</span> <span class="n">migrations</span>


<span class="k">class</span> <span class="nc">Migration</span><span class="p">(</span><span class="n">migrations</span><span class="o">.</span><span class="n">Migration</span><span class="p">):</span>
    <span class="n">dependencies</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="s2">&quot;yourappname&quot;</span><span class="p">,</span> <span class="s2">&quot;0001_initial&quot;</span><span class="p">),</span>
    <span class="p">]</span>

    <span class="n">operations</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>
</div>
<p>Now, all you need to do is create a new function and have
<a class="reference internal" href="../ref/migration-operations.html#gingerdj.db.migrations.operations.RunPython" title="gingerdj.db.migrations.operations.RunPython"><code class="xref py py-class docutils literal notranslate"><span class="pre">RunPython</span></code></a> use it.
<a class="reference internal" href="../ref/migration-operations.html#gingerdj.db.migrations.operations.RunPython" title="gingerdj.db.migrations.operations.RunPython"><code class="xref py py-class docutils literal notranslate"><span class="pre">RunPython</span></code></a> expects a callable as its argument
which takes two arguments - the first is an <a class="reference internal" href="../ref/applications.html"><span class="doc">app registry</span></a> that has the historical versions of all your models
loaded into it to match where in your history the migration sits, and the
second is a <a class="reference internal" href="../ref/schema-editor.html"><span class="doc">SchemaEditor</span></a>, which you can use to
manually effect database schema changes (but beware, doing this can confuse
the migration autodetector!)</p>
<p>Let’s write a migration that populates our new <code class="docutils literal notranslate"><span class="pre">name</span></code> field with the combined
values of <code class="docutils literal notranslate"><span class="pre">first_name</span></code> and <code class="docutils literal notranslate"><span class="pre">last_name</span></code> (we’ve come to our senses and
realized that not everyone has first and last names). All we need to do is use
the historical model and iterate over the rows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gingerdj.db</span> <span class="kn">import</span> <span class="n">migrations</span>


<span class="k">def</span> <span class="nf">combine_names</span><span class="p">(</span><span class="n">apps</span><span class="p">,</span> <span class="n">schema_editor</span><span class="p">):</span>
    <span class="c1"># We can&#39;t import the Person model directly as it may be a newer</span>
    <span class="c1"># version than this migration expects. We use the historical version.</span>
    <span class="n">Person</span> <span class="o">=</span> <span class="n">apps</span><span class="o">.</span><span class="n">get_model</span><span class="p">(</span><span class="s2">&quot;yourappname&quot;</span><span class="p">,</span> <span class="s2">&quot;Person&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">person</span> <span class="ow">in</span> <span class="n">Person</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
        <span class="n">person</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">person</span><span class="o">.</span><span class="n">first_name</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">person</span><span class="o">.</span><span class="n">last_name</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">person</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>


<span class="k">class</span> <span class="nc">Migration</span><span class="p">(</span><span class="n">migrations</span><span class="o">.</span><span class="n">Migration</span><span class="p">):</span>
    <span class="n">dependencies</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="s2">&quot;yourappname&quot;</span><span class="p">,</span> <span class="s2">&quot;0001_initial&quot;</span><span class="p">),</span>
    <span class="p">]</span>

    <span class="n">operations</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">migrations</span><span class="o">.</span><span class="n">RunPython</span><span class="p">(</span><span class="n">combine_names</span><span class="p">),</span>
    <span class="p">]</span>
</pre></div>
</div>
<p>Once that’s done, we can run <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">manage.py</span> <span class="pre">migrate</span></code> as normal and the
data migration will run in place alongside other migrations.</p>
<p>You can pass a second callable to
<a class="reference internal" href="../ref/migration-operations.html#gingerdj.db.migrations.operations.RunPython" title="gingerdj.db.migrations.operations.RunPython"><code class="xref py py-class docutils literal notranslate"><span class="pre">RunPython</span></code></a> to run whatever logic you
want executed when migrating backwards. If this callable is omitted, migrating
backwards will raise an exception.</p>
<section id="s-accessing-models-from-other-apps">
<span id="accessing-models-from-other-apps"></span><h3>Accessing models from other apps<a class="headerlink" href="#accessing-models-from-other-apps" title="Link to this heading">¶</a></h3>
<p>When writing a <code class="docutils literal notranslate"><span class="pre">RunPython</span></code> function that uses models from apps other than the
one in which the migration is located, the migration’s <code class="docutils literal notranslate"><span class="pre">dependencies</span></code>
attribute should include the latest migration of each app that is involved,
otherwise you may get an error similar to: <code class="docutils literal notranslate"><span class="pre">LookupError:</span> <span class="pre">No</span> <span class="pre">installed</span> <span class="pre">app</span>
<span class="pre">with</span> <span class="pre">label</span> <span class="pre">'myappname'</span></code> when you try to retrieve the model in the <code class="docutils literal notranslate"><span class="pre">RunPython</span></code>
function using <code class="docutils literal notranslate"><span class="pre">apps.get_model()</span></code>.</p>
<p>In the following example, we have a migration in <code class="docutils literal notranslate"><span class="pre">app1</span></code> which needs to use
models in <code class="docutils literal notranslate"><span class="pre">app2</span></code>. We aren’t concerned with the details of <code class="docutils literal notranslate"><span class="pre">move_m1</span></code> other
than the fact it will need to access models from both apps. Therefore we’ve
added a dependency that specifies the last migration of <code class="docutils literal notranslate"><span class="pre">app2</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Migration</span><span class="p">(</span><span class="n">migrations</span><span class="o">.</span><span class="n">Migration</span><span class="p">):</span>
    <span class="n">dependencies</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="s2">&quot;app1&quot;</span><span class="p">,</span> <span class="s2">&quot;0001_initial&quot;</span><span class="p">),</span>
        <span class="c1"># added dependency to enable using models from app2 in move_m1</span>
        <span class="p">(</span><span class="s2">&quot;app2&quot;</span><span class="p">,</span> <span class="s2">&quot;0004_foobar&quot;</span><span class="p">),</span>
    <span class="p">]</span>

    <span class="n">operations</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">migrations</span><span class="o">.</span><span class="n">RunPython</span><span class="p">(</span><span class="n">move_m1</span><span class="p">),</span>
    <span class="p">]</span>
</pre></div>
</div>
</section>
<section id="s-more-advanced-migrations">
<span id="more-advanced-migrations"></span><h3>More advanced migrations<a class="headerlink" href="#more-advanced-migrations" title="Link to this heading">¶</a></h3>
<p>If you’re interested in the more advanced migration operations, or want
to be able to write your own, see the <a class="reference internal" href="../ref/migration-operations.html"><span class="doc">migration operations reference</span></a> and the “how-to” on <a class="reference internal" href="../howto/writing-migrations.html"><span class="doc">writing migrations</span></a>.</p>
</section>
</section>
<section id="s-squashing-migrations">
<span id="s-migration-squashing"></span><span id="squashing-migrations"></span><span id="migration-squashing"></span><h2>Squashing migrations<a class="headerlink" href="#squashing-migrations" title="Link to this heading">¶</a></h2>
<p>You are encouraged to make migrations freely and not worry about how many you
have; the migration code is optimized to deal with hundreds at a time without
much slowdown. However, eventually you will want to move back from having
several hundred migrations to just a few, and that’s where squashing comes in.</p>
<p>Squashing is the act of reducing an existing set of many migrations down to
one (or sometimes a few) migrations which still represent the same changes.</p>
<p>GingerDJ does this by taking all of your existing migrations, extracting their
<code class="docutils literal notranslate"><span class="pre">Operation</span></code>s and putting them all in sequence, and then running an optimizer
over them to try and reduce the length of the list - for example, it knows
that <a class="reference internal" href="../ref/migration-operations.html#gingerdj.db.migrations.operations.CreateModel" title="gingerdj.db.migrations.operations.CreateModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">CreateModel</span></code></a> and
<a class="reference internal" href="../ref/migration-operations.html#gingerdj.db.migrations.operations.DeleteModel" title="gingerdj.db.migrations.operations.DeleteModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">DeleteModel</span></code></a> cancel each other out,
and it knows that <a class="reference internal" href="../ref/migration-operations.html#gingerdj.db.migrations.operations.AddField" title="gingerdj.db.migrations.operations.AddField"><code class="xref py py-class docutils literal notranslate"><span class="pre">AddField</span></code></a> can be
rolled into <a class="reference internal" href="../ref/migration-operations.html#gingerdj.db.migrations.operations.CreateModel" title="gingerdj.db.migrations.operations.CreateModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">CreateModel</span></code></a>.</p>
<p>Once the operation sequence has been reduced as much as possible - the amount
possible depends on how closely intertwined your models are and if you have
any <a class="reference internal" href="../ref/migration-operations.html#gingerdj.db.migrations.operations.RunSQL" title="gingerdj.db.migrations.operations.RunSQL"><code class="xref py py-class docutils literal notranslate"><span class="pre">RunSQL</span></code></a>
or <a class="reference internal" href="../ref/migration-operations.html#gingerdj.db.migrations.operations.RunPython" title="gingerdj.db.migrations.operations.RunPython"><code class="xref py py-class docutils literal notranslate"><span class="pre">RunPython</span></code></a> operations (which can’t
be optimized through unless they are marked as <code class="docutils literal notranslate"><span class="pre">elidable</span></code>) - GingerDJ will then
write it back out into a new set of migration files.</p>
<p>These files are marked to say they replace the previously-squashed migrations,
so they can coexist with the old migration files, and GingerDJ will intelligently
switch between them depending where you are in the history. If you’re still
part-way through the set of migrations that you squashed, it will keep using
them until it hits the end and then switch to the squashed history, while new
installs will use the new squashed migration and skip all the old ones.</p>
<p>This enables you to squash and not mess up systems currently in production
that aren’t fully up-to-date yet. The recommended process is to squash, keeping
the old files, commit and release, wait until all systems are upgraded with
the new release (or if you’re a third-party project, ensure your users upgrade
releases in order without skipping any), and then remove the old files, commit
and do a second release.</p>
<p>The command that backs all this is <a class="reference internal" href="../ref/gingerdj-admin.html#gingerdj-admin-squashmigrations"><code class="xref std std-djadmin docutils literal notranslate"><span class="pre">squashmigrations</span></code></a> - pass it the
app label and migration name you want to squash up to, and it’ll get to work:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>./manage.py<span class="w"> </span>squashmigrations<span class="w"> </span>myapp<span class="w"> </span><span class="m">0004</span>
Will<span class="w"> </span>squash<span class="w"> </span>the<span class="w"> </span>following<span class="w"> </span>migrations:
<span class="w"> </span>-<span class="w"> </span>0001_initial
<span class="w"> </span>-<span class="w"> </span>0002_some_change
<span class="w"> </span>-<span class="w"> </span>0003_another_change
<span class="w"> </span>-<span class="w"> </span>0004_undo_something
Do<span class="w"> </span>you<span class="w"> </span>wish<span class="w"> </span>to<span class="w"> </span>proceed?<span class="w"> </span><span class="o">[</span>y/N<span class="o">]</span><span class="w"> </span>y
Optimizing...
<span class="w">  </span>Optimized<span class="w"> </span>from<span class="w"> </span><span class="m">12</span><span class="w"> </span>operations<span class="w"> </span>to<span class="w"> </span><span class="m">7</span><span class="w"> </span>operations.
Created<span class="w"> </span>new<span class="w"> </span>squashed<span class="w"> </span>migration<span class="w"> </span>/home/andrew/Programs/GingerTest/test/migrations/0001_squashed_0004_undo_something.py
<span class="w">  </span>You<span class="w"> </span>should<span class="w"> </span>commit<span class="w"> </span>this<span class="w"> </span>migration<span class="w"> </span>but<span class="w"> </span>leave<span class="w"> </span>the<span class="w"> </span>old<span class="w"> </span>ones<span class="w"> </span><span class="k">in</span><span class="w"> </span>place<span class="p">;</span>
<span class="w">  </span>the<span class="w"> </span>new<span class="w"> </span>migration<span class="w"> </span>will<span class="w"> </span>be<span class="w"> </span>used<span class="w"> </span><span class="k">for</span><span class="w"> </span>new<span class="w"> </span>installs.<span class="w"> </span>Once<span class="w"> </span>you<span class="w"> </span>are<span class="w"> </span>sure
<span class="w">  </span>all<span class="w"> </span>instances<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>codebase<span class="w"> </span>have<span class="w"> </span>applied<span class="w"> </span>the<span class="w"> </span>migrations<span class="w"> </span>you<span class="w"> </span>squashed,
<span class="w">  </span>you<span class="w"> </span>can<span class="w"> </span>delete<span class="w"> </span>them.
</pre></div>
</div>
<p>Use the <a class="reference internal" href="../ref/gingerdj-admin.html#cmdoption-squashmigrations-squashed-name"><code class="xref std std-option docutils literal notranslate"><span class="pre">squashmigrations</span> <span class="pre">--squashed-name</span></code></a> option if you want to set
the name of the squashed migration rather than use an autogenerated one.</p>
<p>Note that model interdependencies in GingerDJ can get very complex, and squashing
may result in migrations that do not run; either mis-optimized (in which case
you can try again with <code class="docutils literal notranslate"><span class="pre">--no-optimize</span></code>, though you should also report an issue),
or with a <code class="docutils literal notranslate"><span class="pre">CircularDependencyError</span></code>, in which case you can manually resolve it.</p>
<p>To manually resolve a <code class="docutils literal notranslate"><span class="pre">CircularDependencyError</span></code>, break out one of
the ForeignKeys in the circular dependency loop into a separate
migration, and move the dependency on the other app with it. If you’re unsure,
see how <a class="reference internal" href="../ref/gingerdj-admin.html#gingerdj-admin-makemigrations"><code class="xref std std-djadmin docutils literal notranslate"><span class="pre">makemigrations</span></code></a> deals with the problem when asked to create
brand new migrations from your models. In a future release of GingerDJ,
<a class="reference internal" href="../ref/gingerdj-admin.html#gingerdj-admin-squashmigrations"><code class="xref std std-djadmin docutils literal notranslate"><span class="pre">squashmigrations</span></code></a> will be updated to attempt to resolve these errors
itself.</p>
<p>Once you’ve squashed your migration, you should then commit it alongside the
migrations it replaces and distribute this change to all running instances
of your application, making sure that they run <code class="docutils literal notranslate"><span class="pre">migrate</span></code> to store the change
in their database.</p>
<p>You must then transition the squashed migration to a normal migration by:</p>
<ul class="simple">
<li><p>Deleting all the migration files it replaces.</p></li>
<li><p>Updating all migrations that depend on the deleted migrations to depend on
the squashed migration instead.</p></li>
<li><p>Removing the <code class="docutils literal notranslate"><span class="pre">replaces</span></code> attribute in the <code class="docutils literal notranslate"><span class="pre">Migration</span></code> class of the
squashed migration (this is how GingerDJ tells that it is a squashed migration).</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Once you’ve squashed a migration, you should not then re-squash that squashed
migration until you have fully transitioned it to a normal migration.</p>
</div>
<div class="admonition-pruning-references-to-deleted-migrations admonition">
<p class="admonition-title">Pruning references to deleted migrations</p>
<p>If it is likely that you may reuse the name of a deleted migration in the
future, you should remove references to it from GingerDJ’s migrations table
with the <a class="reference internal" href="../ref/gingerdj-admin.html#cmdoption-migrate-prune"><code class="xref std std-option docutils literal notranslate"><span class="pre">migrate</span> <span class="pre">--prune</span></code></a> option.</p>
</div>
</section>
<section id="s-serializing-values">
<span id="s-migration-serializing"></span><span id="serializing-values"></span><span id="migration-serializing"></span><h2>Serializing values<a class="headerlink" href="#serializing-values" title="Link to this heading">¶</a></h2>
<p>Migrations are Python files containing the old definitions of your models
- thus, to write them, GingerDJ must take the current state of your models and
serialize them out into a file.</p>
<p>While GingerDJ can serialize most things, there are some things that we just
can’t serialize out into a valid Python representation - there’s no Python
standard for how a value can be turned back into code (<code class="docutils literal notranslate"><span class="pre">repr()</span></code> only works
for basic values, and doesn’t specify import paths).</p>
<p>GingerDJ can serialize the following:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, <code class="docutils literal notranslate"><span class="pre">bool</span></code>, <code class="docutils literal notranslate"><span class="pre">str</span></code>, <code class="docutils literal notranslate"><span class="pre">bytes</span></code>, <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">NoneType</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">list</span></code>, <code class="docutils literal notranslate"><span class="pre">set</span></code>, <code class="docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="docutils literal notranslate"><span class="pre">dict</span></code>, <code class="docutils literal notranslate"><span class="pre">range</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">datetime.date</span></code>, <code class="docutils literal notranslate"><span class="pre">datetime.time</span></code>, and <code class="docutils literal notranslate"><span class="pre">datetime.datetime</span></code> instances
(include those that are timezone-aware)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">decimal.Decimal</span></code> instances</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">enum.Enum</span></code>  and <code class="docutils literal notranslate"><span class="pre">enum.Flag</span></code> instances</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">uuid.UUID</span></code> instances</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/functools.html#functools.partial" title="(in Python v3.13)"><code class="xref py py-func docutils literal notranslate"><span class="pre">functools.partial()</span></code></a> and <a class="reference external" href="https://docs.python.org/3/library/functools.html#functools.partialmethod" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">functools.partialmethod</span></code></a> instances
which have serializable <code class="docutils literal notranslate"><span class="pre">func</span></code>, <code class="docutils literal notranslate"><span class="pre">args</span></code>, and <code class="docutils literal notranslate"><span class="pre">keywords</span></code> values.</p></li>
<li><p>Pure and concrete path objects from <a class="reference external" href="https://docs.python.org/3/library/pathlib.html#module-pathlib" title="(in Python v3.13)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pathlib</span></code></a>. Concrete paths are
converted to their pure path equivalent, e.g. <a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pathlib.PosixPath</span></code></a> to
<a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.PurePosixPath" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pathlib.PurePosixPath</span></code></a>.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/os.html#os.PathLike" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">os.PathLike</span></code></a> instances, e.g. <a class="reference external" href="https://docs.python.org/3/library/os.html#os.DirEntry" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">os.DirEntry</span></code></a>, which are
converted to <code class="docutils literal notranslate"><span class="pre">str</span></code> or <code class="docutils literal notranslate"><span class="pre">bytes</span></code> using <a class="reference external" href="https://docs.python.org/3/library/os.html#os.fspath" title="(in Python v3.13)"><code class="xref py py-func docutils literal notranslate"><span class="pre">os.fspath()</span></code></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">LazyObject</span></code> instances which wrap a serializable value.</p></li>
<li><p>Enumeration types (e.g. <code class="docutils literal notranslate"><span class="pre">TextChoices</span></code> or <code class="docutils literal notranslate"><span class="pre">IntegerChoices</span></code>) instances.</p></li>
<li><p>Any GingerDJ field</p></li>
<li><p>Any function or method reference (e.g. <code class="docutils literal notranslate"><span class="pre">datetime.datetime.today</span></code>) (must be
in module’s top-level scope)</p>
<ul>
<li><p>Functions may be decorated if wrapped properly, i.e. using
<a class="reference external" href="https://docs.python.org/3/library/functools.html#functools.wraps" title="(in Python v3.13)"><code class="xref py py-func docutils literal notranslate"><span class="pre">functools.wraps()</span></code></a></p></li>
<li><p>The <a class="reference external" href="https://docs.python.org/3/library/functools.html#functools.cache" title="(in Python v3.13)"><code class="xref py py-func docutils literal notranslate"><span class="pre">functools.cache()</span></code></a> and <a class="reference external" href="https://docs.python.org/3/library/functools.html#functools.lru_cache" title="(in Python v3.13)"><code class="xref py py-func docutils literal notranslate"><span class="pre">functools.lru_cache()</span></code></a> decorators are
explicitly supported</p></li>
</ul>
</li>
<li><p>Unbound methods used from within the class body</p></li>
<li><p>Any class reference (must be in module’s top-level scope)</p></li>
<li><p>Anything with a custom <code class="docutils literal notranslate"><span class="pre">deconstruct()</span></code> method (<a class="reference internal" href="#custom-deconstruct-method"><span class="std std-ref">see below</span></a>)</p></li>
</ul>
<div class="versionchanged">
<span class="title">Changed in GingerDJ 5.0:</span> <p>Serialization support for functions decorated with <a class="reference external" href="https://docs.python.org/3/library/functools.html#functools.cache" title="(in Python v3.13)"><code class="xref py py-func docutils literal notranslate"><span class="pre">functools.cache()</span></code></a>
or <a class="reference external" href="https://docs.python.org/3/library/functools.html#functools.lru_cache" title="(in Python v3.13)"><code class="xref py py-func docutils literal notranslate"><span class="pre">functools.lru_cache()</span></code></a> was added.</p>
</div>
<p>GingerDJ cannot serialize:</p>
<ul class="simple">
<li><p>Nested classes</p></li>
<li><p>Arbitrary class instances (e.g. <code class="docutils literal notranslate"><span class="pre">MyClass(4.3,</span> <span class="pre">5.7)</span></code>)</p></li>
<li><p>Lambdas</p></li>
</ul>
<section id="s-custom-serializers">
<span id="s-custom-migration-serializers"></span><span id="custom-serializers"></span><span id="custom-migration-serializers"></span><h3>Custom serializers<a class="headerlink" href="#custom-serializers" title="Link to this heading">¶</a></h3>
<p>You can serialize other types by writing a custom serializer. For example, if
GingerDJ didn’t serialize <a class="reference external" href="https://docs.python.org/3/library/decimal.html#decimal.Decimal" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Decimal</span></code></a> by default, you could do
this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span>

<span class="kn">from</span> <span class="nn">gingerdj.db.migrations.serializer</span> <span class="kn">import</span> <span class="n">BaseSerializer</span>
<span class="kn">from</span> <span class="nn">gingerdj.db.migrations.writer</span> <span class="kn">import</span> <span class="n">MigrationWriter</span>


<span class="k">class</span> <span class="nc">DecimalSerializer</span><span class="p">(</span><span class="n">BaseSerializer</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">),</span> <span class="p">{</span><span class="s2">&quot;from decimal import Decimal&quot;</span><span class="p">}</span>


<span class="n">MigrationWriter</span><span class="o">.</span><span class="n">register_serializer</span><span class="p">(</span><span class="n">Decimal</span><span class="p">,</span> <span class="n">DecimalSerializer</span><span class="p">)</span>
</pre></div>
</div>
<p>The first argument of <code class="docutils literal notranslate"><span class="pre">MigrationWriter.register_serializer()</span></code> is a type or
iterable of types that should use the serializer.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">serialize()</span></code> method of your serializer must return a string of how the
value should appear in migrations and a set of any imports that are needed in
the migration.</p>
</section>
<section id="s-adding-a-deconstruct-method">
<span id="s-custom-deconstruct-method"></span><span id="adding-a-deconstruct-method"></span><span id="custom-deconstruct-method"></span><h3>Adding a <code class="docutils literal notranslate"><span class="pre">deconstruct()</span></code> method<a class="headerlink" href="#adding-a-deconstruct-method" title="Link to this heading">¶</a></h3>
<p>You can let GingerDJ serialize your own custom class instances by giving the class
a <code class="docutils literal notranslate"><span class="pre">deconstruct()</span></code> method. It takes no arguments, and should return a tuple
of three things <code class="docutils literal notranslate"><span class="pre">(path,</span> <span class="pre">args,</span> <span class="pre">kwargs)</span></code>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">path</span></code> should be the Python path to the class, with the class name included
as the last part (for example, <code class="docutils literal notranslate"><span class="pre">myapp.custom_things.MyClass</span></code>). If your
class is not available at the top level of a module it is not serializable.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">args</span></code> should be a list of positional arguments to pass to your class’
<code class="docutils literal notranslate"><span class="pre">__init__</span></code> method. Everything in this list should itself be serializable.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">kwargs</span></code> should be a dict of keyword arguments to pass to your class’
<code class="docutils literal notranslate"><span class="pre">__init__</span></code> method. Every value should itself be serializable.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This return value is different from the <code class="docutils literal notranslate"><span class="pre">deconstruct()</span></code> method
<a class="reference internal" href="../howto/custom-model-fields.html#custom-field-deconstruct-method"><span class="std std-ref">for custom fields</span></a> which returns a
tuple of four items.</p>
</div>
<p>GingerDJ will write out the value as an instantiation of your class with the
given arguments, similar to the way it writes out references to GingerDJ fields.</p>
<p>To prevent a new migration from being created each time
<a class="reference internal" href="../ref/gingerdj-admin.html#gingerdj-admin-makemigrations"><code class="xref std std-djadmin docutils literal notranslate"><span class="pre">makemigrations</span></code></a> is run, you should also add a <code class="docutils literal notranslate"><span class="pre">__eq__()</span></code> method to
the decorated class. This function will be called by GingerDJ’s migration
framework to detect changes between states.</p>
<p>As long as all of the arguments to your class’ constructor are themselves
serializable, you can use the <code class="docutils literal notranslate"><span class="pre">&#64;deconstructible</span></code> class decorator from
<code class="docutils literal notranslate"><span class="pre">gingerdj.utils.deconstruct</span></code> to add the <code class="docutils literal notranslate"><span class="pre">deconstruct()</span></code> method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gingerdj.utils.deconstruct</span> <span class="kn">import</span> <span class="n">deconstructible</span>


<span class="nd">@deconstructible</span>
<span class="k">class</span> <span class="nc">MyCustomClass</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">foo</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">foo</span> <span class="o">=</span> <span class="n">foo</span>
        <span class="o">...</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">foo</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">foo</span>
</pre></div>
</div>
<p>The decorator adds logic to capture and preserve the arguments on their
way into your constructor, and then returns those arguments exactly when
deconstruct() is called.</p>
</section>
</section>
<section id="s-supporting-multiple-gingerdj-versions">
<span id="supporting-multiple-gingerdj-versions"></span><h2>Supporting multiple GingerDJ versions<a class="headerlink" href="#supporting-multiple-gingerdj-versions" title="Link to this heading">¶</a></h2>
<p>If you are the maintainer of a third-party app with models, you may need to
ship migrations that support multiple GingerDJ versions. In this case, you should
always run <a class="reference internal" href="../ref/gingerdj-admin.html#gingerdj-admin-makemigrations"><code class="xref std std-djadmin docutils literal notranslate"><span class="pre">makemigrations</span></code></a> <strong>with the lowest GingerDJ version you wish
to support</strong>.</p>
<p>The migrations system will maintain backwards-compatibility according to the
same policy as the rest of GingerDJ, so migration files generated on GingerDJ X.Y
should run unchanged on GingerDJ X.Y+1. The migrations system does not promise
forwards-compatibility, however. New features may be added, and migration files
generated with newer versions of GingerDJ may not work on older versions.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="../ref/migration-operations.html"><span class="doc">The Migrations Operations Reference</span></a></dt><dd><p>Covers the schema operations API, special operations, and writing your
own operations.</p>
</dd>
<dt><a class="reference internal" href="../howto/writing-migrations.html"><span class="doc">The Writing Migrations “how-to”</span></a></dt><dd><p>Explains how to structure and write database migrations for different
scenarios you might encounter.</p>
</dd>
</dl>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="files.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Managing files</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="class-based-views/mixins.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Using mixins with class-based views</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; Ginger Society and contributors
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            <div class="last-updated">
              Last updated on Nov 21, 2024</div>
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Migrations</a><ul>
<li><a class="reference internal" href="#the-commands">The Commands</a></li>
<li><a class="reference internal" href="#backend-support">Backend Support</a><ul>
<li><a class="reference internal" href="#postgresql">PostgreSQL</a></li>
<li><a class="reference internal" href="#mysql">MySQL</a></li>
<li><a class="reference internal" href="#sqlite">SQLite</a></li>
</ul>
</li>
<li><a class="reference internal" href="#workflow">Workflow</a><ul>
<li><a class="reference internal" href="#version-control">Version control</a></li>
</ul>
</li>
<li><a class="reference internal" href="#transactions">Transactions</a></li>
<li><a class="reference internal" href="#dependencies">Dependencies</a><ul>
<li><a class="reference internal" href="#swappable-dependencies">Swappable dependencies</a></li>
</ul>
</li>
<li><a class="reference internal" href="#migration-files">Migration files</a><ul>
<li><a class="reference internal" href="#custom-fields">Custom fields</a></li>
<li><a class="reference internal" href="#model-managers">Model managers</a></li>
<li><a class="reference internal" href="#initial-migrations">Initial migrations</a></li>
<li><a class="reference internal" href="#history-consistency">History consistency</a></li>
</ul>
</li>
<li><a class="reference internal" href="#adding-migrations-to-apps">Adding migrations to apps</a></li>
<li><a class="reference internal" href="#reversing-migrations">Reversing migrations</a></li>
<li><a class="reference internal" href="#historical-models">Historical models</a></li>
<li><a class="reference internal" href="#considerations-when-removing-model-fields">Considerations when removing model fields</a></li>
<li><a class="reference internal" href="#data-migrations">Data Migrations</a><ul>
<li><a class="reference internal" href="#accessing-models-from-other-apps">Accessing models from other apps</a></li>
<li><a class="reference internal" href="#more-advanced-migrations">More advanced migrations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#squashing-migrations">Squashing migrations</a></li>
<li><a class="reference internal" href="#serializing-values">Serializing values</a><ul>
<li><a class="reference internal" href="#custom-serializers">Custom serializers</a></li>
<li><a class="reference internal" href="#adding-a-deconstruct-method">Adding a <code class="docutils literal notranslate"><span class="pre">deconstruct()</span></code> method</a></li>
</ul>
</li>
<li><a class="reference internal" href="#supporting-multiple-gingerdj-versions">Supporting multiple GingerDJ versions</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=c5a15dbd"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    </body>
</html>