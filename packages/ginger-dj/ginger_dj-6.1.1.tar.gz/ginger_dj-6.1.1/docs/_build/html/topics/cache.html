<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Conditional View Processing" href="conditional-view-processing.html" /><link rel="prev" title="Advanced testing topics" href="testing/advanced.html" />
        <link rel="canonical" href="https://www.gingersociety.org/products/ginger-dj/docs/topics/cache.html" />

    <!-- Generated with Sphinx 8.1.3 and Furo 2024.08.06 -->
        <title>GingerDJ’s cache framework - GingerDJ 6.1.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=d10597a4" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #ffffff;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../contents.html"><div class="brand">GingerDJ 6.1.1 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../contents.html">
  
  
  <span class="sidebar-brand-text">GingerDJ 6.1.1 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">GingerDJ documentation</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../intro/index.html">Getting started</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Getting started</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../intro/overview.html">GingerDJ at a glance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/install.html">Quick install guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/tutorial01.html">Writing your first GingerDJ app, part 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/tutorial02.html">Writing your first GingerDJ app, part 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/tutorial03.html">Writing your first GingerDJ app, part 3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/tutorial04.html">Writing your first GingerDJ app, part 4</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/tutorial05.html">Writing your first GingerDJ app, part 5</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/tutorial06.html">Writing your first GingerDJ app, part 6</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/tutorial07.html">Writing your first GingerDJ app, part 7</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/tutorial08.html">Writing your first GingerDJ app, part 8</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/reusable-apps.html">Advanced tutorial: How to write reusable apps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/whatsnext.html">What to read next</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Using GingerDJ</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Using GingerDJ</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="install.html">How to install GingerDJ</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="db/index.html">Models and databases</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Models and databases</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="db/models.html">Models</a></li>
<li class="toctree-l3"><a class="reference internal" href="db/queries.html">Making queries</a></li>
<li class="toctree-l3"><a class="reference internal" href="db/aggregation.html">Aggregation</a></li>
<li class="toctree-l3"><a class="reference internal" href="db/search.html">Search</a></li>
<li class="toctree-l3"><a class="reference internal" href="db/managers.html">Managers</a></li>
<li class="toctree-l3"><a class="reference internal" href="db/sql.html">Performing raw SQL queries</a></li>
<li class="toctree-l3"><a class="reference internal" href="db/transactions.html">Database transactions</a></li>
<li class="toctree-l3"><a class="reference internal" href="db/multi-db.html">Multiple databases</a></li>
<li class="toctree-l3"><a class="reference internal" href="db/tablespaces.html">Tablespaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="db/optimization.html">Database access optimization</a></li>
<li class="toctree-l3"><a class="reference internal" href="db/instrumentation.html">Database instrumentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="db/fixtures.html">Fixtures</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="db/examples/index.html">Examples of model relationship API usage</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Examples of model relationship API usage</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="db/examples/many_to_many.html">Many-to-many relationships</a></li>
<li class="toctree-l4"><a class="reference internal" href="db/examples/many_to_one.html">Many-to-one relationships</a></li>
<li class="toctree-l4"><a class="reference internal" href="db/examples/one_to_one.html">One-to-one relationships</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="http/index.html">Handling HTTP requests</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Handling HTTP requests</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="http/urls.html">URL dispatcher</a></li>
<li class="toctree-l3"><a class="reference internal" href="http/views.html">Writing views</a></li>
<li class="toctree-l3"><a class="reference internal" href="http/decorators.html">View decorators</a></li>
<li class="toctree-l3"><a class="reference internal" href="http/file-uploads.html">File Uploads</a></li>
<li class="toctree-l3"><a class="reference internal" href="http/shortcuts.html">GingerDJ shortcut functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="http/generic-views.html">Generic views</a></li>
<li class="toctree-l3"><a class="reference internal" href="http/middleware.html">Middleware</a></li>
<li class="toctree-l3"><a class="reference internal" href="http/sessions.html">How to use sessions</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="forms/index.html">Working with forms</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Working with forms</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="forms/formsets.html">Formsets</a></li>
<li class="toctree-l3"><a class="reference internal" href="forms/modelforms.html">Creating forms from models</a></li>
<li class="toctree-l3"><a class="reference internal" href="forms/media.html">Form Assets (the <code class="docutils literal notranslate"><span class="pre">Media</span></code> class)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="templates.html">Templates</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="class-based-views/index.html">Class-based views</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of Class-based views</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="class-based-views/intro.html">Introduction to class-based views</a></li>
<li class="toctree-l3"><a class="reference internal" href="class-based-views/generic-display.html">Built-in class-based generic views</a></li>
<li class="toctree-l3"><a class="reference internal" href="class-based-views/generic-editing.html">Form handling with class-based views</a></li>
<li class="toctree-l3"><a class="reference internal" href="class-based-views/mixins.html">Using mixins with class-based views</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="migrations.html">Migrations</a></li>
<li class="toctree-l2"><a class="reference internal" href="files.html">Managing files</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="testing/index.html">Testing in GingerDJ</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of Testing in GingerDJ</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="testing/overview.html">Writing and running tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="testing/tools.html">Testing tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="testing/advanced.html">Advanced testing topics</a></li>
</ul>
</li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">GingerDJ’s cache framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="conditional-view-processing.html">Conditional View Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="signing.html">Cryptographic signing</a></li>
<li class="toctree-l2"><a class="reference internal" href="email.html">Sending email</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="i18n/index.html">Internationalization and localization</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of Internationalization and localization</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="i18n/translation.html">Translation</a></li>
<li class="toctree-l3"><a class="reference internal" href="i18n/formatting.html">Format localization</a></li>
<li class="toctree-l3"><a class="reference internal" href="i18n/timezones.html">Time zones</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="logging.html">Logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="pagination.html">Pagination</a></li>
<li class="toctree-l2"><a class="reference internal" href="security.html">Security in GingerDJ</a></li>
<li class="toctree-l2"><a class="reference internal" href="performance.html">Performance and optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="serialization.html">Serializing GingerDJ objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="settings.html">GingerDJ settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="signals.html">Signals</a></li>
<li class="toctree-l2"><a class="reference internal" href="checks.html">System check framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="external-packages.html">External packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="async.html">Asynchronous support</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../howto/index.html">“How-to” guides</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of “How-to” guides</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../howto/csrf.html">How to use GingerDJ’s CSRF protection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../howto/custom-management-commands.html">How to create custom <code class="docutils literal notranslate"><span class="pre">gingerdj-admin</span></code> commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../howto/custom-model-fields.html">How to create custom model fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../howto/custom-lookups.html">How to write custom lookups</a></li>
<li class="toctree-l2"><a class="reference internal" href="../howto/custom-template-backend.html">How to implement a custom template backend</a></li>
<li class="toctree-l2"><a class="reference internal" href="../howto/custom-template-tags.html">How to create custom template tags and filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../howto/custom-file-storage.html">How to write a custom storage class</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../howto/deployment/index.html">How to deploy GingerDJ</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of How to deploy GingerDJ</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../howto/deployment/wsgi/index.html">How to deploy with WSGI</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of How to deploy with WSGI</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../howto/deployment/wsgi/gunicorn.html">How to use GingerDJ with Gunicorn</a></li>
<li class="toctree-l4"><a class="reference internal" href="../howto/deployment/wsgi/uwsgi.html">How to use GingerDJ with uWSGI</a></li>
<li class="toctree-l4"><a class="reference internal" href="../howto/deployment/wsgi/modwsgi.html">How to use GingerDJ with Apache and <code class="docutils literal notranslate"><span class="pre">mod_wsgi</span></code></a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../howto/deployment/asgi/index.html">How to deploy with ASGI</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle navigation of How to deploy with ASGI</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../howto/deployment/asgi/daphne.html">How to use GingerDJ with Daphne</a></li>
<li class="toctree-l4"><a class="reference internal" href="../howto/deployment/asgi/hypercorn.html">How to use GingerDJ with Hypercorn</a></li>
<li class="toctree-l4"><a class="reference internal" href="../howto/deployment/asgi/uvicorn.html">How to use GingerDJ with Uvicorn</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../howto/deployment/checklist.html">Deployment checklist</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../howto/upgrade-version.html">How to upgrade GingerDJ to a newer version</a></li>
<li class="toctree-l2"><a class="reference internal" href="../howto/error-reporting.html">How to manage error reporting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../howto/initial-data.html">How to provide initial data for models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../howto/legacy-databases.html">How to integrate GingerDJ with a legacy database</a></li>
<li class="toctree-l2"><a class="reference internal" href="../howto/logging.html">How to configure and use logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../howto/outputting-csv.html">How to create CSV output</a></li>
<li class="toctree-l2"><a class="reference internal" href="../howto/outputting-pdf.html">How to create PDF files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../howto/overriding-templates.html">How to override templates</a></li>
<li class="toctree-l2"><a class="reference internal" href="../howto/static-files/index.html">How to manage static files (e.g. images, JavaScript, CSS)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../howto/static-files/deployment.html">How to deploy static files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../howto/windows.html">How to install GingerDJ on Windows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../howto/writing-migrations.html">How to create database migrations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../howto/delete-app.html">How to delete a GingerDJ application</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../faq/index.html">GingerDJ FAQ</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle navigation of GingerDJ FAQ</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../faq/general.html">FAQ: General</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/install.html">FAQ: Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/usage.html">FAQ: Using GingerDJ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/models.html">FAQ: Databases and models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/admin.html">FAQ: The admin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/troubleshooting.html">Troubleshooting</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../ref/index.html">API Reference</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle navigation of API Reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../ref/applications.html">Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ref/checks.html">System check framework</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../ref/class-based-views/index.html">Built-in class-based views API</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle navigation of Built-in class-based views API</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../ref/class-based-views/base.html">Base views</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/class-based-views/generic-display.html">Generic display views</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/class-based-views/generic-editing.html">Generic editing views</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/class-based-views/generic-date-based.html">Generic date views</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../ref/class-based-views/mixins.html">Class-based views mixins</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle navigation of Class-based views mixins</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../ref/class-based-views/mixins-simple.html">Simple mixins</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/class-based-views/mixins-single-object.html">Single object mixins</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/class-based-views/mixins-multiple-object.html">Multiple object mixins</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/class-based-views/mixins-editing.html">Editing mixins</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/class-based-views/mixins-date-based.html">Date-based mixins</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../ref/class-based-views/flattened-index.html">Class-based generic views - flattened index</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../ref/clickjacking.html">Clickjacking Protection</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../ref/contrib/index.html"><code class="docutils literal notranslate"><span class="pre">contrib</span></code> packages</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><div class="visually-hidden">Toggle navigation of contrib packages</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../ref/contrib/admin/index.html">The GingerDJ admin site</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><div class="visually-hidden">Toggle navigation of The GingerDJ admin site</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/admin/actions.html">Admin actions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/admin/filters.html"><code class="docutils literal notranslate"><span class="pre">ModelAdmin</span></code> List Filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/admin/admindocs.html">The GingerDJ admin documentation generator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/admin/javascript.html">JavaScript customizations in the admin</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../ref/contrib/flatpages.html">The flatpages app</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../ref/contrib/gis/index.html">GeoGinger</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><div class="visually-hidden">Toggle navigation of GeoGinger</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/gis/tutorial.html">GeoGinger Tutorial</a></li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../ref/contrib/gis/install/index.html">GeoGinger Installation</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" role="switch" type="checkbox"/><label for="toctree-checkbox-21"><div class="visually-hidden">Toggle navigation of GeoGinger Installation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../ref/contrib/gis/install/geolibs.html">Installing Geospatial libraries</a></li>
<li class="toctree-l5"><a class="reference internal" href="../ref/contrib/gis/install/postgis.html">Installing PostGIS</a></li>
<li class="toctree-l5"><a class="reference internal" href="../ref/contrib/gis/install/spatialite.html">Installing SpatiaLite</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/gis/model-api.html">GeoGinger Model API</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/gis/db-api.html">GeoGinger Database API</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/gis/forms-api.html">GeoGinger Forms API</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/gis/geoquerysets.html">GIS QuerySet API Reference</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/gis/functions.html">Geographic Database Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/gis/measure.html">Measurement Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/gis/geos.html">GEOS API</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/gis/gdal.html">GDAL API</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/gis/geoip2.html">Geolocation with GeoIP2</a></li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../ref/contrib/gis/utils.html">GeoGinger Utilities</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" role="switch" type="checkbox"/><label for="toctree-checkbox-22"><div class="visually-hidden">Toggle navigation of GeoGinger Utilities</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../ref/contrib/gis/layermapping.html"><code class="docutils literal notranslate"><span class="pre">LayerMapping</span></code> data import utility</a></li>
<li class="toctree-l5"><a class="reference internal" href="../ref/contrib/gis/ogrinspect.html">OGR Inspection</a></li>
<li class="toctree-l5"><a class="reference internal" href="../ref/contrib/gis/serializers.html"><code class="docutils literal notranslate"><span class="pre">GeoJSON</span></code> Serializer</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/gis/commands.html">GeoGinger Management Commands</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/gis/admin.html">GeoGinger’s admin site</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/gis/feeds.html">Geographic Feeds</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/gis/sitemaps.html">Geographic Sitemaps</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/gis/testing.html">Testing GeoGinger apps</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/gis/deployment.html">Deploying GeoGinger</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../ref/contrib/humanize.html"><code class="docutils literal notranslate"><span class="pre">gingerdj.contrib.humanize</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/contrib/messages.html">The messages framework</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../ref/contrib/postgres/index.html"><code class="docutils literal notranslate"><span class="pre">gingerdj.contrib.postgres</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" role="switch" type="checkbox"/><label for="toctree-checkbox-23"><div class="visually-hidden">Toggle navigation of gingerdj.contrib.postgres</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/postgres/aggregates.html">PostgreSQL specific aggregation functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/postgres/constraints.html">PostgreSQL specific database constraints</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/postgres/expressions.html">PostgreSQL specific query expressions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/postgres/fields.html">PostgreSQL specific model fields</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/postgres/forms.html">PostgreSQL specific form fields and widgets</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/postgres/functions.html">PostgreSQL specific database functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/postgres/indexes.html">PostgreSQL specific model indexes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/postgres/lookups.html">PostgreSQL specific lookups</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/postgres/operations.html">Database migration operations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/postgres/search.html">Full text search</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ref/contrib/postgres/validators.html">Validators</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../ref/contrib/redirects.html">The redirects app</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/contrib/sitemaps.html">The sitemap framework</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/contrib/sites.html">The “sites” framework</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/contrib/staticfiles.html">The <code class="docutils literal notranslate"><span class="pre">staticfiles</span></code> app</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/contrib/syndication.html">The syndication feed framework</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../ref/csrf.html">Cross Site Request Forgery protection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ref/databases.html">Databases</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ref/gingerdj-admin.html"><code class="docutils literal notranslate"><span class="pre">gingerdj-admin</span></code> and <code class="docutils literal notranslate"><span class="pre">manage.py</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../ref/gingerdj-admin.html#running-management-commands-from-your-code">Running management commands from your code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ref/exceptions.html">GingerDJ Exceptions</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../ref/files/index.html">File handling</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" role="switch" type="checkbox"/><label for="toctree-checkbox-24"><div class="visually-hidden">Toggle navigation of File handling</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../ref/files/file.html">The <code class="docutils literal notranslate"><span class="pre">File</span></code> object</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/files/storage.html">File storage API</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/files/uploads.html">Uploaded Files and Upload Handlers</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../ref/forms/index.html">Forms</a><input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" role="switch" type="checkbox"/><label for="toctree-checkbox-25"><div class="visually-hidden">Toggle navigation of Forms</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../ref/forms/api.html">The Forms API</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/forms/fields.html">Form fields</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/forms/models.html">Model Form Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/forms/formsets.html">Formset Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/forms/renderers.html">The form rendering API</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/forms/widgets.html">Widgets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/forms/validation.html">Form and field validation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../ref/logging.html">Logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ref/middleware.html">Middleware</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ref/migration-operations.html">Migration Operations</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../ref/models/index.html">Models</a><input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" role="switch" type="checkbox"/><label for="toctree-checkbox-26"><div class="visually-hidden">Toggle navigation of Models</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../ref/models/fields.html">Model field reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/models/fields.html#field-attribute-reference">Field attribute reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/models/indexes.html">Model index reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/models/constraints.html">Constraints reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/models/meta.html">Model <code class="docutils literal notranslate"><span class="pre">_meta</span></code> API</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/models/relations.html">Related objects reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/models/class.html">Model class reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/models/options.html">Model <code class="docutils literal notranslate"><span class="pre">Meta</span></code> options</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/models/instances.html">Model instance reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/models/querysets.html"><code class="docutils literal notranslate"><span class="pre">QuerySet</span></code> API reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/models/lookups.html">Lookup API reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/models/expressions.html">Query Expressions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/models/conditional-expressions.html">Conditional Expressions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/models/database-functions.html">Database Functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../ref/paginator.html">Paginator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ref/request-response.html">Request and response objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ref/schema-editor.html"><code class="docutils literal notranslate"><span class="pre">SchemaEditor</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../ref/settings.html">Settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ref/signals.html">Signals</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../ref/templates/index.html">Templates</a><input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" role="switch" type="checkbox"/><label for="toctree-checkbox-27"><div class="visually-hidden">Toggle navigation of Templates</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../ref/templates/language.html">The GingerDJ template language</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/templates/builtins.html">Built-in template tags and filters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ref/templates/api.html">The GingerDJ template language: for Python programmers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../ref/template-response.html"><code class="docutils literal notranslate"><span class="pre">TemplateResponse</span></code> and <code class="docutils literal notranslate"><span class="pre">SimpleTemplateResponse</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../ref/unicode.html">Unicode data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ref/urlresolvers.html"><code class="docutils literal notranslate"><span class="pre">gingerdj.urls</span></code> utility functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ref/urls.html"><code class="docutils literal notranslate"><span class="pre">gingerdj.urls</span></code> functions for use in URLconfs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ref/urls.html#module-gingerdj.conf.urls"><code class="docutils literal notranslate"><span class="pre">gingerdj.conf.urls</span></code> functions for use in URLconfs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ref/utils.html">GingerDJ Utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ref/validators.html">Validators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ref/views.html">Built-in Views</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../misc/index.html">Meta-documentation and miscellany</a><input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" role="switch" type="checkbox"/><label for="toctree-checkbox-28"><div class="visually-hidden">Toggle navigation of Meta-documentation and miscellany</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../misc/api-stability.html">API stability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../misc/design-philosophies.html">Design philosophies</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/topics/cache.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="s-gingerdj-s-cache-framework">
<span id="gingerdj-s-cache-framework"></span><h1>GingerDJ’s cache framework<a class="headerlink" href="#gingerdj-s-cache-framework" title="Link to this heading">¶</a></h1>
<p>A fundamental trade-off in dynamic websites is, well, they’re dynamic. Each
time a user requests a page, the web server makes all sorts of calculations –
from database queries to template rendering to business logic – to create the
page that your site’s visitor sees. This is a lot more expensive, from a
processing-overhead perspective, than your standard
read-a-file-off-the-filesystem server arrangement.</p>
<p>For most web applications, this overhead isn’t a big deal. Most web
applications aren’t <code class="docutils literal notranslate"><span class="pre">washingtonpost.com</span></code> or <code class="docutils literal notranslate"><span class="pre">slashdot.org</span></code>; they’re small-
to medium-sized sites with so-so traffic. But for medium- to high-traffic
sites, it’s essential to cut as much overhead as possible.</p>
<p>That’s where caching comes in.</p>
<p>To cache something is to save the result of an expensive calculation so that
you don’t have to perform the calculation next time. Here’s some pseudocode
explaining how this would work for a dynamically generated web page:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>given a URL, try finding that page in the cache
if the page is in the cache:
    return the cached page
else:
    generate the page
    save the generated page in the cache (for next time)
    return the generated page
</pre></div>
</div>
<p>GingerDJ comes with a robust cache system that lets you save dynamic pages so
they don’t have to be calculated for each request. For convenience, GingerDJ
offers different levels of cache granularity: You can cache the output of
specific views, you can cache only the pieces that are difficult to produce,
or you can cache your entire site.</p>
<p>GingerDJ also works well with “downstream” caches, such as <a class="reference external" href="http://www.squid-cache.org/">Squid</a> and browser-based caches. These are the types
of caches that you don’t directly control but to which you can provide hints
(via HTTP headers) about which parts of your site should be cached, and how.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>The <a class="reference internal" href="../misc/design-philosophies.html#cache-design-philosophy"><span class="std std-ref">Cache Framework design philosophy</span></a>
explains a few of the design decisions of the framework.</p>
</div>
<section id="s-setting-up-the-cache">
<span id="s-id1"></span><span id="setting-up-the-cache"></span><span id="id1"></span><h2>Setting up the cache<a class="headerlink" href="#setting-up-the-cache" title="Link to this heading">¶</a></h2>
<p>The cache system requires a small amount of setup. Namely, you have to tell it
where your cached data should live – whether in a database, on the filesystem
or directly in memory. This is an important decision that affects your cache’s
performance; yes, some cache types are faster than others.</p>
<p>Your cache preference goes in the <a class="reference internal" href="../ref/settings.html#std-setting-CACHES"><code class="xref std std-setting docutils literal notranslate"><span class="pre">CACHES</span></code></a> setting in your
settings file. Here’s an explanation of all available values for
<a class="reference internal" href="../ref/settings.html#std-setting-CACHES"><code class="xref std std-setting docutils literal notranslate"><span class="pre">CACHES</span></code></a>.</p>
<section id="s-memcached">
<span id="s-id2"></span><span id="memcached"></span><span id="id2"></span><h3>Memcached<a class="headerlink" href="#memcached" title="Link to this heading">¶</a></h3>
<p><a class="reference external" href="https://memcached.org/">Memcached</a> is an entirely memory-based cache server, originally developed
to handle high loads at LiveJournal.com and subsequently open-sourced by
Danga Interactive. It is used by sites such as Facebook and Wikipedia to
reduce database access and dramatically increase site performance.</p>
<p>Memcached runs as a daemon and is allotted a specified amount of RAM. All it
does is provide a fast interface for adding, retrieving and deleting data in
the cache. All data is stored directly in memory, so there’s no overhead of
database or filesystem usage.</p>
<p>After installing Memcached itself, you’ll need to install a Memcached
binding. There are several Python Memcached bindings available; the
two supported by GingerDJ are <a class="extlink-pypi reference external" href="https://pypi.org/project/pylibmc/">pylibmc</a> and <a class="extlink-pypi reference external" href="https://pypi.org/project/pymemcache/">pymemcache</a>.</p>
<p>To use Memcached with GingerDJ:</p>
<ul class="simple">
<li><p>Set <a class="reference internal" href="../ref/settings.html#std-setting-CACHES-BACKEND"><code class="xref std std-setting docutils literal notranslate"><span class="pre">BACKEND</span></code></a> to
<code class="docutils literal notranslate"><span class="pre">gingerdj.core.cache.backends.memcached.PyMemcacheCache</span></code> or
<code class="docutils literal notranslate"><span class="pre">gingerdj.core.cache.backends.memcached.PyLibMCCache</span></code> (depending on your
chosen memcached binding)</p></li>
<li><p>Set <a class="reference internal" href="../ref/settings.html#std-setting-CACHES-LOCATION"><code class="xref std std-setting docutils literal notranslate"><span class="pre">LOCATION</span></code></a> to <code class="docutils literal notranslate"><span class="pre">ip:port</span></code> values,
where <code class="docutils literal notranslate"><span class="pre">ip</span></code> is the IP address of the Memcached daemon and <code class="docutils literal notranslate"><span class="pre">port</span></code> is the
port on which Memcached is running, or to a <code class="docutils literal notranslate"><span class="pre">unix:path</span></code> value, where
<code class="docutils literal notranslate"><span class="pre">path</span></code> is the path to a Memcached Unix socket file.</p></li>
</ul>
<p>In this example, Memcached is running on localhost (127.0.0.1) port 11211, using
the <code class="docutils literal notranslate"><span class="pre">pymemcache</span></code> binding:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CACHES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;BACKEND&quot;</span><span class="p">:</span> <span class="s2">&quot;gingerdj.core.cache.backends.memcached.PyMemcacheCache&quot;</span><span class="p">,</span>
        <span class="s2">&quot;LOCATION&quot;</span><span class="p">:</span> <span class="s2">&quot;127.0.0.1:11211&quot;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In this example, Memcached is available through a local Unix socket file
<code class="file docutils literal notranslate"><span class="pre">/tmp/memcached.sock</span></code> using the <code class="docutils literal notranslate"><span class="pre">pymemcache</span></code> binding:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CACHES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;BACKEND&quot;</span><span class="p">:</span> <span class="s2">&quot;gingerdj.core.cache.backends.memcached.PyMemcacheCache&quot;</span><span class="p">,</span>
        <span class="s2">&quot;LOCATION&quot;</span><span class="p">:</span> <span class="s2">&quot;unix:/tmp/memcached.sock&quot;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>One excellent feature of Memcached is its ability to share a cache over
multiple servers. This means you can run Memcached daemons on multiple
machines, and the program will treat the group of machines as a <em>single</em>
cache, without the need to duplicate cache values on each machine. To take
advantage of this feature, include all server addresses in
<a class="reference internal" href="../ref/settings.html#std-setting-CACHES-LOCATION"><code class="xref std std-setting docutils literal notranslate"><span class="pre">LOCATION</span></code></a>, either as a semicolon or comma
delimited string, or as a list.</p>
<p>In this example, the cache is shared over Memcached instances running on IP
address 172.19.26.240 and 172.19.26.242, both on port 11211:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CACHES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;BACKEND&quot;</span><span class="p">:</span> <span class="s2">&quot;gingerdj.core.cache.backends.memcached.PyMemcacheCache&quot;</span><span class="p">,</span>
        <span class="s2">&quot;LOCATION&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;172.19.26.240:11211&quot;</span><span class="p">,</span>
            <span class="s2">&quot;172.19.26.242:11211&quot;</span><span class="p">,</span>
        <span class="p">],</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In the following example, the cache is shared over Memcached instances running
on the IP addresses 172.19.26.240 (port 11211), 172.19.26.242 (port 11212), and
172.19.26.244 (port 11213):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CACHES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;BACKEND&quot;</span><span class="p">:</span> <span class="s2">&quot;gingerdj.core.cache.backends.memcached.PyMemcacheCache&quot;</span><span class="p">,</span>
        <span class="s2">&quot;LOCATION&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;172.19.26.240:11211&quot;</span><span class="p">,</span>
            <span class="s2">&quot;172.19.26.242:11212&quot;</span><span class="p">,</span>
            <span class="s2">&quot;172.19.26.244:11213&quot;</span><span class="p">,</span>
        <span class="p">],</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>By default, the <code class="docutils literal notranslate"><span class="pre">PyMemcacheCache</span></code> backend sets the following options (you can
override them in your <a class="reference internal" href="../ref/settings.html#std-setting-CACHES-OPTIONS"><code class="xref std std-setting docutils literal notranslate"><span class="pre">OPTIONS</span></code></a>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;OPTIONS&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;allow_unicode_keys&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s2">&quot;default_noreply&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s2">&quot;serde&quot;</span><span class="p">:</span> <span class="n">pymemcache</span><span class="o">.</span><span class="n">serde</span><span class="o">.</span><span class="n">pickle_serde</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>A final point about Memcached is that memory-based caching has a
disadvantage: because the cached data is stored in memory, the data will be
lost if your server crashes. Clearly, memory isn’t intended for permanent data
storage, so don’t rely on memory-based caching as your only data storage.
Without a doubt, <em>none</em> of the GingerDJ caching backends should be used for
permanent storage – they’re all intended to be solutions for caching, not
storage – but we point this out here because memory-based caching is
particularly temporary.</p>
</section>
<section id="s-redis">
<span id="s-id4"></span><span id="redis"></span><span id="id4"></span><h3>Redis<a class="headerlink" href="#redis" title="Link to this heading">¶</a></h3>
<p><a class="reference external" href="https://redis.io/">Redis</a> is an in-memory database that can be used for caching. To begin you’ll
need a Redis server running either locally or on a remote machine.</p>
<p>After setting up the Redis server, you’ll need to install Python bindings for
Redis. <a class="extlink-pypi reference external" href="https://pypi.org/project/redis/">redis-py</a> is the binding supported natively by GingerDJ.
Installing the <a class="extlink-pypi reference external" href="https://pypi.org/project/hiredis/">hiredis-py</a> package is also recommended.</p>
<p>To use Redis as your cache backend with GingerDJ:</p>
<ul class="simple">
<li><p>Set <a class="reference internal" href="../ref/settings.html#std-setting-CACHES-BACKEND"><code class="xref std std-setting docutils literal notranslate"><span class="pre">BACKEND</span></code></a> to
<code class="docutils literal notranslate"><span class="pre">gingerdj.core.cache.backends.redis.RedisCache</span></code>.</p></li>
<li><p>Set <a class="reference internal" href="../ref/settings.html#std-setting-CACHES-LOCATION"><code class="xref std std-setting docutils literal notranslate"><span class="pre">LOCATION</span></code></a> to the URL pointing to your Redis
instance, using the appropriate scheme. See the <code class="docutils literal notranslate"><span class="pre">redis-py</span></code> docs for
<a class="reference external" href="https://redis-py.readthedocs.io/en/stable/connections.html#redis.connection.ConnectionPool.from_url">details on the available schemes</a>.</p></li>
</ul>
<p>For example, if Redis is running on localhost (127.0.0.1) port 6379:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CACHES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;BACKEND&quot;</span><span class="p">:</span> <span class="s2">&quot;gingerdj.core.cache.backends.redis.RedisCache&quot;</span><span class="p">,</span>
        <span class="s2">&quot;LOCATION&quot;</span><span class="p">:</span> <span class="s2">&quot;redis://127.0.0.1:6379&quot;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Often Redis servers are protected with authentication. In order to supply a
username and password, add them in the <code class="docutils literal notranslate"><span class="pre">LOCATION</span></code> along with the URL:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CACHES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;BACKEND&quot;</span><span class="p">:</span> <span class="s2">&quot;gingerdj.core.cache.backends.redis.RedisCache&quot;</span><span class="p">,</span>
        <span class="s2">&quot;LOCATION&quot;</span><span class="p">:</span> <span class="s2">&quot;redis://username:password@127.0.0.1:6379&quot;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If you have multiple Redis servers set up in the replication mode, you can
specify the servers either as a semicolon or comma delimited string, or as a
list. While using multiple servers, write operations are performed on the first
server (leader). Read operations are performed on the other servers (replicas)
chosen at random:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CACHES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;BACKEND&quot;</span><span class="p">:</span> <span class="s2">&quot;gingerdj.core.cache.backends.redis.RedisCache&quot;</span><span class="p">,</span>
        <span class="s2">&quot;LOCATION&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;redis://127.0.0.1:6379&quot;</span><span class="p">,</span>  <span class="c1"># leader</span>
            <span class="s2">&quot;redis://127.0.0.1:6378&quot;</span><span class="p">,</span>  <span class="c1"># read-replica 1</span>
            <span class="s2">&quot;redis://127.0.0.1:6377&quot;</span><span class="p">,</span>  <span class="c1"># read-replica 2</span>
        <span class="p">],</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="s-database-caching">
<span id="s-id6"></span><span id="database-caching"></span><span id="id6"></span><h3>Database caching<a class="headerlink" href="#database-caching" title="Link to this heading">¶</a></h3>
<p>GingerDJ can store its cached data in your database. This works best if you’ve
got a fast, well-indexed database server.</p>
<p>To use a database table as your cache backend:</p>
<ul class="simple">
<li><p>Set <a class="reference internal" href="../ref/settings.html#std-setting-CACHES-BACKEND"><code class="xref std std-setting docutils literal notranslate"><span class="pre">BACKEND</span></code></a> to
<code class="docutils literal notranslate"><span class="pre">gingerdj.core.cache.backends.db.DatabaseCache</span></code></p></li>
<li><p>Set <a class="reference internal" href="../ref/settings.html#std-setting-CACHES-LOCATION"><code class="xref std std-setting docutils literal notranslate"><span class="pre">LOCATION</span></code></a> to <code class="docutils literal notranslate"><span class="pre">tablename</span></code>, the name of the
database table. This name can be whatever you want, as long as it’s a valid
table name that’s not already being used in your database.</p></li>
</ul>
<p>In this example, the cache table’s name is <code class="docutils literal notranslate"><span class="pre">my_cache_table</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CACHES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;BACKEND&quot;</span><span class="p">:</span> <span class="s2">&quot;gingerdj.core.cache.backends.db.DatabaseCache&quot;</span><span class="p">,</span>
        <span class="s2">&quot;LOCATION&quot;</span><span class="p">:</span> <span class="s2">&quot;my_cache_table&quot;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Unlike other cache backends, the database cache does not support automatic
culling of expired entries at the database level. Instead, expired cache
entries are culled each time <code class="docutils literal notranslate"><span class="pre">add()</span></code>, <code class="docutils literal notranslate"><span class="pre">set()</span></code>, or <code class="docutils literal notranslate"><span class="pre">touch()</span></code> is called.</p>
<section id="s-creating-the-cache-table">
<span id="creating-the-cache-table"></span><h4>Creating the cache table<a class="headerlink" href="#creating-the-cache-table" title="Link to this heading">¶</a></h4>
<p>Before using the database cache, you must create the cache table with this
command:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>manage.py<span class="w"> </span>createcachetable
</pre></div>
</div>
<p>This creates a table in your database that is in the proper format that
GingerDJ’s database-cache system expects. The name of the table is taken from
<a class="reference internal" href="../ref/settings.html#std-setting-CACHES-LOCATION"><code class="xref std std-setting docutils literal notranslate"><span class="pre">LOCATION</span></code></a>.</p>
<p>If you are using multiple database caches, <a class="reference internal" href="../ref/gingerdj-admin.html#gingerdj-admin-createcachetable"><code class="xref std std-djadmin docutils literal notranslate"><span class="pre">createcachetable</span></code></a> creates
one table for each cache.</p>
<p>If you are using multiple databases, <a class="reference internal" href="../ref/gingerdj-admin.html#gingerdj-admin-createcachetable"><code class="xref std std-djadmin docutils literal notranslate"><span class="pre">createcachetable</span></code></a> observes the
<code class="docutils literal notranslate"><span class="pre">allow_migrate()</span></code> method of your database routers (see below).</p>
<p>Like <a class="reference internal" href="../ref/gingerdj-admin.html#gingerdj-admin-migrate"><code class="xref std std-djadmin docutils literal notranslate"><span class="pre">migrate</span></code></a>, <a class="reference internal" href="../ref/gingerdj-admin.html#gingerdj-admin-createcachetable"><code class="xref std std-djadmin docutils literal notranslate"><span class="pre">createcachetable</span></code></a> won’t touch an existing
table. It will only create missing tables.</p>
<p>To print the SQL that would be run, rather than run it, use the
<a class="reference internal" href="../ref/gingerdj-admin.html#cmdoption-createcachetable-dry-run"><code class="xref std std-option docutils literal notranslate"><span class="pre">createcachetable</span> <span class="pre">--dry-run</span></code></a> option.</p>
</section>
<section id="s-multiple-databases">
<span id="multiple-databases"></span><h4>Multiple databases<a class="headerlink" href="#multiple-databases" title="Link to this heading">¶</a></h4>
<p>If you use database caching with multiple databases, you’ll also need
to set up routing instructions for your database cache table. For the
purposes of routing, the database cache table appears as a model named
<code class="docutils literal notranslate"><span class="pre">CacheEntry</span></code>, in an application named <code class="docutils literal notranslate"><span class="pre">ginger_cache</span></code>. This model
won’t appear in the models cache, but the model details can be used
for routing purposes.</p>
<p>For example, the following router would direct all cache read
operations to <code class="docutils literal notranslate"><span class="pre">cache_replica</span></code>, and all write operations to
<code class="docutils literal notranslate"><span class="pre">cache_primary</span></code>. The cache table will only be synchronized onto
<code class="docutils literal notranslate"><span class="pre">cache_primary</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CacheRouter</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A router to control all database cache operations&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">db_for_read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="o">**</span><span class="n">hints</span><span class="p">):</span>
        <span class="s2">&quot;All cache read operations go to the replica&quot;</span>
        <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">app_label</span> <span class="o">==</span> <span class="s2">&quot;ginger_cache&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;cache_replica&quot;</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">db_for_write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="o">**</span><span class="n">hints</span><span class="p">):</span>
        <span class="s2">&quot;All cache write operations go to primary&quot;</span>
        <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">app_label</span> <span class="o">==</span> <span class="s2">&quot;ginger_cache&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;cache_primary&quot;</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">allow_migrate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">db</span><span class="p">,</span> <span class="n">app_label</span><span class="p">,</span> <span class="n">model_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">hints</span><span class="p">):</span>
        <span class="s2">&quot;Only install the cache model on primary&quot;</span>
        <span class="k">if</span> <span class="n">app_label</span> <span class="o">==</span> <span class="s2">&quot;ginger_cache&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">db</span> <span class="o">==</span> <span class="s2">&quot;cache_primary&quot;</span>
        <span class="k">return</span> <span class="kc">None</span>
</pre></div>
</div>
<p>If you don’t specify routing directions for the database cache model,
the cache backend will use the <code class="docutils literal notranslate"><span class="pre">default</span></code> database.</p>
<p>And if you don’t use the database cache backend, you don’t need to worry about
providing routing instructions for the database cache model.</p>
</section>
</section>
<section id="s-filesystem-caching">
<span id="filesystem-caching"></span><h3>Filesystem caching<a class="headerlink" href="#filesystem-caching" title="Link to this heading">¶</a></h3>
<p>The file-based backend serializes and stores each cache value as a separate
file. To use this backend set <a class="reference internal" href="../ref/settings.html#std-setting-CACHES-BACKEND"><code class="xref std std-setting docutils literal notranslate"><span class="pre">BACKEND</span></code></a> to
<code class="docutils literal notranslate"><span class="pre">&quot;gingerdj.core.cache.backends.filebased.FileBasedCache&quot;</span></code> and
<a class="reference internal" href="../ref/settings.html#std-setting-CACHES-LOCATION"><code class="xref std std-setting docutils literal notranslate"><span class="pre">LOCATION</span></code></a> to a suitable directory. For example,
to store cached data in <code class="docutils literal notranslate"><span class="pre">/var/tmp/ginger_cache</span></code>, use this setting:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CACHES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;BACKEND&quot;</span><span class="p">:</span> <span class="s2">&quot;gingerdj.core.cache.backends.filebased.FileBasedCache&quot;</span><span class="p">,</span>
        <span class="s2">&quot;LOCATION&quot;</span><span class="p">:</span> <span class="s2">&quot;/var/tmp/ginger_cache&quot;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If you’re on Windows, put the drive letter at the beginning of the path,
like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CACHES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;BACKEND&quot;</span><span class="p">:</span> <span class="s2">&quot;gingerdj.core.cache.backends.filebased.FileBasedCache&quot;</span><span class="p">,</span>
        <span class="s2">&quot;LOCATION&quot;</span><span class="p">:</span> <span class="s2">&quot;c:/foo/bar&quot;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The directory path should be absolute – that is, it should start at the root
of your filesystem. It doesn’t matter whether you put a slash at the end of the
setting.</p>
<p>Make sure the directory pointed-to by this setting either exists and is
readable and writable, or that it can be created by the system user under which
your web server runs. Continuing the above example, if your server runs as the
user <code class="docutils literal notranslate"><span class="pre">apache</span></code>, make sure the directory <code class="docutils literal notranslate"><span class="pre">/var/tmp/ginger_cache</span></code> exists and
is readable and writable by the user <code class="docutils literal notranslate"><span class="pre">apache</span></code>, or that it can be created by
the user <code class="docutils literal notranslate"><span class="pre">apache</span></code>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When the cache <a class="reference internal" href="../ref/settings.html#std-setting-CACHES-LOCATION"><code class="xref std std-setting docutils literal notranslate"><span class="pre">LOCATION</span></code></a> is contained within
<a class="reference internal" href="../ref/settings.html#std-setting-MEDIA_ROOT"><code class="xref std std-setting docutils literal notranslate"><span class="pre">MEDIA_ROOT</span></code></a>, <a class="reference internal" href="../ref/settings.html#std-setting-STATIC_ROOT"><code class="xref std std-setting docutils literal notranslate"><span class="pre">STATIC_ROOT</span></code></a>, or
<a class="reference internal" href="../ref/settings.html#std-setting-STATICFILES_FINDERS"><code class="xref std std-setting docutils literal notranslate"><span class="pre">STATICFILES_FINDERS</span></code></a>, sensitive data may be exposed.</p>
<p>An attacker who gains access to the cache file can not only falsify HTML
content, which your site will trust, but also remotely execute arbitrary
code, as the data is serialized using <a class="reference external" href="https://docs.python.org/3/library/pickle.html#module-pickle" title="(in Python v3.13)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pickle</span></code></a>.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Filesystem caching may become slow when storing a large number of files. If
you run into this problem, consider using a different caching mechanism.
You can also subclass
<a class="extlink-source reference external" href="https://github.com/gingerdj/gingerdj/blob/main/gingerdj/core/cache/backends/filebased.py">FileBasedCache</a> and
improve the culling strategy.</p>
</div>
</section>
<section id="s-local-memory-caching">
<span id="s-id7"></span><span id="local-memory-caching"></span><span id="id7"></span><h3>Local-memory caching<a class="headerlink" href="#local-memory-caching" title="Link to this heading">¶</a></h3>
<p>This is the default cache if another is not specified in your settings file. If
you want the speed advantages of in-memory caching but don’t have the capability
of running Memcached, consider the local-memory cache backend. This cache is
per-process (see below) and thread-safe. To use it, set <a class="reference internal" href="../ref/settings.html#std-setting-CACHES-BACKEND"><code class="xref std std-setting docutils literal notranslate"><span class="pre">BACKEND</span></code></a> to <code class="docutils literal notranslate"><span class="pre">&quot;gingerdj.core.cache.backends.locmem.LocMemCache&quot;</span></code>. For
example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CACHES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;BACKEND&quot;</span><span class="p">:</span> <span class="s2">&quot;gingerdj.core.cache.backends.locmem.LocMemCache&quot;</span><span class="p">,</span>
        <span class="s2">&quot;LOCATION&quot;</span><span class="p">:</span> <span class="s2">&quot;unique-snowflake&quot;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The cache <a class="reference internal" href="../ref/settings.html#std-setting-CACHES-LOCATION"><code class="xref std std-setting docutils literal notranslate"><span class="pre">LOCATION</span></code></a> is used to identify individual
memory stores. If you only have one <code class="docutils literal notranslate"><span class="pre">locmem</span></code> cache, you can omit the
<a class="reference internal" href="../ref/settings.html#std-setting-CACHES-LOCATION"><code class="xref std std-setting docutils literal notranslate"><span class="pre">LOCATION</span></code></a>; however, if you have more than one local
memory cache, you will need to assign a name to at least one of them in
order to keep them separate.</p>
<p>The cache uses a least-recently-used (LRU) culling strategy.</p>
<p>Note that each process will have its own private cache instance, which means no
cross-process caching is possible. This also means the local memory cache isn’t
particularly memory-efficient, so it’s probably not a good choice for
production environments. It’s nice for development.</p>
</section>
<section id="s-dummy-caching-for-development">
<span id="dummy-caching-for-development"></span><h3>Dummy caching (for development)<a class="headerlink" href="#dummy-caching-for-development" title="Link to this heading">¶</a></h3>
<p>Finally, GingerDJ comes with a “dummy” cache that doesn’t actually cache – it
just implements the cache interface without doing anything.</p>
<p>This is useful if you have a production site that uses heavy-duty caching in
various places but a development/test environment where you don’t want to cache
and don’t want to have to change your code to special-case the latter. To
activate dummy caching, set <a class="reference internal" href="../ref/settings.html#std-setting-CACHES-BACKEND"><code class="xref std std-setting docutils literal notranslate"><span class="pre">BACKEND</span></code></a> like so:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CACHES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;BACKEND&quot;</span><span class="p">:</span> <span class="s2">&quot;gingerdj.core.cache.backends.dummy.DummyCache&quot;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="s-using-a-custom-cache-backend">
<span id="using-a-custom-cache-backend"></span><h3>Using a custom cache backend<a class="headerlink" href="#using-a-custom-cache-backend" title="Link to this heading">¶</a></h3>
<p>While GingerDJ includes support for a number of cache backends out-of-the-box,
sometimes you might want to use a customized cache backend. To use an external
cache backend with GingerDJ, use the Python import path as the
<a class="reference internal" href="../ref/settings.html#std-setting-CACHES-BACKEND"><code class="xref std std-setting docutils literal notranslate"><span class="pre">BACKEND</span></code></a> of the <a class="reference internal" href="../ref/settings.html#std-setting-CACHES"><code class="xref std std-setting docutils literal notranslate"><span class="pre">CACHES</span></code></a> setting, like so:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CACHES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;BACKEND&quot;</span><span class="p">:</span> <span class="s2">&quot;path.to.backend&quot;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If you’re building your own backend, you can use the standard cache backends
as reference implementations. You’ll find the code in the
<a class="extlink-source reference external" href="https://github.com/gingerdj/gingerdj/blob/main/gingerdj/core/cache/backends/">gingerdj/core/cache/backends/</a> directory of the GingerDJ source.</p>
<p>Note: Without a really compelling reason, such as a host that doesn’t support
them, you should stick to the cache backends included with GingerDJ. They’ve
been well-tested and are well-documented.</p>
</section>
<section id="s-cache-arguments">
<span id="s-id8"></span><span id="cache-arguments"></span><span id="id8"></span><h3>Cache arguments<a class="headerlink" href="#cache-arguments" title="Link to this heading">¶</a></h3>
<p>Each cache backend can be given additional arguments to control caching
behavior. These arguments are provided as additional keys in the
<a class="reference internal" href="../ref/settings.html#std-setting-CACHES"><code class="xref std std-setting docutils literal notranslate"><span class="pre">CACHES</span></code></a> setting. Valid arguments are as follows:</p>
<ul>
<li><p><a class="reference internal" href="../ref/settings.html#std-setting-CACHES-TIMEOUT"><code class="xref std std-setting docutils literal notranslate"><span class="pre">TIMEOUT</span></code></a>: The default timeout, in
seconds, to use for the cache. This argument defaults to <code class="docutils literal notranslate"><span class="pre">300</span></code> seconds (5 minutes).
You can set <code class="docutils literal notranslate"><span class="pre">TIMEOUT</span></code> to <code class="docutils literal notranslate"><span class="pre">None</span></code> so that, by default, cache keys never
expire. A value of <code class="docutils literal notranslate"><span class="pre">0</span></code> causes keys to immediately expire (effectively
“don’t cache”).</p></li>
<li><p><a class="reference internal" href="../ref/settings.html#std-setting-CACHES-OPTIONS"><code class="xref std std-setting docutils literal notranslate"><span class="pre">OPTIONS</span></code></a>: Any options that should be
passed to the cache backend. The list of valid options will vary
with each backend, and cache backends backed by a third-party library
will pass their options directly to the underlying cache library.</p>
<p>Cache backends that implement their own culling strategy (i.e.,
the <code class="docutils literal notranslate"><span class="pre">locmem</span></code>, <code class="docutils literal notranslate"><span class="pre">filesystem</span></code> and <code class="docutils literal notranslate"><span class="pre">database</span></code> backends) will
honor the following options:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">MAX_ENTRIES</span></code>: The maximum number of entries allowed in
the cache before old values are deleted. This argument
defaults to <code class="docutils literal notranslate"><span class="pre">300</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CULL_FREQUENCY</span></code>: The fraction of entries that are culled
when <code class="docutils literal notranslate"><span class="pre">MAX_ENTRIES</span></code> is reached. The actual ratio is
<code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">/</span> <span class="pre">CULL_FREQUENCY</span></code>, so set <code class="docutils literal notranslate"><span class="pre">CULL_FREQUENCY</span></code> to <code class="docutils literal notranslate"><span class="pre">2</span></code> to
cull half the entries when <code class="docutils literal notranslate"><span class="pre">MAX_ENTRIES</span></code> is reached. This argument
should be an integer and defaults to <code class="docutils literal notranslate"><span class="pre">3</span></code>.</p>
<p>A value of <code class="docutils literal notranslate"><span class="pre">0</span></code> for <code class="docutils literal notranslate"><span class="pre">CULL_FREQUENCY</span></code> means that the
entire cache will be dumped when <code class="docutils literal notranslate"><span class="pre">MAX_ENTRIES</span></code> is reached.
On some backends (<code class="docutils literal notranslate"><span class="pre">database</span></code> in particular) this makes culling <em>much</em>
faster at the expense of more cache misses.</p>
</li>
</ul>
<p>The Memcached and Redis backends pass the contents of <a class="reference internal" href="../ref/settings.html#std-setting-CACHES-OPTIONS"><code class="xref std std-setting docutils literal notranslate"><span class="pre">OPTIONS</span></code></a> as keyword arguments to the client constructors, allowing
for more advanced control of client behavior. For example usage, see below.</p>
</li>
<li><p><a class="reference internal" href="../ref/settings.html#std-setting-CACHES-KEY_PREFIX"><code class="xref std std-setting docutils literal notranslate"><span class="pre">KEY_PREFIX</span></code></a>: A string that will be
automatically included (prepended by default) to all cache keys
used by the GingerDJ server.</p>
<p>See the <a class="reference internal" href="#cache-key-prefixing"><span class="std std-ref">cache documentation</span></a> for
more information.</p>
</li>
<li><p><a class="reference internal" href="../ref/settings.html#std-setting-CACHES-VERSION"><code class="xref std std-setting docutils literal notranslate"><span class="pre">VERSION</span></code></a>: The default version number
for cache keys generated by the GingerDJ server.</p>
<p>See the <a class="reference internal" href="#cache-versioning"><span class="std std-ref">cache documentation</span></a> for more
information.</p>
</li>
<li><p><a class="reference internal" href="../ref/settings.html#std-setting-CACHES-KEY_FUNCTION"><code class="xref std std-setting docutils literal notranslate"><span class="pre">KEY_FUNCTION</span></code></a>
A string containing a dotted path to a function that defines how
to compose a prefix, version and key into a final cache key.</p>
<p>See the <a class="reference internal" href="#cache-key-transformation"><span class="std std-ref">cache documentation</span></a>
for more information.</p>
</li>
</ul>
<p>In this example, a filesystem backend is being configured with a timeout
of 60 seconds, and a maximum capacity of 1000 items:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CACHES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;BACKEND&quot;</span><span class="p">:</span> <span class="s2">&quot;gingerdj.core.cache.backends.filebased.FileBasedCache&quot;</span><span class="p">,</span>
        <span class="s2">&quot;LOCATION&quot;</span><span class="p">:</span> <span class="s2">&quot;/var/tmp/ginger_cache&quot;</span><span class="p">,</span>
        <span class="s2">&quot;TIMEOUT&quot;</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span>
        <span class="s2">&quot;OPTIONS&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;MAX_ENTRIES&quot;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">},</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Here’s an example configuration for a <code class="docutils literal notranslate"><span class="pre">pylibmc</span></code> based backend that enables
the binary protocol, SASL authentication, and the <code class="docutils literal notranslate"><span class="pre">ketama</span></code> behavior mode:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CACHES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;BACKEND&quot;</span><span class="p">:</span> <span class="s2">&quot;gingerdj.core.cache.backends.memcached.PyLibMCCache&quot;</span><span class="p">,</span>
        <span class="s2">&quot;LOCATION&quot;</span><span class="p">:</span> <span class="s2">&quot;127.0.0.1:11211&quot;</span><span class="p">,</span>
        <span class="s2">&quot;OPTIONS&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;binary&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="s2">&quot;username&quot;</span><span class="p">:</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span>
            <span class="s2">&quot;password&quot;</span><span class="p">:</span> <span class="s2">&quot;pass&quot;</span><span class="p">,</span>
            <span class="s2">&quot;behaviors&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;ketama&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">},</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Here’s an example configuration for a <code class="docutils literal notranslate"><span class="pre">pymemcache</span></code> based backend that enables
client pooling (which may improve performance by keeping clients connected),
treats memcache/network errors as cache misses, and sets the <code class="docutils literal notranslate"><span class="pre">TCP_NODELAY</span></code>
flag on the connection’s socket:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CACHES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;BACKEND&quot;</span><span class="p">:</span> <span class="s2">&quot;gingerdj.core.cache.backends.memcached.PyMemcacheCache&quot;</span><span class="p">,</span>
        <span class="s2">&quot;LOCATION&quot;</span><span class="p">:</span> <span class="s2">&quot;127.0.0.1:11211&quot;</span><span class="p">,</span>
        <span class="s2">&quot;OPTIONS&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;no_delay&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="s2">&quot;ignore_exc&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="s2">&quot;max_pool_size&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
            <span class="s2">&quot;use_pooling&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Here’s an example configuration for a <code class="docutils literal notranslate"><span class="pre">redis</span></code> based backend that selects
database <code class="docutils literal notranslate"><span class="pre">10</span></code> (by default Redis ships with 16 logical databases), specifies a
<a class="reference external" href="https://github.com/redis/redis-py#parsers">parser class</a> (<code class="docutils literal notranslate"><span class="pre">redis.connection.HiredisParser</span></code> will be used by default if
the <code class="docutils literal notranslate"><span class="pre">hiredis-py</span></code> package is installed), and sets a custom <a class="reference external" href="https://github.com/redis/redis-py#connection-pools">connection pool
class</a> (<code class="docutils literal notranslate"><span class="pre">redis.ConnectionPool</span></code> is used by default):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CACHES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;BACKEND&quot;</span><span class="p">:</span> <span class="s2">&quot;gingerdj.core.cache.backends.redis.RedisCache&quot;</span><span class="p">,</span>
        <span class="s2">&quot;LOCATION&quot;</span><span class="p">:</span> <span class="s2">&quot;redis://127.0.0.1:6379&quot;</span><span class="p">,</span>
        <span class="s2">&quot;OPTIONS&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;db&quot;</span><span class="p">:</span> <span class="s2">&quot;10&quot;</span><span class="p">,</span>
            <span class="s2">&quot;parser_class&quot;</span><span class="p">:</span> <span class="s2">&quot;redis.connection.PythonParser&quot;</span><span class="p">,</span>
            <span class="s2">&quot;pool_class&quot;</span><span class="p">:</span> <span class="s2">&quot;redis.BlockingConnectionPool&quot;</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="s-the-per-site-cache">
<span id="s-id9"></span><span id="the-per-site-cache"></span><span id="id9"></span><h2>The per-site cache<a class="headerlink" href="#the-per-site-cache" title="Link to this heading">¶</a></h2>
<p>Once the cache is set up, the simplest way to use caching is to cache your
entire site. You’ll need to add
<code class="docutils literal notranslate"><span class="pre">'gingerdj.middleware.cache.UpdateCacheMiddleware'</span></code> and
<code class="docutils literal notranslate"><span class="pre">'gingerdj.middleware.cache.FetchFromCacheMiddleware'</span></code> to your
<a class="reference internal" href="../ref/settings.html#std-setting-MIDDLEWARE"><code class="xref std std-setting docutils literal notranslate"><span class="pre">MIDDLEWARE</span></code></a> setting, as in this example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">MIDDLEWARE</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;gingerdj.middleware.cache.UpdateCacheMiddleware&quot;</span><span class="p">,</span>
    <span class="s2">&quot;gingerdj.middleware.common.CommonMiddleware&quot;</span><span class="p">,</span>
    <span class="s2">&quot;gingerdj.middleware.cache.FetchFromCacheMiddleware&quot;</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>No, that’s not a typo: the “update” middleware must be first in the list,
and the “fetch” middleware must be last. The details are a bit obscure, but
see <a class="reference internal" href="#order-of-middleware">Order of MIDDLEWARE</a> below if you’d like the full story.</p>
</div>
<p>Then, add the following required settings to your GingerDJ settings file:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../ref/settings.html#std-setting-CACHE_MIDDLEWARE_ALIAS"><code class="xref std std-setting docutils literal notranslate"><span class="pre">CACHE_MIDDLEWARE_ALIAS</span></code></a> – The cache alias to use for storage.</p></li>
<li><p><a class="reference internal" href="../ref/settings.html#std-setting-CACHE_MIDDLEWARE_SECONDS"><code class="xref std std-setting docutils literal notranslate"><span class="pre">CACHE_MIDDLEWARE_SECONDS</span></code></a> – The integer number of seconds each
page should be cached.</p></li>
<li><p><a class="reference internal" href="../ref/settings.html#std-setting-CACHE_MIDDLEWARE_KEY_PREFIX"><code class="xref std std-setting docutils literal notranslate"><span class="pre">CACHE_MIDDLEWARE_KEY_PREFIX</span></code></a> – If the cache is shared across
multiple sites using the same GingerDJ installation, set this to the name of
the site, or some other string that is unique to this GingerDJ instance, to
prevent key collisions. Use an empty string if you don’t care.</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">FetchFromCacheMiddleware</span></code> caches GET and HEAD responses with status 200,
where the request and response headers allow. Responses to requests for the same
URL with different query parameters are considered to be unique pages and are
cached separately. This middleware expects that a HEAD request is answered with
the same response headers as the corresponding GET request; in which case it can
return a cached GET response for HEAD request.</p>
<p>Additionally, <code class="docutils literal notranslate"><span class="pre">UpdateCacheMiddleware</span></code> automatically sets a few headers in
each <a class="reference internal" href="../ref/request-response.html#gingerdj.http.HttpResponse" title="gingerdj.http.HttpResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">HttpResponse</span></code></a> which affect <a class="reference internal" href="#downstream-caches"><span class="std std-ref">downstream caches</span></a>:</p>
<ul class="simple">
<li><p>Sets the <code class="docutils literal notranslate"><span class="pre">Expires</span></code> header to the current date/time plus the defined
<a class="reference internal" href="../ref/settings.html#std-setting-CACHE_MIDDLEWARE_SECONDS"><code class="xref std std-setting docutils literal notranslate"><span class="pre">CACHE_MIDDLEWARE_SECONDS</span></code></a>.</p></li>
<li><p>Sets the <code class="docutils literal notranslate"><span class="pre">Cache-Control</span></code> header to give a max age for the page –
again, from the <a class="reference internal" href="../ref/settings.html#std-setting-CACHE_MIDDLEWARE_SECONDS"><code class="xref std std-setting docutils literal notranslate"><span class="pre">CACHE_MIDDLEWARE_SECONDS</span></code></a> setting.</p></li>
</ul>
<p>See <a class="reference internal" href="http/middleware.html"><span class="doc">Middleware</span></a> for more on middleware.</p>
<p>If a view sets its own cache expiry time (i.e. it has a <code class="docutils literal notranslate"><span class="pre">max-age</span></code> section in
its <code class="docutils literal notranslate"><span class="pre">Cache-Control</span></code> header) then the page will be cached until the expiry
time, rather than <a class="reference internal" href="../ref/settings.html#std-setting-CACHE_MIDDLEWARE_SECONDS"><code class="xref std std-setting docutils literal notranslate"><span class="pre">CACHE_MIDDLEWARE_SECONDS</span></code></a>. Using the decorators in
<code class="docutils literal notranslate"><span class="pre">gingerdj.views.decorators.cache</span></code> you can easily set a view’s expiry time
(using the <a class="reference internal" href="http/decorators.html#gingerdj.views.decorators.cache.cache_control" title="gingerdj.views.decorators.cache.cache_control"><code class="xref py py-func docutils literal notranslate"><span class="pre">cache_control()</span></code></a> decorator) or
disable caching for a view (using the
<a class="reference internal" href="http/decorators.html#gingerdj.views.decorators.cache.never_cache" title="gingerdj.views.decorators.cache.never_cache"><code class="xref py py-func docutils literal notranslate"><span class="pre">never_cache()</span></code></a> decorator). See the
<a class="reference internal" href="#controlling-cache-using-other-headers">using other headers</a> section for more on these decorators.</p>
<p id="i18n-cache-key">If <a class="reference internal" href="../ref/settings.html#std-setting-USE_I18N"><code class="xref std std-setting docutils literal notranslate"><span class="pre">USE_I18N</span></code></a> is set to <code class="docutils literal notranslate"><span class="pre">True</span></code> then the generated cache key will
include the name of the active <a class="reference internal" href="i18n/index.html#term-language-code"><span class="xref std std-term">language</span></a> – see also
<a class="reference internal" href="i18n/translation.html#how-gingerdj-discovers-language-preference"><span class="std std-ref">How GingerDJ discovers language preference</span></a>). This allows you to easily
cache multilingual sites without having to create the cache key yourself.</p>
<p>Cache keys also include the <a class="reference internal" href="i18n/timezones.html#default-current-time-zone"><span class="std std-ref">current time zone</span></a> when <a class="reference internal" href="../ref/settings.html#std-setting-USE_TZ"><code class="xref std std-setting docutils literal notranslate"><span class="pre">USE_TZ</span></code></a> is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</section>
<section id="s-the-per-view-cache">
<span id="the-per-view-cache"></span><h2>The per-view cache<a class="headerlink" href="#the-per-view-cache" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="gingerdj.views.decorators.cache.cache_page">
<span class="sig-prename descclassname"><span class="pre">gingerdj.views.decorators.cache.</span></span><span class="sig-name descname"><span class="pre">cache_page</span></span>(<em class="sig-param"><span class="n"><span class="pre">timeout</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>)<a class="headerlink" href="#gingerdj.views.decorators.cache.cache_page" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<p>A more granular way to use the caching framework is by caching the output of
individual views. <code class="docutils literal notranslate"><span class="pre">gingerdj.views.decorators.cache</span></code> defines a <code class="docutils literal notranslate"><span class="pre">cache_page</span></code>
decorator that will automatically cache the view’s response for you:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gingerdj.views.decorators.cache</span> <span class="kn">import</span> <span class="n">cache_page</span>


<span class="nd">@cache_page</span><span class="p">(</span><span class="mi">60</span> <span class="o">*</span> <span class="mi">15</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">my_view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span> <span class="o">...</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">cache_page</span></code> takes a single argument: the cache timeout, in seconds. In the
above example, the result of the <code class="docutils literal notranslate"><span class="pre">my_view()</span></code> view will be cached for 15
minutes. (Note that we’ve written it as <code class="docutils literal notranslate"><span class="pre">60</span> <span class="pre">*</span> <span class="pre">15</span></code> for the purpose of
readability. <code class="docutils literal notranslate"><span class="pre">60</span> <span class="pre">*</span> <span class="pre">15</span></code> will be evaluated to <code class="docutils literal notranslate"><span class="pre">900</span></code> – that is, 15 minutes
multiplied by 60 seconds per minute.)</p>
<p>The cache timeout set by <code class="docutils literal notranslate"><span class="pre">cache_page</span></code> takes precedence over the <code class="docutils literal notranslate"><span class="pre">max-age</span></code>
directive from the <code class="docutils literal notranslate"><span class="pre">Cache-Control</span></code> header.</p>
<p>The per-view cache, like the per-site cache, is keyed off of the URL. If
multiple URLs point at the same view, each URL will be cached separately.
Continuing the <code class="docutils literal notranslate"><span class="pre">my_view</span></code> example, if your URLconf looks like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">path</span><span class="p">(</span><span class="s2">&quot;foo/&lt;int:code&gt;/&quot;</span><span class="p">,</span> <span class="n">my_view</span><span class="p">),</span>
<span class="p">]</span>
</pre></div>
</div>
<p>then requests to <code class="docutils literal notranslate"><span class="pre">/foo/1/</span></code> and <code class="docutils literal notranslate"><span class="pre">/foo/23/</span></code> will be cached separately, as
you may expect. But once a particular URL (e.g., <code class="docutils literal notranslate"><span class="pre">/foo/23/</span></code>) has been
requested, subsequent requests to that URL will use the cache.</p>
<p><code class="docutils literal notranslate"><span class="pre">cache_page</span></code> can also take an optional keyword argument, <code class="docutils literal notranslate"><span class="pre">cache</span></code>,
which directs the decorator to use a specific cache (from your
<a class="reference internal" href="../ref/settings.html#std-setting-CACHES"><code class="xref std std-setting docutils literal notranslate"><span class="pre">CACHES</span></code></a> setting) when caching view results. By default, the
<code class="docutils literal notranslate"><span class="pre">default</span></code> cache will be used, but you can specify any cache you
want:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@cache_page</span><span class="p">(</span><span class="mi">60</span> <span class="o">*</span> <span class="mi">15</span><span class="p">,</span> <span class="n">cache</span><span class="o">=</span><span class="s2">&quot;special_cache&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">my_view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span> <span class="o">...</span>
</pre></div>
</div>
<p>You can also override the cache prefix on a per-view basis. <code class="docutils literal notranslate"><span class="pre">cache_page</span></code>
takes an optional keyword argument, <code class="docutils literal notranslate"><span class="pre">key_prefix</span></code>,
which works in the same way as the <a class="reference internal" href="../ref/settings.html#std-setting-CACHE_MIDDLEWARE_KEY_PREFIX"><code class="xref std std-setting docutils literal notranslate"><span class="pre">CACHE_MIDDLEWARE_KEY_PREFIX</span></code></a>
setting for the middleware.  It can be used like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@cache_page</span><span class="p">(</span><span class="mi">60</span> <span class="o">*</span> <span class="mi">15</span><span class="p">,</span> <span class="n">key_prefix</span><span class="o">=</span><span class="s2">&quot;site1&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">my_view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span> <span class="o">...</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">key_prefix</span></code> and <code class="docutils literal notranslate"><span class="pre">cache</span></code> arguments may be specified together. The
<code class="docutils literal notranslate"><span class="pre">key_prefix</span></code> argument and the <a class="reference internal" href="../ref/settings.html#std-setting-CACHES-KEY_PREFIX"><code class="xref std std-setting docutils literal notranslate"><span class="pre">KEY_PREFIX</span></code></a>
specified under <a class="reference internal" href="../ref/settings.html#std-setting-CACHES"><code class="xref std std-setting docutils literal notranslate"><span class="pre">CACHES</span></code></a> will be concatenated.</p>
<p>Additionally, <code class="docutils literal notranslate"><span class="pre">cache_page</span></code> automatically sets <code class="docutils literal notranslate"><span class="pre">Cache-Control</span></code> and
<code class="docutils literal notranslate"><span class="pre">Expires</span></code> headers in the response which affect <a class="reference internal" href="#downstream-caches"><span class="std std-ref">downstream caches</span></a>.</p>
<section id="s-specifying-per-view-cache-in-the-urlconf">
<span id="specifying-per-view-cache-in-the-urlconf"></span><h3>Specifying per-view cache in the URLconf<a class="headerlink" href="#specifying-per-view-cache-in-the-urlconf" title="Link to this heading">¶</a></h3>
<p>The examples in the previous section have hard-coded the fact that the view is
cached, because <code class="docutils literal notranslate"><span class="pre">cache_page</span></code> alters the <code class="docutils literal notranslate"><span class="pre">my_view</span></code> function in place. This
approach couples your view to the cache system, which is not ideal for several
reasons. For instance, you might want to reuse the view functions on another,
cache-less site, or you might want to distribute the views to people who might
want to use them without being cached. The solution to these problems is to
specify the per-view cache in the URLconf rather than next to the view functions
themselves.</p>
<p>You can do so by wrapping the view function with <code class="docutils literal notranslate"><span class="pre">cache_page</span></code> when you refer
to it in the URLconf. Here’s the old URLconf from earlier:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">path</span><span class="p">(</span><span class="s2">&quot;foo/&lt;int:code&gt;/&quot;</span><span class="p">,</span> <span class="n">my_view</span><span class="p">),</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Here’s the same thing, with <code class="docutils literal notranslate"><span class="pre">my_view</span></code> wrapped in <code class="docutils literal notranslate"><span class="pre">cache_page</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gingerdj.views.decorators.cache</span> <span class="kn">import</span> <span class="n">cache_page</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">path</span><span class="p">(</span><span class="s2">&quot;foo/&lt;int:code&gt;/&quot;</span><span class="p">,</span> <span class="n">cache_page</span><span class="p">(</span><span class="mi">60</span> <span class="o">*</span> <span class="mi">15</span><span class="p">)(</span><span class="n">my_view</span><span class="p">)),</span>
<span class="p">]</span>
</pre></div>
</div>
</section>
</section>
<section id="s-template-fragment-caching">
<span id="s-std-templatetag-cache"></span><span id="template-fragment-caching"></span><span id="std-templatetag-cache"></span><h2>Template fragment caching<a class="headerlink" href="#template-fragment-caching" title="Link to this heading">¶</a></h2>
<p>If you’re after even more control, you can also cache template fragments using
the <code class="docutils literal notranslate"><span class="pre">cache</span></code> template tag. To give your template access to this tag, put
<code class="docutils literal notranslate"><span class="pre">{%</span> <span class="pre">load</span> <span class="pre">cache</span> <span class="pre">%}</span></code> near the top of your template.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">{%</span> <span class="pre">cache</span> <span class="pre">%}</span></code> template tag caches the contents of the block for a given
amount of time. It takes at least two arguments: the cache timeout, in seconds,
and the name to give the cache fragment. The fragment is cached forever if
timeout is <code class="docutils literal notranslate"><span class="pre">None</span></code>. The name will be taken as is, do not use a variable. For
example:</p>
<div class="highlight-html+django notranslate"><div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">load</span> <span class="nv">cache</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">cache</span> <span class="m">500</span> <span class="nv">sidebar</span> <span class="cp">%}</span>
    .. sidebar ..
<span class="cp">{%</span> <span class="k">endcache</span> <span class="cp">%}</span>
</pre></div>
</div>
<p>Sometimes you might want to cache multiple copies of a fragment depending on
some dynamic data that appears inside the fragment. For example, you might want a
separate cached copy of the sidebar used in the previous example for every user
of your site. Do this by passing one or more additional arguments, which may be
variables with or without filters, to the <code class="docutils literal notranslate"><span class="pre">{%</span> <span class="pre">cache</span> <span class="pre">%}</span></code> template tag to
uniquely identify the cache fragment:</p>
<div class="highlight-html+django notranslate"><div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">load</span> <span class="nv">cache</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">cache</span> <span class="m">500</span> <span class="nv">sidebar</span> <span class="nv">request.user.username</span> <span class="cp">%}</span>
    .. sidebar for logged in user ..
<span class="cp">{%</span> <span class="k">endcache</span> <span class="cp">%}</span>
</pre></div>
</div>
<p>If <a class="reference internal" href="../ref/settings.html#std-setting-USE_I18N"><code class="xref std std-setting docutils literal notranslate"><span class="pre">USE_I18N</span></code></a> is set to <code class="docutils literal notranslate"><span class="pre">True</span></code> the per-site middleware cache will
<a class="reference internal" href="#i18n-cache-key"><span class="std std-ref">respect the active language</span></a>. For the <code class="docutils literal notranslate"><span class="pre">cache</span></code> template
tag you could use one of the
<a class="reference internal" href="i18n/translation.html#template-translation-vars"><span class="std std-ref">translation-specific variables</span></a> available in
templates to achieve the same result:</p>
<div class="highlight-html+django notranslate"><div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">load</span> <span class="nv">i18n</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">load</span> <span class="nv">cache</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">get_current_language</span> <span class="k">as</span> <span class="nv">LANGUAGE_CODE</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">cache</span> <span class="m">600</span> <span class="nv">welcome</span> <span class="nv">LANGUAGE_CODE</span> <span class="cp">%}</span>
    <span class="cp">{%</span> <span class="k">translate</span> <span class="s2">&quot;Welcome to example.com&quot;</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">endcache</span> <span class="cp">%}</span>
</pre></div>
</div>
<p>The cache timeout can be a template variable, as long as the template variable
resolves to an integer value. For example, if the template variable
<code class="docutils literal notranslate"><span class="pre">my_timeout</span></code> is set to the value <code class="docutils literal notranslate"><span class="pre">600</span></code>, then the following two examples are
equivalent:</p>
<div class="highlight-html+django notranslate"><div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">cache</span> <span class="m">600</span> <span class="nv">sidebar</span> <span class="cp">%}</span> ... <span class="cp">{%</span> <span class="k">endcache</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">cache</span> <span class="nv">my_timeout</span> <span class="nv">sidebar</span> <span class="cp">%}</span> ... <span class="cp">{%</span> <span class="k">endcache</span> <span class="cp">%}</span>
</pre></div>
</div>
<p>This feature is useful in avoiding repetition in templates. You can set the
timeout in a variable, in one place, and reuse that value.</p>
<p>By default, the cache tag will try to use the cache called “template_fragments”.
If no such cache exists, it will fall back to using the default cache. You may
select an alternate cache backend to use with the <code class="docutils literal notranslate"><span class="pre">using</span></code> keyword argument,
which must be the last argument to the tag.</p>
<div class="highlight-html+django notranslate"><div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">cache</span> <span class="m">300</span> <span class="nv">local-thing</span> <span class="p">...</span>  <span class="nv">using</span><span class="o">=</span><span class="s2">&quot;localcache&quot;</span> <span class="cp">%}</span>
</pre></div>
</div>
<p>It is considered an error to specify a cache name that is not configured.</p>
<dl class="py function">
<dt class="sig sig-object py" id="gingerdj.core.cache.utils.make_template_fragment_key">
<span class="sig-prename descclassname"><span class="pre">gingerdj.core.cache.utils.</span></span><span class="sig-name descname"><span class="pre">make_template_fragment_key</span></span>(<em class="sig-param"><span class="n"><span class="pre">fragment_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vary_on</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>)<a class="headerlink" href="#gingerdj.core.cache.utils.make_template_fragment_key" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<p>If you want to obtain the cache key used for a cached fragment, you can use
<code class="docutils literal notranslate"><span class="pre">make_template_fragment_key</span></code>. <code class="docutils literal notranslate"><span class="pre">fragment_name</span></code> is the same as second argument
to the <code class="docutils literal notranslate"><span class="pre">cache</span></code> template tag; <code class="docutils literal notranslate"><span class="pre">vary_on</span></code> is a list of all additional arguments
passed to the tag. This function can be useful for invalidating or overwriting
a cached item, for example:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gingerdj.core.cache</span> <span class="kn">import</span> <span class="n">cache</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gingerdj.core.cache.utils</span> <span class="kn">import</span> <span class="n">make_template_fragment_key</span>
<span class="go"># cache key for {% cache 500 sidebar username %}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">key</span> <span class="o">=</span> <span class="n">make_template_fragment_key</span><span class="p">(</span><span class="s2">&quot;sidebar&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">username</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cache</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>  <span class="c1"># invalidates cached template fragment</span>
<span class="go">True</span>
</pre></div>
</div>
</section>
<section id="s-the-low-level-cache-api">
<span id="s-low-level-cache-api"></span><span id="the-low-level-cache-api"></span><span id="low-level-cache-api"></span><h2>The low-level cache API<a class="headerlink" href="#the-low-level-cache-api" title="Link to this heading">¶</a></h2>
<p>Sometimes, caching an entire rendered page doesn’t gain you very much and is,
in fact, inconvenient overkill.</p>
<p>Perhaps, for instance, your site includes a view whose results depend on
several expensive queries, the results of which change at different intervals.
In this case, it would not be ideal to use the full-page caching that the
per-site or per-view cache strategies offer, because you wouldn’t want to
cache the entire result (since some of the data changes often), but you’d still
want to cache the results that rarely change.</p>
<p>For cases like this, GingerDJ exposes a low-level cache API. You can use this API
to store objects in the cache with any level of granularity you like.  You can
cache any Python object that can be pickled safely: strings, dictionaries,
lists of model objects, and so forth. (Most common Python objects can be
pickled; refer to the Python documentation for more information about
pickling.)</p>
<section id="s-accessing-the-cache">
<span id="accessing-the-cache"></span><h3>Accessing the cache<a class="headerlink" href="#accessing-the-cache" title="Link to this heading">¶</a></h3>
<dl class="py data">
<dt class="sig sig-object py" id="gingerdj.core.cache.caches">
<span class="sig-prename descclassname"><span class="pre">gingerdj.core.cache.</span></span><span class="sig-name descname"><span class="pre">caches</span></span><a class="headerlink" href="#gingerdj.core.cache.caches" title="Link to this definition">¶</a></dt>
<dd><p>You can access the caches configured in the <a class="reference internal" href="../ref/settings.html#std-setting-CACHES"><code class="xref std std-setting docutils literal notranslate"><span class="pre">CACHES</span></code></a> setting
through a dict-like object: <code class="docutils literal notranslate"><span class="pre">gingerdj.core.cache.caches</span></code>. Repeated
requests for the same alias in the same thread will return the same
object.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gingerdj.core.cache</span> <span class="kn">import</span> <span class="n">caches</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cache1</span> <span class="o">=</span> <span class="n">caches</span><span class="p">[</span><span class="s2">&quot;myalias&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cache2</span> <span class="o">=</span> <span class="n">caches</span><span class="p">[</span><span class="s2">&quot;myalias&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cache1</span> <span class="ow">is</span> <span class="n">cache2</span>
<span class="go">True</span>
</pre></div>
</div>
<p>If the named key does not exist, <code class="docutils literal notranslate"><span class="pre">InvalidCacheBackendError</span></code> will be
raised.</p>
<p>To provide thread-safety, a different instance of the cache backend will
be returned for each thread.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="gingerdj.core.cache.cache">
<span class="sig-prename descclassname"><span class="pre">gingerdj.core.cache.</span></span><span class="sig-name descname"><span class="pre">cache</span></span><a class="headerlink" href="#gingerdj.core.cache.cache" title="Link to this definition">¶</a></dt>
<dd><p>As a shortcut, the default cache is available as
<code class="docutils literal notranslate"><span class="pre">gingerdj.core.cache.cache</span></code>:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gingerdj.core.cache</span> <span class="kn">import</span> <span class="n">cache</span>
</pre></div>
</div>
<p>This object is equivalent to <code class="docutils literal notranslate"><span class="pre">caches['default']</span></code>.</p>
</dd></dl>

</section>
<section id="s-basic-usage">
<span id="s-cache-basic-interface"></span><span id="basic-usage"></span><span id="cache-basic-interface"></span><h3>Basic usage<a class="headerlink" href="#basic-usage" title="Link to this heading">¶</a></h3>
<p>The basic interface is:</p>
<dl class="py method">
<dt class="sig sig-object py" id="gingerdj.core.cache.cache.set">
<span class="sig-prename descclassname"><span class="pre">cache.</span></span><span class="sig-name descname"><span class="pre">set</span></span>(<em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">DEFAULT_TIMEOUT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>)<a class="headerlink" href="#gingerdj.core.cache.cache.set" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cache</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;my_key&quot;</span><span class="p">,</span> <span class="s2">&quot;hello, world!&quot;</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="gingerdj.core.cache.cache.get">
<span class="sig-prename descclassname"><span class="pre">cache.</span></span><span class="sig-name descname"><span class="pre">get</span></span>(<em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>)<a class="headerlink" href="#gingerdj.core.cache.cache.get" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;my_key&quot;</span><span class="p">)</span>
<span class="go">&#39;hello, world!&#39;</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">key</span></code> should be a <code class="docutils literal notranslate"><span class="pre">str</span></code>, and <code class="docutils literal notranslate"><span class="pre">value</span></code> can be any picklable Python object.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">timeout</span></code> argument is optional and defaults to the <code class="docutils literal notranslate"><span class="pre">timeout</span></code> argument
of the appropriate backend in the <a class="reference internal" href="../ref/settings.html#std-setting-CACHES"><code class="xref std std-setting docutils literal notranslate"><span class="pre">CACHES</span></code></a> setting (explained above).
It’s the number of seconds the value should be stored in the cache. Passing in
<code class="docutils literal notranslate"><span class="pre">None</span></code> for <code class="docutils literal notranslate"><span class="pre">timeout</span></code> will cache the value forever. A <code class="docutils literal notranslate"><span class="pre">timeout</span></code> of <code class="docutils literal notranslate"><span class="pre">0</span></code>
won’t cache the value.</p>
<p>If the object doesn’t exist in the cache, <code class="docutils literal notranslate"><span class="pre">cache.get()</span></code> returns <code class="docutils literal notranslate"><span class="pre">None</span></code>:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Wait 30 seconds for &#39;my_key&#39; to expire...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;my_key&quot;</span><span class="p">)</span>
<span class="go">None</span>
</pre></div>
</div>
<p>If you need to determine whether the object exists in the cache and you have
stored a literal value <code class="docutils literal notranslate"><span class="pre">None</span></code>, use a sentinel object as the default:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sentinel</span> <span class="o">=</span> <span class="nb">object</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;my_key&quot;</span><span class="p">,</span> <span class="n">sentinel</span><span class="p">)</span> <span class="ow">is</span> <span class="n">sentinel</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Wait 30 seconds for &#39;my_key&#39; to expire...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;my_key&quot;</span><span class="p">,</span> <span class="n">sentinel</span><span class="p">)</span> <span class="ow">is</span> <span class="n">sentinel</span>
<span class="go">True</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">cache.get()</span></code> can take a <code class="docutils literal notranslate"><span class="pre">default</span></code> argument. This specifies which value to
return if the object doesn’t exist in the cache:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;my_key&quot;</span><span class="p">,</span> <span class="s2">&quot;has expired&quot;</span><span class="p">)</span>
<span class="go">&#39;has expired&#39;</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="gingerdj.core.cache.cache.add">
<span class="sig-prename descclassname"><span class="pre">cache.</span></span><span class="sig-name descname"><span class="pre">add</span></span>(<em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">DEFAULT_TIMEOUT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>)<a class="headerlink" href="#gingerdj.core.cache.cache.add" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<p>To add a key only if it doesn’t already exist, use the <code class="docutils literal notranslate"><span class="pre">add()</span></code> method.
It takes the same parameters as <code class="docutils literal notranslate"><span class="pre">set()</span></code>, but it will not attempt to
update the cache if the key specified is already present:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cache</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;add_key&quot;</span><span class="p">,</span> <span class="s2">&quot;Initial value&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cache</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;add_key&quot;</span><span class="p">,</span> <span class="s2">&quot;New value&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;add_key&quot;</span><span class="p">)</span>
<span class="go">&#39;Initial value&#39;</span>
</pre></div>
</div>
<p>If you need to know whether <code class="docutils literal notranslate"><span class="pre">add()</span></code> stored a value in the cache, you can
check the return value. It will return <code class="docutils literal notranslate"><span class="pre">True</span></code> if the value was stored,
<code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p>
<dl class="py method">
<dt class="sig sig-object py" id="gingerdj.core.cache.cache.get_or_set">
<span class="sig-prename descclassname"><span class="pre">cache.</span></span><span class="sig-name descname"><span class="pre">get_or_set</span></span>(<em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">DEFAULT_TIMEOUT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>)<a class="headerlink" href="#gingerdj.core.cache.cache.get_or_set" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<p>If you want to get a key’s value or set a value if the key isn’t in the cache,
there is the <code class="docutils literal notranslate"><span class="pre">get_or_set()</span></code> method. It takes the same parameters as <code class="docutils literal notranslate"><span class="pre">get()</span></code>
but the default is set as the new cache value for that key, rather than
returned:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;my_new_key&quot;</span><span class="p">)</span>  <span class="c1"># returns None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cache</span><span class="o">.</span><span class="n">get_or_set</span><span class="p">(</span><span class="s2">&quot;my_new_key&quot;</span><span class="p">,</span> <span class="s2">&quot;my new value&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="go">&#39;my new value&#39;</span>
</pre></div>
</div>
<p>You can also pass any callable as a <em>default</em> value:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">datetime</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cache</span><span class="o">.</span><span class="n">get_or_set</span><span class="p">(</span><span class="s2">&quot;some-timestamp-key&quot;</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">)</span>
<span class="go">datetime.datetime(2014, 12, 11, 0, 15, 49, 457920)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="gingerdj.core.cache.cache.get_many">
<span class="sig-prename descclassname"><span class="pre">cache.</span></span><span class="sig-name descname"><span class="pre">get_many</span></span>(<em class="sig-param"><span class="n"><span class="pre">keys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>)<a class="headerlink" href="#gingerdj.core.cache.cache.get_many" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<p>There’s also a <code class="docutils literal notranslate"><span class="pre">get_many()</span></code> interface that only hits the cache once.
<code class="docutils literal notranslate"><span class="pre">get_many()</span></code> returns a dictionary with all the keys you asked for that
actually exist in the cache (and haven’t expired):</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cache</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cache</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cache</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cache</span><span class="o">.</span><span class="n">get_many</span><span class="p">([</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">])</span>
<span class="go">{&#39;a&#39;: 1, &#39;b&#39;: 2, &#39;c&#39;: 3}</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="gingerdj.core.cache.cache.set_many">
<span class="sig-prename descclassname"><span class="pre">cache.</span></span><span class="sig-name descname"><span class="pre">set_many</span></span>(<em class="sig-param"><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span></em>)<a class="headerlink" href="#gingerdj.core.cache.cache.set_many" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<p>To set multiple values more efficiently, use <code class="docutils literal notranslate"><span class="pre">set_many()</span></code> to pass a dictionary
of key-value pairs:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cache</span><span class="o">.</span><span class="n">set_many</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cache</span><span class="o">.</span><span class="n">get_many</span><span class="p">([</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">])</span>
<span class="go">{&#39;a&#39;: 1, &#39;b&#39;: 2, &#39;c&#39;: 3}</span>
</pre></div>
</div>
<p>Like <code class="docutils literal notranslate"><span class="pre">cache.set()</span></code>, <code class="docutils literal notranslate"><span class="pre">set_many()</span></code> takes an optional <code class="docutils literal notranslate"><span class="pre">timeout</span></code> parameter.</p>
<p>On supported backends (memcached), <code class="docutils literal notranslate"><span class="pre">set_many()</span></code> returns a list of keys that
failed to be inserted.</p>
<dl class="py method">
<dt class="sig sig-object py" id="gingerdj.core.cache.cache.delete">
<span class="sig-prename descclassname"><span class="pre">cache.</span></span><span class="sig-name descname"><span class="pre">delete</span></span>(<em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>)<a class="headerlink" href="#gingerdj.core.cache.cache.delete" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<p>You can delete keys explicitly with <code class="docutils literal notranslate"><span class="pre">delete()</span></code> to clear the cache for a
particular object:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cache</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">delete()</span></code> returns <code class="docutils literal notranslate"><span class="pre">True</span></code> if the key was successfully deleted, <code class="docutils literal notranslate"><span class="pre">False</span></code>
otherwise.</p>
<dl class="py method">
<dt class="sig sig-object py" id="gingerdj.core.cache.cache.delete_many">
<span class="sig-prename descclassname"><span class="pre">cache.</span></span><span class="sig-name descname"><span class="pre">delete_many</span></span>(<em class="sig-param"><span class="n"><span class="pre">keys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>)<a class="headerlink" href="#gingerdj.core.cache.cache.delete_many" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<p>If you want to clear a bunch of keys at once, <code class="docutils literal notranslate"><span class="pre">delete_many()</span></code> can take a list
of keys to be cleared:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cache</span><span class="o">.</span><span class="n">delete_many</span><span class="p">([</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">])</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="gingerdj.core.cache.cache.clear">
<span class="sig-prename descclassname"><span class="pre">cache.</span></span><span class="sig-name descname"><span class="pre">clear</span></span>()<a class="headerlink" href="#gingerdj.core.cache.cache.clear" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<p>Finally, if you want to delete all the keys in the cache, use
<code class="docutils literal notranslate"><span class="pre">cache.clear()</span></code>.  Be careful with this; <code class="docutils literal notranslate"><span class="pre">clear()</span></code> will remove <em>everything</em>
from the cache, not just the keys set by your application:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cache</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="gingerdj.core.cache.cache.touch">
<span class="sig-prename descclassname"><span class="pre">cache.</span></span><span class="sig-name descname"><span class="pre">touch</span></span>(<em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">DEFAULT_TIMEOUT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>)<a class="headerlink" href="#gingerdj.core.cache.cache.touch" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<p><code class="docutils literal notranslate"><span class="pre">cache.touch()</span></code> sets a new expiration for a key. For example, to update a key
to expire 10 seconds from now:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cache</span><span class="o">.</span><span class="n">touch</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Like other methods, the <code class="docutils literal notranslate"><span class="pre">timeout</span></code> argument is optional and defaults to the
<code class="docutils literal notranslate"><span class="pre">TIMEOUT</span></code> option of the appropriate backend in the <a class="reference internal" href="../ref/settings.html#std-setting-CACHES"><code class="xref std std-setting docutils literal notranslate"><span class="pre">CACHES</span></code></a> setting.</p>
<p><code class="docutils literal notranslate"><span class="pre">touch()</span></code> returns <code class="docutils literal notranslate"><span class="pre">True</span></code> if the key was successfully touched, <code class="docutils literal notranslate"><span class="pre">False</span></code>
otherwise.</p>
<dl class="py method">
<dt class="sig sig-object py" id="gingerdj.core.cache.cache.incr">
<span class="sig-prename descclassname"><span class="pre">cache.</span></span><span class="sig-name descname"><span class="pre">incr</span></span>(<em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>)<a class="headerlink" href="#gingerdj.core.cache.cache.incr" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gingerdj.core.cache.cache.decr">
<span class="sig-prename descclassname"><span class="pre">cache.</span></span><span class="sig-name descname"><span class="pre">decr</span></span>(<em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>)<a class="headerlink" href="#gingerdj.core.cache.cache.decr" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<p>You can also increment or decrement a key that already exists using the
<code class="docutils literal notranslate"><span class="pre">incr()</span></code> or <code class="docutils literal notranslate"><span class="pre">decr()</span></code> methods, respectively. By default, the existing cache
value will be incremented or decremented by 1. Other increment/decrement values
can be specified by providing an argument to the increment/decrement call. A
ValueError will be raised if you attempt to increment or decrement a
nonexistent cache key:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cache</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;num&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cache</span><span class="o">.</span><span class="n">incr</span><span class="p">(</span><span class="s2">&quot;num&quot;</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cache</span><span class="o">.</span><span class="n">incr</span><span class="p">(</span><span class="s2">&quot;num&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="go">12</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cache</span><span class="o">.</span><span class="n">decr</span><span class="p">(</span><span class="s2">&quot;num&quot;</span><span class="p">)</span>
<span class="go">11</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cache</span><span class="o">.</span><span class="n">decr</span><span class="p">(</span><span class="s2">&quot;num&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">6</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">incr()</span></code>/<code class="docutils literal notranslate"><span class="pre">decr()</span></code> methods are not guaranteed to be atomic. On those
backends that support atomic increment/decrement (most notably, the
memcached backend), increment and decrement operations will be atomic.
However, if the backend doesn’t natively provide an increment/decrement
operation, it will be implemented using a two-step retrieve/update.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="gingerdj.core.cache.cache.close">
<span class="sig-prename descclassname"><span class="pre">cache.</span></span><span class="sig-name descname"><span class="pre">close</span></span>()<a class="headerlink" href="#gingerdj.core.cache.cache.close" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<p>You can close the connection to your cache with <code class="docutils literal notranslate"><span class="pre">close()</span></code> if implemented by
the cache backend.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cache</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For caches that don’t implement <code class="docutils literal notranslate"><span class="pre">close</span></code> methods it is a no-op.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The async variants of base methods are prefixed with <code class="docutils literal notranslate"><span class="pre">a</span></code>, e.g.
<code class="docutils literal notranslate"><span class="pre">cache.aadd()</span></code> or <code class="docutils literal notranslate"><span class="pre">cache.adelete_many()</span></code>. See <a class="reference internal" href="#id14">Asynchronous support</a>
for more details.</p>
</div>
</section>
<section id="s-cache-key-prefixing">
<span id="s-id11"></span><span id="cache-key-prefixing"></span><span id="id11"></span><h3>Cache key prefixing<a class="headerlink" href="#cache-key-prefixing" title="Link to this heading">¶</a></h3>
<p>If you are sharing a cache instance between servers, or between your
production and development environments, it’s possible for data cached
by one server to be used by another server. If the format of cached
data is different between servers, this can lead to some very hard to
diagnose problems.</p>
<p>To prevent this, GingerDJ provides the ability to prefix all cache keys
used by a server. When a particular cache key is saved or retrieved,
GingerDJ will automatically prefix the cache key with the value of the
<a class="reference internal" href="../ref/settings.html#std-setting-CACHES-KEY_PREFIX"><code class="xref std std-setting docutils literal notranslate"><span class="pre">KEY_PREFIX</span></code></a> cache setting.</p>
<p>By ensuring each GingerDJ instance has a different
<a class="reference internal" href="../ref/settings.html#std-setting-CACHES-KEY_PREFIX"><code class="xref std std-setting docutils literal notranslate"><span class="pre">KEY_PREFIX</span></code></a>, you can ensure that there will be no
collisions in cache values.</p>
</section>
<section id="s-cache-versioning">
<span id="s-id12"></span><span id="cache-versioning"></span><span id="id12"></span><h3>Cache versioning<a class="headerlink" href="#cache-versioning" title="Link to this heading">¶</a></h3>
<p>When you change running code that uses cached values, you may need to
purge any existing cached values. The easiest way to do this is to
flush the entire cache, but this can lead to the loss of cache values
that are still valid and useful.</p>
<p>GingerDJ provides a better way to target individual cache values.
GingerDJ’s cache framework has a system-wide version identifier,
specified using the <a class="reference internal" href="../ref/settings.html#std-setting-CACHES-VERSION"><code class="xref std std-setting docutils literal notranslate"><span class="pre">VERSION</span></code></a> cache setting.
The value of this setting is automatically combined with the cache
prefix and the user-provided cache key to obtain the final cache key.</p>
<p>By default, any key request will automatically include the site
default cache key version. However, the primitive cache functions all
include a <code class="docutils literal notranslate"><span class="pre">version</span></code> argument, so you can specify a particular cache
key version to set or get. For example:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Set version 2 of a cache key</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cache</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;my_key&quot;</span><span class="p">,</span> <span class="s2">&quot;hello world!&quot;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get the default version (assuming version=1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;my_key&quot;</span><span class="p">)</span>
<span class="go">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get version 2 of the same key</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;my_key&quot;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">&#39;hello world!&#39;</span>
</pre></div>
</div>
<p>The version of a specific key can be incremented and decremented using
the <code class="docutils literal notranslate"><span class="pre">incr_version()</span></code> and <code class="docutils literal notranslate"><span class="pre">decr_version()</span></code> methods. This
enables specific keys to be bumped to a new version, leaving other
keys unaffected. Continuing our previous example:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Increment the version of &#39;my_key&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cache</span><span class="o">.</span><span class="n">incr_version</span><span class="p">(</span><span class="s2">&quot;my_key&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># The default version still isn&#39;t available</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;my_key&quot;</span><span class="p">)</span>
<span class="go">None</span>
<span class="go"># Version 2 isn&#39;t available, either</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;my_key&quot;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># But version 3 *is* available</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;my_key&quot;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">&#39;hello world!&#39;</span>
</pre></div>
</div>
</section>
<section id="s-cache-key-transformation">
<span id="s-id13"></span><span id="cache-key-transformation"></span><span id="id13"></span><h3>Cache key transformation<a class="headerlink" href="#cache-key-transformation" title="Link to this heading">¶</a></h3>
<p>As described in the previous two sections, the cache key provided by a
user is not used verbatim – it is combined with the cache prefix and
key version to provide a final cache key. By default, the three parts
are joined using colons to produce a final string:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">make_key</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">key_prefix</span><span class="p">,</span> <span class="n">version</span><span class="p">):</span>
    <span class="k">return</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">:</span><span class="si">%s</span><span class="s2">:</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">key_prefix</span><span class="p">,</span> <span class="n">version</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
</pre></div>
</div>
<p>If you want to combine the parts in different ways, or apply other
processing to the final key (e.g., taking a hash digest of the key
parts), you can provide a custom key function.</p>
<p>The <a class="reference internal" href="../ref/settings.html#std-setting-CACHES-KEY_FUNCTION"><code class="xref std std-setting docutils literal notranslate"><span class="pre">KEY_FUNCTION</span></code></a> cache setting
specifies a dotted-path to a function matching the prototype of
<code class="docutils literal notranslate"><span class="pre">make_key()</span></code> above. If provided, this custom key function will
be used instead of the default key combining function.</p>
</section>
<section id="s-cache-key-warnings">
<span id="cache-key-warnings"></span><h3>Cache key warnings<a class="headerlink" href="#cache-key-warnings" title="Link to this heading">¶</a></h3>
<p>Memcached, the most commonly-used production cache backend, does not allow
cache keys longer than 250 characters or containing whitespace or control
characters, and using such keys will cause an exception. To encourage
cache-portable code and minimize unpleasant surprises, the other built-in cache
backends issue a warning (<code class="docutils literal notranslate"><span class="pre">gingerdj.core.cache.backends.base.CacheKeyWarning</span></code>)
if a key is used that would cause an error on memcached.</p>
<p>If you are using a production backend that can accept a wider range of keys (a
custom backend, or one of the non-memcached built-in backends), and want to use
this wider range without warnings, you can silence <code class="docutils literal notranslate"><span class="pre">CacheKeyWarning</span></code> with
this code in the <code class="docutils literal notranslate"><span class="pre">management</span></code> module of one of your
<a class="reference internal" href="../ref/settings.html#std-setting-INSTALLED_APPS"><code class="xref std std-setting docutils literal notranslate"><span class="pre">INSTALLED_APPS</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>

<span class="kn">from</span> <span class="nn">gingerdj.core.cache</span> <span class="kn">import</span> <span class="n">CacheKeyWarning</span>

<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">CacheKeyWarning</span><span class="p">)</span>
</pre></div>
</div>
<p>If you want to instead provide custom key validation logic for one of the
built-in backends, you can subclass it, override just the <code class="docutils literal notranslate"><span class="pre">validate_key</span></code>
method, and follow the instructions for <a class="reference internal" href="#using-a-custom-cache-backend">using a custom cache backend</a>. For
instance, to do this for the <code class="docutils literal notranslate"><span class="pre">locmem</span></code> backend, put this code in a module:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gingerdj.core.cache.backends.locmem</span> <span class="kn">import</span> <span class="n">LocMemCache</span>


<span class="k">class</span> <span class="nc">CustomLocMemCache</span><span class="p">(</span><span class="n">LocMemCache</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">validate_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Custom validation, raising exceptions or warnings as needed.&quot;&quot;&quot;</span>
        <span class="o">...</span>
</pre></div>
</div>
<p>…and use the dotted Python path to this class in the
<a class="reference internal" href="../ref/settings.html#std-setting-CACHES-BACKEND"><code class="xref std std-setting docutils literal notranslate"><span class="pre">BACKEND</span></code></a> portion of your <a class="reference internal" href="../ref/settings.html#std-setting-CACHES"><code class="xref std std-setting docutils literal notranslate"><span class="pre">CACHES</span></code></a> setting.</p>
</section>
</section>
<section id="s-asynchronous-support">
<span id="s-id14"></span><span id="asynchronous-support"></span><span id="id14"></span><h2>Asynchronous support<a class="headerlink" href="#asynchronous-support" title="Link to this heading">¶</a></h2>
<p>GingerDJ has developing support for asynchronous cache backends, but does not
yet support asynchronous caching. It will be coming in a future release.</p>
<p><code class="docutils literal notranslate"><span class="pre">gingerdj.core.cache.backends.base.BaseCache</span></code> has async variants of <a class="reference internal" href="#cache-basic-interface"><span class="std std-ref">all
base methods</span></a>. By convention, the asynchronous versions
of all methods are prefixed with <code class="docutils literal notranslate"><span class="pre">a</span></code>. By default, the arguments for both
variants are the same:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">await</span> <span class="n">cache</span><span class="o">.</span><span class="n">aset</span><span class="p">(</span><span class="s2">&quot;num&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">await</span> <span class="n">cache</span><span class="o">.</span><span class="n">ahas_key</span><span class="p">(</span><span class="s2">&quot;num&quot;</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</section>
<section id="s-downstream-caches">
<span id="s-id15"></span><span id="downstream-caches"></span><span id="id15"></span><h2>Downstream caches<a class="headerlink" href="#downstream-caches" title="Link to this heading">¶</a></h2>
<p>So far, this document has focused on caching your <em>own</em> data. But another type
of caching is relevant to web development, too: caching performed by
“downstream” caches. These are systems that cache pages for users even before
the request reaches your website.</p>
<p>Here are a few examples of downstream caches:</p>
<ul class="simple">
<li><p>When using HTTP, your <abbr title="Internet Service Provider">ISP</abbr> may cache
certain pages, so if you requested a page from <code class="docutils literal notranslate"><span class="pre">http://example.com/</span></code>, your
ISP would send you the page without having to access example.com directly.
The maintainers of example.com have no knowledge of this caching; the ISP
sits between example.com and your web browser, handling all of the caching
transparently. Such caching is not possible under HTTPS as it would
constitute a man-in-the-middle attack.</p></li>
<li><p>Your GingerDJ website may sit behind a <em>proxy cache</em>, such as Squid Web
Proxy Cache (<a class="reference external" href="http://www.squid-cache.org/">http://www.squid-cache.org/</a>), that caches pages for
performance. In this case, each request first would be handled by the
proxy, and it would be passed to your application only if needed.</p></li>
<li><p>Your web browser caches pages, too. If a web page sends out the
appropriate headers, your browser will use the local cached copy for
subsequent requests to that page, without even contacting the web page
again to see whether it has changed.</p></li>
</ul>
<p>Downstream caching is a nice efficiency boost, but there’s a danger to it:
Many web pages’ contents differ based on authentication and a host of other
variables, and cache systems that blindly save pages based purely on URLs could
expose incorrect or sensitive data to subsequent visitors to those pages.</p>
<p>For example, if you operate a web email system, then the contents of the
“inbox” page depend on which user is logged in. If an ISP blindly cached your
site, then the first user who logged in through that ISP would have their
user-specific inbox page cached for subsequent visitors to the site.  That’s
not cool.</p>
<p>Fortunately, HTTP provides a solution to this problem. A number of HTTP headers
exist to instruct downstream caches to differ their cache contents depending on
designated variables, and to tell caching mechanisms not to cache particular
pages. We’ll look at some of these headers in the sections that follow.</p>
</section>
<section id="s-using-vary-headers">
<span id="s-id16"></span><span id="using-vary-headers"></span><span id="id16"></span><h2>Using <code class="docutils literal notranslate"><span class="pre">Vary</span></code> headers<a class="headerlink" href="#using-vary-headers" title="Link to this heading">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">Vary</span></code> header defines which request headers a cache
mechanism should take into account when building its cache key. For example, if
the contents of a web page depend on a user’s language preference, the page is
said to “vary on language.”</p>
<p>By default, GingerDJ’s cache system creates its cache keys using the requested
fully-qualified URL – e.g.,
<code class="docutils literal notranslate"><span class="pre">&quot;https://www.example.com/stories/2005/?order_by=author&quot;</span></code>. This means every
request to that URL will use the same cached version, regardless of user-agent
differences such as cookies or language preferences. However, if this page
produces different content based on some difference in request headers – such
as a cookie, or a language, or a user-agent – you’ll need to use the <code class="docutils literal notranslate"><span class="pre">Vary</span></code>
header to tell caching mechanisms that the page output depends on those things.</p>
<p>To do this in GingerDJ, use the convenient
<a class="reference internal" href="http/decorators.html#gingerdj.views.decorators.vary.vary_on_headers" title="gingerdj.views.decorators.vary.vary_on_headers"><code class="xref py py-func docutils literal notranslate"><span class="pre">gingerdj.views.decorators.vary.vary_on_headers()</span></code></a> view decorator, like so:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gingerdj.views.decorators.vary</span> <span class="kn">import</span> <span class="n">vary_on_headers</span>


<span class="nd">@vary_on_headers</span><span class="p">(</span><span class="s2">&quot;User-Agent&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">my_view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span> <span class="o">...</span>
</pre></div>
</div>
<p>In this case, a caching mechanism (such as GingerDJ’s own cache middleware) will
cache a separate version of the page for each unique user-agent.</p>
<p>The advantage to using the <code class="docutils literal notranslate"><span class="pre">vary_on_headers</span></code> decorator rather than manually
setting the <code class="docutils literal notranslate"><span class="pre">Vary</span></code> header (using something like <code class="docutils literal notranslate"><span class="pre">response.headers['Vary']</span> <span class="pre">=</span>
<span class="pre">'user-agent'</span></code>) is that the decorator <em>adds</em> to the <code class="docutils literal notranslate"><span class="pre">Vary</span></code> header (which may
already exist), rather than setting it from scratch and potentially overriding
anything that was already in there.</p>
<p>You can pass multiple headers to <code class="docutils literal notranslate"><span class="pre">vary_on_headers()</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@vary_on_headers</span><span class="p">(</span><span class="s2">&quot;User-Agent&quot;</span><span class="p">,</span> <span class="s2">&quot;Cookie&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">my_view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span> <span class="o">...</span>
</pre></div>
</div>
<p>This tells downstream caches to vary on <em>both</em>, which means each combination of
user-agent and cookie will get its own cache value. For example, a request with
the user-agent <code class="docutils literal notranslate"><span class="pre">Mozilla</span></code> and the cookie value <code class="docutils literal notranslate"><span class="pre">foo=bar</span></code> will be considered
different from a request with the user-agent <code class="docutils literal notranslate"><span class="pre">Mozilla</span></code> and the cookie value
<code class="docutils literal notranslate"><span class="pre">foo=ham</span></code>.</p>
<p>Because varying on cookie is so common, there’s a
<a class="reference internal" href="http/decorators.html#gingerdj.views.decorators.vary.vary_on_cookie" title="gingerdj.views.decorators.vary.vary_on_cookie"><code class="xref py py-func docutils literal notranslate"><span class="pre">gingerdj.views.decorators.vary.vary_on_cookie()</span></code></a> decorator. These two views
are equivalent:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@vary_on_cookie</span>
<span class="k">def</span> <span class="nf">my_view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span> <span class="o">...</span>


<span class="nd">@vary_on_headers</span><span class="p">(</span><span class="s2">&quot;Cookie&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">my_view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span> <span class="o">...</span>
</pre></div>
</div>
<p>The headers you pass to <code class="docutils literal notranslate"><span class="pre">vary_on_headers</span></code> are not case sensitive;
<code class="docutils literal notranslate"><span class="pre">&quot;User-Agent&quot;</span></code> is the same thing as <code class="docutils literal notranslate"><span class="pre">&quot;user-agent&quot;</span></code>.</p>
<p>You can also use a helper function, <a class="reference internal" href="../ref/utils.html#gingerdj.utils.cache.patch_vary_headers" title="gingerdj.utils.cache.patch_vary_headers"><code class="xref py py-func docutils literal notranslate"><span class="pre">gingerdj.utils.cache.patch_vary_headers()</span></code></a>,
directly. This function sets, or adds to, the <code class="docutils literal notranslate"><span class="pre">Vary</span> <span class="pre">header</span></code>. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gingerdj.shortcuts</span> <span class="kn">import</span> <span class="n">render</span>
<span class="kn">from</span> <span class="nn">gingerdj.utils.cache</span> <span class="kn">import</span> <span class="n">patch_vary_headers</span>


<span class="k">def</span> <span class="nf">my_view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="o">...</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s2">&quot;template_name&quot;</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
    <span class="n">patch_vary_headers</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;Cookie&quot;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">response</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">patch_vary_headers</span></code> takes an <a class="reference internal" href="../ref/request-response.html#gingerdj.http.HttpResponse" title="gingerdj.http.HttpResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">HttpResponse</span></code></a> instance as
its first argument and a list/tuple of case-insensitive header names as its
second argument.</p>
<p>For more on Vary headers, see the <span class="target" id="index-0"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc9110.html#section-12.5.5"><strong>official Vary spec</strong></a>.</p>
</section>
<section id="s-controlling-cache-using-other-headers">
<span id="controlling-cache-using-other-headers"></span><h2>Controlling cache: Using other headers<a class="headerlink" href="#controlling-cache-using-other-headers" title="Link to this heading">¶</a></h2>
<p>Other problems with caching are the privacy of data and the question of where
data should be stored in a cascade of caches.</p>
<p>A user usually faces two kinds of caches: their own browser cache (a private
cache) and their provider’s cache (a public cache). A public cache is used by
multiple users and controlled by someone else. This poses problems with
sensitive data–you don’t want, say, your bank account number stored in a
public cache. So web applications need a way to tell caches which data is
private and which is public.</p>
<p>The solution is to indicate a page’s cache should be “private.” To do this in
GingerDJ, use the <a class="reference internal" href="http/decorators.html#gingerdj.views.decorators.cache.cache_control" title="gingerdj.views.decorators.cache.cache_control"><code class="xref py py-func docutils literal notranslate"><span class="pre">cache_control()</span></code></a> view
decorator. Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gingerdj.views.decorators.cache</span> <span class="kn">import</span> <span class="n">cache_control</span>


<span class="nd">@cache_control</span><span class="p">(</span><span class="n">private</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">my_view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span> <span class="o">...</span>
</pre></div>
</div>
<p>This decorator takes care of sending out the appropriate HTTP header behind the
scenes.</p>
<p>Note that the cache control settings “private” and “public” are mutually
exclusive. The decorator ensures that the “public” directive is removed if
“private” should be set (and vice versa). An example use of the two directives
would be a blog site that offers both private and public entries. Public
entries may be cached on any shared cache. The following code uses
<a class="reference internal" href="../ref/utils.html#gingerdj.utils.cache.patch_cache_control" title="gingerdj.utils.cache.patch_cache_control"><code class="xref py py-func docutils literal notranslate"><span class="pre">patch_cache_control()</span></code></a>, the manual way to modify the
cache control header (it is internally called by the
<a class="reference internal" href="http/decorators.html#gingerdj.views.decorators.cache.cache_control" title="gingerdj.views.decorators.cache.cache_control"><code class="xref py py-func docutils literal notranslate"><span class="pre">cache_control()</span></code></a> decorator):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gingerdj.views.decorators.cache</span> <span class="kn">import</span> <span class="n">patch_cache_control</span>
<span class="kn">from</span> <span class="nn">gingerdj.views.decorators.vary</span> <span class="kn">import</span> <span class="n">vary_on_cookie</span>


<span class="nd">@vary_on_cookie</span>
<span class="k">def</span> <span class="nf">list_blog_entries_view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">is_anonymous</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">render_only_public_entries</span><span class="p">()</span>
        <span class="n">patch_cache_control</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">public</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">render_private_and_public_entries</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="p">)</span>
        <span class="n">patch_cache_control</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">private</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span>
</pre></div>
</div>
<p>You can control downstream caches in other ways as well (see <span class="target" id="index-1"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc9111.html"><strong>RFC 9111</strong></a> for
details on HTTP caching). For example, even if you don’t use GingerDJ’s
server-side cache framework, you can still tell clients to cache a view for a
certain amount of time with the <span class="target" id="index-2"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc9111.html#section-5.2.2.1"><strong>max-age</strong></a>
directive:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gingerdj.views.decorators.cache</span> <span class="kn">import</span> <span class="n">cache_control</span>


<span class="nd">@cache_control</span><span class="p">(</span><span class="n">max_age</span><span class="o">=</span><span class="mi">3600</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">my_view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span> <span class="o">...</span>
</pre></div>
</div>
<p>(If you <em>do</em> use the caching middleware, it already sets the <code class="docutils literal notranslate"><span class="pre">max-age</span></code> with
the value of the <a class="reference internal" href="../ref/settings.html#std-setting-CACHE_MIDDLEWARE_SECONDS"><code class="xref std std-setting docutils literal notranslate"><span class="pre">CACHE_MIDDLEWARE_SECONDS</span></code></a> setting. In that case,
the custom <code class="docutils literal notranslate"><span class="pre">max_age</span></code> from the
<a class="reference internal" href="http/decorators.html#gingerdj.views.decorators.cache.cache_control" title="gingerdj.views.decorators.cache.cache_control"><code class="xref py py-func docutils literal notranslate"><span class="pre">cache_control()</span></code></a> decorator will take
precedence, and the header values will be merged correctly.)</p>
<p>Any valid <code class="docutils literal notranslate"><span class="pre">Cache-Control</span></code> response directive is valid in <code class="docutils literal notranslate"><span class="pre">cache_control()</span></code>.
Here are some more examples:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">no_transform=True</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">must_revalidate=True</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stale_while_revalidate=num_seconds</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">no_cache=True</span></code></p></li>
</ul>
<p>The full list of known directives can be found in the <a class="reference external" href="https://www.iana.org/assignments/http-cache-directives/http-cache-directives.xhtml">IANA registry</a>
(note that not all of them apply to responses).</p>
<p>If you want to use headers to disable caching altogether,
<a class="reference internal" href="http/decorators.html#gingerdj.views.decorators.cache.never_cache" title="gingerdj.views.decorators.cache.never_cache"><code class="xref py py-func docutils literal notranslate"><span class="pre">never_cache()</span></code></a> is a view decorator that
adds headers to ensure the response won’t be cached by browsers or other
caches. Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gingerdj.views.decorators.cache</span> <span class="kn">import</span> <span class="n">never_cache</span>


<span class="nd">@never_cache</span>
<span class="k">def</span> <span class="nf">myview</span><span class="p">(</span><span class="n">request</span><span class="p">):</span> <span class="o">...</span>
</pre></div>
</div>
</section>
<section id="s-order-of-middleware">
<span id="order-of-middleware"></span><h2>Order of <code class="docutils literal notranslate"><span class="pre">MIDDLEWARE</span></code><a class="headerlink" href="#order-of-middleware" title="Link to this heading">¶</a></h2>
<p>If you use caching middleware, it’s important to put each half in the right
place within the <a class="reference internal" href="../ref/settings.html#std-setting-MIDDLEWARE"><code class="xref std std-setting docutils literal notranslate"><span class="pre">MIDDLEWARE</span></code></a> setting. That’s because the cache
middleware needs to know which headers by which to vary the cache storage.
Middleware always adds something to the <code class="docutils literal notranslate"><span class="pre">Vary</span></code> response header when it can.</p>
<p><code class="docutils literal notranslate"><span class="pre">UpdateCacheMiddleware</span></code> runs during the response phase, where middleware is
run in reverse order, so an item at the top of the list runs <em>last</em> during the
response phase. Thus, you need to make sure that <code class="docutils literal notranslate"><span class="pre">UpdateCacheMiddleware</span></code>
appears <em>before</em> any other middleware that might add something to the <code class="docutils literal notranslate"><span class="pre">Vary</span></code>
header. The following middleware modules do so:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">SessionMiddleware</span></code> adds <code class="docutils literal notranslate"><span class="pre">Cookie</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">GZipMiddleware</span></code> adds <code class="docutils literal notranslate"><span class="pre">Accept-Encoding</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">LocaleMiddleware</span></code> adds <code class="docutils literal notranslate"><span class="pre">Accept-Language</span></code></p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">FetchFromCacheMiddleware</span></code>, on the other hand, runs during the request phase,
where middleware is applied first-to-last, so an item at the top of the list
runs <em>first</em> during the request phase. The <code class="docutils literal notranslate"><span class="pre">FetchFromCacheMiddleware</span></code> also
needs to run after other middleware updates the <code class="docutils literal notranslate"><span class="pre">Vary</span></code> header, so
<code class="docutils literal notranslate"><span class="pre">FetchFromCacheMiddleware</span></code> must be <em>after</em> any item that does so.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="conditional-view-processing.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Conditional View Processing</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="testing/advanced.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Advanced testing topics</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; Ginger Society and contributors
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            <div class="last-updated">
              Last updated on Nov 21, 2024</div>
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">GingerDJ’s cache framework</a><ul>
<li><a class="reference internal" href="#setting-up-the-cache">Setting up the cache</a><ul>
<li><a class="reference internal" href="#memcached">Memcached</a></li>
<li><a class="reference internal" href="#redis">Redis</a></li>
<li><a class="reference internal" href="#database-caching">Database caching</a><ul>
<li><a class="reference internal" href="#creating-the-cache-table">Creating the cache table</a></li>
<li><a class="reference internal" href="#multiple-databases">Multiple databases</a></li>
</ul>
</li>
<li><a class="reference internal" href="#filesystem-caching">Filesystem caching</a></li>
<li><a class="reference internal" href="#local-memory-caching">Local-memory caching</a></li>
<li><a class="reference internal" href="#dummy-caching-for-development">Dummy caching (for development)</a></li>
<li><a class="reference internal" href="#using-a-custom-cache-backend">Using a custom cache backend</a></li>
<li><a class="reference internal" href="#cache-arguments">Cache arguments</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-per-site-cache">The per-site cache</a></li>
<li><a class="reference internal" href="#the-per-view-cache">The per-view cache</a><ul>
<li><a class="reference internal" href="#specifying-per-view-cache-in-the-urlconf">Specifying per-view cache in the URLconf</a></li>
</ul>
</li>
<li><a class="reference internal" href="#template-fragment-caching">Template fragment caching</a></li>
<li><a class="reference internal" href="#the-low-level-cache-api">The low-level cache API</a><ul>
<li><a class="reference internal" href="#accessing-the-cache">Accessing the cache</a></li>
<li><a class="reference internal" href="#basic-usage">Basic usage</a></li>
<li><a class="reference internal" href="#cache-key-prefixing">Cache key prefixing</a></li>
<li><a class="reference internal" href="#cache-versioning">Cache versioning</a></li>
<li><a class="reference internal" href="#cache-key-transformation">Cache key transformation</a></li>
<li><a class="reference internal" href="#cache-key-warnings">Cache key warnings</a></li>
</ul>
</li>
<li><a class="reference internal" href="#asynchronous-support">Asynchronous support</a></li>
<li><a class="reference internal" href="#downstream-caches">Downstream caches</a></li>
<li><a class="reference internal" href="#using-vary-headers">Using <code class="docutils literal notranslate"><span class="pre">Vary</span></code> headers</a></li>
<li><a class="reference internal" href="#controlling-cache-using-other-headers">Controlling cache: Using other headers</a></li>
<li><a class="reference internal" href="#order-of-middleware">Order of <code class="docutils literal notranslate"><span class="pre">MIDDLEWARE</span></code></a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=c5a15dbd"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    </body>
</html>